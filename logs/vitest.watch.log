[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m

 DEV  v2.1.9 /Users/yasutakesougo/audit-management-system-mvp

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 21ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 20ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 1ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 3 failed) 17ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 4ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent 1ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 1ms
     → Cannot read properties of undefined (reading 'json')
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ❯ tests/unit/spClient.ensureList.spec.ts (5 tests | 1 failed) 16ms
   × spClient ensureListExists > warns when an existing field misses the required flag 8ms
     → expected false to be true // Object.is equality
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 189ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/spClient.etag-conflict.spec.ts (5 tests | 5 failed) 22ms
   × spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value 13ms
     → promise rejected "Error: APIリクエストに失敗しました (412 )
" instead of resolving
   × spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412) 1ms
     → expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointItemNotFoundError
   × spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error 4ms
     → expected Error: APIリクエストに失敗しました (409 )
 to match object { status: 409 }
   × spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error 3ms
     → expected Error: APIリクエストに失敗しました (428 )
 to match object { status: 428 }
   × spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing 1ms
     → expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointMissingEtagError
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 44ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 25ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 220ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 218ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 9ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 4ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1218ms
   × AppShell navigation > marks current route button with aria-current="page" 192ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1026ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 128ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 127ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ src/lib/hashUtil.spec.ts (5 tests) 6ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 396ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 396ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 222ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/exportCsv.spec.ts (2 tests) 2ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 6ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 4ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 5ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 95ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 5ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2727ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 323ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 2399ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 203ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 9ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 6ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 4ms
 ✓ src/lib/spClient.spec.ts (4 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 7ms
 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 8ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 7ms
     → registerNotifier does not exist
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 4ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 11ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 5ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 9ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 3ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 4ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 157ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 4ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 59ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 159ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 2ms

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/features/schedule/__tests__/spClient.usercare.spec.ts [ src/features/schedule/__tests__/spClient.usercare.spec.ts ]
Error: Failed to resolve import "./statusDictionary" from "src/features/schedule/spClient.schedule.ts". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/features/schedule/spClient.schedule.ts:4:31
  1  |  import { validateUserCare } from "./validation";
  2  |  import { fromSpSchedule, toSpScheduleFields } from "./spMap";
  3  |  import { STATUS_DEFAULT } from "./statusDictionary";
     |                                  ^
  4  |  import { buildScheduleSelectClause, handleScheduleOptionalFieldError } from "./scheduleFeatures";
  5  |  import {
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/16]⎯

⎯⎯⎯⎯⎯⎯ Failed Tests 15 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/16]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/16]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/16]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/16]⎯

 FAIL  tests/unit/operation-hub.useOperationHubData.spec.ts > useOperationHubData > aggregates SharePoint data into dashboard state
 FAIL  tests/unit/operation-hub.useOperationHubData.spec.ts > useOperationHubData > refresh triggers ensure and reloads
Error: Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/features/operation-hub/useOperationHubData.ts:7:25
  3  |  import { addMinutes, differenceInCalendarDays, differenceInMinutes, isAfter, isBefore } from "date-fns";
  4  |  import { useSchedules } from "@/stores/useSchedules";
  5  |  import { useUsers } from "@/stores/useUsers";
     |                            ^
  6  |  import { useStaff } from "@/stores/useStaff";
  7  |  import { getNow } from "@/utils/getNow";
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/16]⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ tests/unit/spClient.ensureList.spec.ts:133:26
    131|         return typeof message === 'string' && message.includes('requir…
    132|       });
    133|       expect(sawWarning).toBe(true);
       |                          ^
    134|     } finally {
    135|       warnSpy.mockRestore();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
AssertionError: promise rejected "Error: APIリクエストに失敗しました (412 )
" instead of resolving
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:88
     38|     const list = "lists/getbytitle('SupportRecord_Daily')";
     39| 
     40|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |                                                                                        ^
     41| 
     42|     expect(fetchMock).toHaveBeenCalledTimes(3);

Caused by: Error: APIリクエストに失敗しました (412 )

 ❯ spFetch src/lib/spClient.ts:388:13
 ❯ updateItemByTitle src/lib/spClient.ts:435:17
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:5

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
AssertionError: expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointItemNotFoundError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:82:5
     80|     const list = "lists/getbytitle('SupportRecord_Daily')";
     81| 
     82|     await expect(
       |     ^
     83|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
     84|     ).rejects.toBeInstanceOf(SharePointItemNotFoundError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
AssertionError: expected Error: APIリクエストに失敗しました (409 )
 to match object { status: 409 }

- Expected
+ Received

- Object {
-   "status": 409,
- }
+ [Error: APIリクエストに失敗しました (409 )
+ ]

 ❯ tests/unit/spClient.etag-conflict.spec.ts:96:5
     94|     const list = "lists/getbytitle('SupportRecord_Daily')";
     95| 
     96|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |     ^
     97|       status: 409,
     98|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
AssertionError: expected Error: APIリクエストに失敗しました (428 )
 to match object { status: 428 }

- Expected
+ Received

- Object {
-   "status": 428,
- }
+ [Error: APIリクエストに失敗しました (428 )
+ ]

 ❯ tests/unit/spClient.etag-conflict.spec.ts:110:5
    108|     const list = "lists/getbytitle('SupportRecord_Daily')";
    109| 
    110|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |     ^
    111|       status: 428,
    112|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
AssertionError: expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointMissingEtagError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:127:5
    125|     const list = "lists/getbytitle('SupportRecord_Daily')";
    126| 
    127|     await expect(
       |     ^
    128|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
    129|     ).rejects.toBeInstanceOf(SharePointMissingEtagError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/16]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:215:30
    213|       const path = buildListItemsPath(listTitle, select, top);
    214|       const res = await client.spFetch(path);
    215|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    216|       return (json.value ?? []) as TRow[];
    217|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:695:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:56:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/16]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:215:30
    213|       const path = buildListItemsPath(listTitle, select, top);
    214|       const res = await client.spFetch(path);
    215|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    216|       return (json.value ?? []) as TRow[];
    217|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:695:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:82:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/16]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:215:30
    213|       const path = buildListItemsPath(listTitle, select, top);
    214|       const res = await client.spFetch(path);
    215|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    216|       return (json.value ?? []) as TRow[];
    217|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:695:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/16]⎯

 Test Files  8 failed | 37 passed (45)
      Tests  15 failed | 90 passed (105)
   Start at  09:23:39
   Duration  11.15s (transform 881ms, setup 7.23s, collect 4.21s, tests 6.26s, environment 16.31s, prepare 2.83s)

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  package.json 

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

 ❯ tests/unit/spClient.etag-conflict.spec.ts (5 tests | 5 failed) 18ms
   × spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value 11ms
     → promise rejected "Error: APIリクエストに失敗しました (412 )
" instead of resolving
   × spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412) 1ms
     → expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointItemNotFoundError
   × spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error 4ms
     → expected Error: APIリクエストに失敗しました (409 )
 to match object { status: 409 }
   × spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error 1ms
     → expected Error: APIリクエストに失敗しました (428 )
 to match object { status: 428 }
   × spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing 1ms
     → expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointMissingEtagError
 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 15ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 13ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 1ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 191ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 190ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 3 failed) 18ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 5ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent 1ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 1ms
     → Cannot read properties of undefined (reading 'json')
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ❯ tests/unit/spClient.ensureList.spec.ts (5 tests | 1 failed) 15ms
   × spClient ensureListExists > warns when an existing field misses the required flag 5ms
     → expected false to be true // Object.is equality
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 6ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 5ms
     → registerNotifier does not exist
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1170ms
   × AppShell navigation > marks current route button with aria-current="page" 153ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1017ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 255ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 167ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 201ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 220ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 100ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 215ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2377ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 371ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 2002ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 163ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 111ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 105ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 74ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 41ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 26ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 13ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 6ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 8ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 12ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 4ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 2ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 8ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 4ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 6ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 5ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 5ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 5ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 4ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 5ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 3ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 2ms

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/features/schedule/__tests__/spClient.usercare.spec.ts [ src/features/schedule/__tests__/spClient.usercare.spec.ts ]
Error: Failed to resolve import "./statusDictionary" from "src/features/schedule/spClient.schedule.ts". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/features/schedule/spClient.schedule.ts:4:31
  1  |  import { validateUserCare } from "./validation";
  2  |  import { fromSpSchedule, toSpScheduleFields } from "./spMap";
  3  |  import { STATUS_DEFAULT } from "./statusDictionary";
     |                                  ^
  4  |  import { buildScheduleSelectClause, handleScheduleOptionalFieldError } from "./scheduleFeatures";
  5  |  import {
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/16]⎯

⎯⎯⎯⎯⎯⎯ Failed Tests 15 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:215:30
    213|       const path = buildListItemsPath(listTitle, select, top);
    214|       const res = await client.spFetch(path);
    215|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    216|       return (json.value ?? []) as TRow[];
    217|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:695:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:56:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/16]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:215:30
    213|       const path = buildListItemsPath(listTitle, select, top);
    214|       const res = await client.spFetch(path);
    215|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    216|       return (json.value ?? []) as TRow[];
    217|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:695:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:82:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/16]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:215:30
    213|       const path = buildListItemsPath(listTitle, select, top);
    214|       const res = await client.spFetch(path);
    215|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    216|       return (json.value ?? []) as TRow[];
    217|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:695:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/16]⎯

 FAIL  tests/unit/operation-hub.useOperationHubData.spec.ts > useOperationHubData > aggregates SharePoint data into dashboard state
 FAIL  tests/unit/operation-hub.useOperationHubData.spec.ts > useOperationHubData > refresh triggers ensure and reloads
Error: Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/features/operation-hub/useOperationHubData.ts:7:25
  3  |  import { addMinutes, differenceInCalendarDays, differenceInMinutes, isAfter, isBefore } from "date-fns";
  4  |  import { useSchedules } from "@/stores/useSchedules";
  5  |  import { useUsers } from "@/stores/useUsers";
     |                            ^
  6  |  import { useStaff } from "@/stores/useStaff";
  7  |  import { getNow } from "@/utils/getNow";
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/16]⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ tests/unit/spClient.ensureList.spec.ts:133:26
    131|         return typeof message === 'string' && message.includes('requir…
    132|       });
    133|       expect(sawWarning).toBe(true);
       |                          ^
    134|     } finally {
    135|       warnSpy.mockRestore();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
AssertionError: promise rejected "Error: APIリクエストに失敗しました (412 )
" instead of resolving
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:88
     38|     const list = "lists/getbytitle('SupportRecord_Daily')";
     39| 
     40|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |                                                                                        ^
     41| 
     42|     expect(fetchMock).toHaveBeenCalledTimes(3);

Caused by: Error: APIリクエストに失敗しました (412 )

 ❯ spFetch src/lib/spClient.ts:388:13
 ❯ updateItemByTitle src/lib/spClient.ts:435:17
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:5

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
AssertionError: expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointItemNotFoundError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:82:5
     80|     const list = "lists/getbytitle('SupportRecord_Daily')";
     81| 
     82|     await expect(
       |     ^
     83|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
     84|     ).rejects.toBeInstanceOf(SharePointItemNotFoundError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
AssertionError: expected Error: APIリクエストに失敗しました (409 )
 to match object { status: 409 }

- Expected
+ Received

- Object {
-   "status": 409,
- }
+ [Error: APIリクエストに失敗しました (409 )
+ ]

 ❯ tests/unit/spClient.etag-conflict.spec.ts:96:5
     94|     const list = "lists/getbytitle('SupportRecord_Daily')";
     95| 
     96|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |     ^
     97|       status: 409,
     98|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
AssertionError: expected Error: APIリクエストに失敗しました (428 )
 to match object { status: 428 }

- Expected
+ Received

- Object {
-   "status": 428,
- }
+ [Error: APIリクエストに失敗しました (428 )
+ ]

 ❯ tests/unit/spClient.etag-conflict.spec.ts:110:5
    108|     const list = "lists/getbytitle('SupportRecord_Daily')";
    109| 
    110|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |     ^
    111|       status: 428,
    112|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
AssertionError: expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointMissingEtagError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:127:5
    125|     const list = "lists/getbytitle('SupportRecord_Daily')";
    126| 
    127|     await expect(
       |     ^
    128|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
    129|     ).rejects.toBeInstanceOf(SharePointMissingEtagError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/16]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/16]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/16]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/16]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/16]⎯

 Test Files  8 failed | 37 passed (45)
      Tests  15 failed | 90 passed (105)
   Start at  09:25:57
   Duration  14.32s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  vitest.setup.ts 

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

 ❯ tests/unit/spClient.etag-conflict.spec.ts (5 tests | 5 failed) 27ms
   × spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value 19ms
     → promise rejected "Error: APIリクエストに失敗しました (412 )
" instead of resolving
   × spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412) 3ms
     → expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointItemNotFoundError
   × spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error 3ms
     → expected Error: APIリクエストに失敗しました (409 )
 to match object { status: 409 }
   × spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error 1ms
     → expected Error: APIリクエストに失敗しました (428 )
 to match object { status: 428 }
   × spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing 1ms
     → expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointMissingEtagError
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 3 failed) 16ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 5ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent 1ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 1ms
     → Cannot read properties of undefined (reading 'json')
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 112ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 112ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ❯ tests/unit/spClient.ensureList.spec.ts (5 tests | 1 failed) 13ms
   × spClient ensureListExists > warns when an existing field misses the required flag 5ms
     → expected false to be true // Object.is equality
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 3ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1123ms
   × AppShell navigation > marks current route button with aria-current="page" 104ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1018ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 177ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 162ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 170ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 113ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1379ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1296ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 148ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 131ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 153ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 83ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 80ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 66ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 21ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 6ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 14ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 8ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 3ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 4ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 4ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 2ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 4ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 2ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 2ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 2ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/features/schedule/__tests__/spClient.usercare.spec.ts [ src/features/schedule/__tests__/spClient.usercare.spec.ts ]
Error: Failed to resolve import "./statusDictionary" from "src/features/schedule/spClient.schedule.ts". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/features/schedule/spClient.schedule.ts:4:31
  1  |  import { validateUserCare } from "./validation";
  2  |  import { fromSpSchedule, toSpScheduleFields } from "./spMap";
  3  |  import { STATUS_DEFAULT } from "./statusDictionary";
     |                                  ^
  4  |  import { buildScheduleSelectClause, handleScheduleOptionalFieldError } from "./scheduleFeatures";
  5  |  import {
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/16]⎯

⎯⎯⎯⎯⎯⎯ Failed Tests 15 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:215:30
    213|       const path = buildListItemsPath(listTitle, select, top);
    214|       const res = await client.spFetch(path);
    215|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    216|       return (json.value ?? []) as TRow[];
    217|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:695:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:56:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/16]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:215:30
    213|       const path = buildListItemsPath(listTitle, select, top);
    214|       const res = await client.spFetch(path);
    215|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    216|       return (json.value ?? []) as TRow[];
    217|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:695:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:82:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/16]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:215:30
    213|       const path = buildListItemsPath(listTitle, select, top);
    214|       const res = await client.spFetch(path);
    215|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    216|       return (json.value ?? []) as TRow[];
    217|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:695:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/16]⎯

 FAIL  tests/unit/operation-hub.useOperationHubData.spec.ts > useOperationHubData > aggregates SharePoint data into dashboard state
 FAIL  tests/unit/operation-hub.useOperationHubData.spec.ts > useOperationHubData > refresh triggers ensure and reloads
Error: Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/features/operation-hub/useOperationHubData.ts:7:25
  3  |  import { addMinutes, differenceInCalendarDays, differenceInMinutes, isAfter, isBefore } from "date-fns";
  4  |  import { useSchedules } from "@/stores/useSchedules";
  5  |  import { useUsers } from "@/stores/useUsers";
     |                            ^
  6  |  import { useStaff } from "@/stores/useStaff";
  7  |  import { getNow } from "@/utils/getNow";
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/16]⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ tests/unit/spClient.ensureList.spec.ts:133:26
    131|         return typeof message === 'string' && message.includes('requir…
    132|       });
    133|       expect(sawWarning).toBe(true);
       |                          ^
    134|     } finally {
    135|       warnSpy.mockRestore();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
AssertionError: promise rejected "Error: APIリクエストに失敗しました (412 )
" instead of resolving
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:88
     38|     const list = "lists/getbytitle('SupportRecord_Daily')";
     39| 
     40|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |                                                                                        ^
     41| 
     42|     expect(fetchMock).toHaveBeenCalledTimes(3);

Caused by: Error: APIリクエストに失敗しました (412 )

 ❯ spFetch src/lib/spClient.ts:388:13
 ❯ updateItemByTitle src/lib/spClient.ts:435:17
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:5

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
AssertionError: expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointItemNotFoundError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:82:5
     80|     const list = "lists/getbytitle('SupportRecord_Daily')";
     81| 
     82|     await expect(
       |     ^
     83|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
     84|     ).rejects.toBeInstanceOf(SharePointItemNotFoundError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
AssertionError: expected Error: APIリクエストに失敗しました (409 )
 to match object { status: 409 }

- Expected
+ Received

- Object {
-   "status": 409,
- }
+ [Error: APIリクエストに失敗しました (409 )
+ ]

 ❯ tests/unit/spClient.etag-conflict.spec.ts:96:5
     94|     const list = "lists/getbytitle('SupportRecord_Daily')";
     95| 
     96|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |     ^
     97|       status: 409,
     98|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
AssertionError: expected Error: APIリクエストに失敗しました (428 )
 to match object { status: 428 }

- Expected
+ Received

- Object {
-   "status": 428,
- }
+ [Error: APIリクエストに失敗しました (428 )
+ ]

 ❯ tests/unit/spClient.etag-conflict.spec.ts:110:5
    108|     const list = "lists/getbytitle('SupportRecord_Daily')";
    109| 
    110|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |     ^
    111|       status: 428,
    112|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/16]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
AssertionError: expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointMissingEtagError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:127:5
    125|     const list = "lists/getbytitle('SupportRecord_Daily')";
    126| 
    127|     await expect(
       |     ^
    128|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
    129|     ).rejects.toBeInstanceOf(SharePointMissingEtagError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/16]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/16]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/16]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/16]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/16]⎯

 Test Files  8 failed | 37 passed (45)
      Tests  15 failed | 90 passed (105)
   Start at  09:26:06
   Duration  10.29s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 3 failed) 18ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 8ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent 1ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 1ms
     → Cannot read properties of undefined (reading 'json')
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

 ❯ tests/unit/spClient.etag-conflict.spec.ts (5 tests | 5 failed) 14ms
   × spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value 9ms
     → promise rejected "Error: APIリクエストに失敗しました (412 )
" instead of resolving
   × spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412) 1ms
     → expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointItemNotFoundError
   × spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error 2ms
     → expected Error: APIリクエストに失敗しました (409 )
 to match object { status: 409 }
   × spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error 1ms
     → expected Error: APIリクエストに失敗しました (428 )
 to match object { status: 428 }
   × spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing 1ms
     → expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointMissingEtagError
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 119ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 119ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ❯ tests/unit/spClient.ensureList.spec.ts (5 tests | 1 failed) 18ms
   × spClient ensureListExists > warns when an existing field misses the required flag 7ms
     → expected false to be true // Object.is equality
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1139ms
   × AppShell navigation > marks current route button with aria-current="page" 110ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1028ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 303ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 303ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 228ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1350ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1132ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 107ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 298ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 154ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 9ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 81ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 78ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 43ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 5ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯ Failed Tests 13 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ tests/unit/spClient.ensureList.spec.ts:133:26
    131|         return typeof message === 'string' && message.includes('requir…
    132|       });
    133|       expect(sawWarning).toBe(true);
       |                          ^
    134|     } finally {
    135|       warnSpy.mockRestore();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/13]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:244:30
    242|       const path = buildListItemsPath(listTitle, select, top);
    243|       const res = await client.spFetch(path);
    244|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    245|       return (json.value ?? []) as TRow[];
    246|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:724:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:56:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/13]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:244:30
    242|       const path = buildListItemsPath(listTitle, select, top);
    243|       const res = await client.spFetch(path);
    244|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    245|       return (json.value ?? []) as TRow[];
    246|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:724:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:82:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/13]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:244:30
    242|       const path = buildListItemsPath(listTitle, select, top);
    243|       const res = await client.spFetch(path);
    244|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    245|       return (json.value ?? []) as TRow[];
    246|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:724:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/13]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
AssertionError: promise rejected "Error: APIリクエストに失敗しました (412 )
" instead of resolving
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:88
     38|     const list = "lists/getbytitle('SupportRecord_Daily')";
     39| 
     40|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |                                                                                        ^
     41| 
     42|     expect(fetchMock).toHaveBeenCalledTimes(3);

Caused by: Error: APIリクエストに失敗しました (412 )

 ❯ spFetch src/lib/spClient.ts:417:13
 ❯ updateItemByTitle src/lib/spClient.ts:464:17
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:5

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/13]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
AssertionError: expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointItemNotFoundError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:82:5
     80|     const list = "lists/getbytitle('SupportRecord_Daily')";
     81| 
     82|     await expect(
       |     ^
     83|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
     84|     ).rejects.toBeInstanceOf(SharePointItemNotFoundError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/13]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
AssertionError: expected Error: APIリクエストに失敗しました (409 )
 to match object { status: 409 }

- Expected
+ Received

- Object {
-   "status": 409,
- }
+ [Error: APIリクエストに失敗しました (409 )
+ ]

 ❯ tests/unit/spClient.etag-conflict.spec.ts:96:5
     94|     const list = "lists/getbytitle('SupportRecord_Daily')";
     95| 
     96|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |     ^
     97|       status: 409,
     98|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/13]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
AssertionError: expected Error: APIリクエストに失敗しました (428 )
 to match object { status: 428 }

- Expected
+ Received

- Object {
-   "status": 428,
- }
+ [Error: APIリクエストに失敗しました (428 )
+ ]

 ❯ tests/unit/spClient.etag-conflict.spec.ts:110:5
    108|     const list = "lists/getbytitle('SupportRecord_Daily')";
    109| 
    110|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |     ^
    111|       status: 428,
    112|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/13]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
AssertionError: expected Error: APIリクエストに失敗しました (412 )
 to be an instance of SharePointMissingEtagError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:127:5
    125|     const list = "lists/getbytitle('SupportRecord_Daily')";
    126| 
    127|     await expect(
       |     ^
    128|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
    129|     ).rejects.toBeInstanceOf(SharePointMissingEtagError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/13]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/13]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/13]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/13]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/13]⎯

 Test Files  8 failed | 19 passed (27)
      Tests  15 failed | 51 passed (66)
   Start at  09:26:39
   Duration  8.73s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 3 failed) 21ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 9ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent 1ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 1ms
     → Cannot read properties of undefined (reading 'json')
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ❯ tests/unit/spClient.ensureList.spec.ts (5 tests | 2 failed) 39ms
   × spClient ensureListExists > creates the list and adds missing fields 4ms
     → raiseHttpError is not defined
   × spClient ensureListExists > warns when an existing field misses the required flag 29ms
     → expected false to be true // Object.is equality
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 190ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 189ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

 ❯ tests/unit/spClient.etag-conflict.spec.ts (5 tests | 5 failed) 20ms
   × spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value 13ms
     → promise rejected "ReferenceError: raiseHttpError is not def…" instead of resolving
   × spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412) 1ms
     → expected ReferenceError: raiseHttpError is not def… to be an instance of SharePointItemNotFoundError
   × spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error 2ms
     → expected ReferenceError: raiseHttpError is not def… to match object { status: 409 }
   × spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error 1ms
     → expected ReferenceError: raiseHttpError is not def… to match object { status: 428 }
   × spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing 2ms
     → expected ReferenceError: raiseHttpError is not def… to be an instance of SharePointMissingEtagError
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 3ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 52ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1129ms
   × AppShell navigation > marks current route button with aria-current="page" 110ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1019ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 859ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 707ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 151ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 375ms
   ✓ spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds 374ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 129ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 119ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 76ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 73ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 6ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ❯ tests/unit/records.api.spec.ts (1 test | 1 failed) 7ms
   × records add failure (500) > propagates server error message on 500 6ms
     → expected [Function] to throw error matching /Internal Boom/ but got 'raiseHttpError is not defined'
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯ Failed Tests 15 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
ReferenceError: raiseHttpError is not defined
 ❯ spFetch src/lib/spClient.ts:409:7
    407| 
    408|     if (!response.ok) {
    409|       await raiseHttpError(response);
       |       ^
    410|     }
    411|     return response;
 ❯ tryGetListMetadata src/lib/spClient.ts:525:15
 ❯ Object.ensureListExists src/lib/spClient.ts:577:19
 ❯ tests/unit/spClient.ensureList.spec.ts:52:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/15]⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ tests/unit/spClient.ensureList.spec.ts:133:26
    131|         return typeof message === 'string' && message.includes('requir…
    132|       });
    133|       expect(sawWarning).toBe(true);
       |                          ^
    134|     } finally {
    135|       warnSpy.mockRestore();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/15]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:244:30
    242|       const path = buildListItemsPath(listTitle, select, top);
    243|       const res = await client.spFetch(path);
    244|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    245|       return (json.value ?? []) as TRow[];
    246|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:716:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:56:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/15]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:244:30
    242|       const path = buildListItemsPath(listTitle, select, top);
    243|       const res = await client.spFetch(path);
    244|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    245|       return (json.value ?? []) as TRow[];
    246|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:716:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:82:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/15]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:244:30
    242|       const path = buildListItemsPath(listTitle, select, top);
    243|       const res = await client.spFetch(path);
    244|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    245|       return (json.value ?? []) as TRow[];
    246|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:716:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/15]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
AssertionError: promise rejected "ReferenceError: raiseHttpError is not def…" instead of resolving
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:88
     38|     const list = "lists/getbytitle('SupportRecord_Daily')";
     39| 
     40|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |                                                                                        ^
     41| 
     42|     expect(fetchMock).toHaveBeenCalledTimes(3);

Caused by: ReferenceError: raiseHttpError is not defined
 ❯ spFetch src/lib/spClient.ts:409:7
 ❯ updateItemByTitle src/lib/spClient.ts:456:17
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:5

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/15]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
AssertionError: expected ReferenceError: raiseHttpError is not def… to be an instance of SharePointItemNotFoundError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:82:5
     80|     const list = "lists/getbytitle('SupportRecord_Daily')";
     81| 
     82|     await expect(
       |     ^
     83|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
     84|     ).rejects.toBeInstanceOf(SharePointItemNotFoundError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/15]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
AssertionError: expected ReferenceError: raiseHttpError is not def… to match object { status: 409 }

- Expected
+ Received

- Object {
-   "status": 409,
- }
+ [ReferenceError: raiseHttpError is not defined]

 ❯ tests/unit/spClient.etag-conflict.spec.ts:96:5
     94|     const list = "lists/getbytitle('SupportRecord_Daily')";
     95| 
     96|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |     ^
     97|       status: 409,
     98|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/15]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
AssertionError: expected ReferenceError: raiseHttpError is not def… to match object { status: 428 }

- Expected
+ Received

- Object {
-   "status": 428,
- }
+ [ReferenceError: raiseHttpError is not defined]

 ❯ tests/unit/spClient.etag-conflict.spec.ts:110:5
    108|     const list = "lists/getbytitle('SupportRecord_Daily')";
    109| 
    110|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |     ^
    111|       status: 428,
    112|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/15]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
AssertionError: expected ReferenceError: raiseHttpError is not def… to be an instance of SharePointMissingEtagError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:127:5
    125|     const list = "lists/getbytitle('SupportRecord_Daily')";
    126| 
    127|     await expect(
       |     ^
    128|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
    129|     ).rejects.toBeInstanceOf(SharePointMissingEtagError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/15]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/15]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/15]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/15]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/15]⎯

 FAIL  tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
AssertionError: expected [Function] to throw error matching /Internal Boom/ but got 'raiseHttpError is not defined'

- Expected: 
/Internal Boom/

+ Received: 
"raiseHttpError is not defined"

 ❯ tests/unit/records.api.spec.ts:24:5
     22| 
     23|     const client = createSpClient(acquireToken, 'https://contoso.share…
     24|     await expect(client.addListItemByTitle('SupportRecord_Daily', { Ti…
       |     ^
     25|     expect(fetchSpy).toHaveBeenCalledTimes(1);
     26|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/15]⎯

 Test Files  9 failed | 18 passed (27)
      Tests  17 failed | 49 passed (66)
   Start at  09:26:49
   Duration  7.93s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ❯ tests/unit/spClient.ensureList.spec.ts (5 tests | 1 failed) 13ms
   × spClient ensureListExists > warns when an existing field misses the required flag 6ms
     → expected false to be true // Object.is equality
 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 3 failed) 18ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 5ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent 1ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 1ms
     → Cannot read properties of undefined (reading 'json')
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 102ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 101ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('lists%2Fgetbytitle('SupportRecord_Daily')')/items(10)

 ❯ tests/unit/spClient.etag-conflict.spec.ts (5 tests | 3 failed) 13ms
   × spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value 9ms
     → promise rejected "Error: APIリクエストに失敗しました (412 ) { …(1) }" instead of resolving
   × spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412) 1ms
     → expected Error: APIリクエストに失敗しました (412 ) { …(1) } to be an instance of SharePointItemNotFoundError
   × spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing 1ms
     → expected Error: APIリクエストに失敗しました (412 ) { …(1) } to be an instance of SharePointMissingEtagError
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 6ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 82ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1133ms
   × AppShell navigation > marks current route button with aria-current="page" 111ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1021ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 175ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 221ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 127ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 64ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 66ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1629ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1385ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 5ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 390ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 389ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 4ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯ Failed Tests 11 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ tests/unit/spClient.ensureList.spec.ts:133:26
    131|         return typeof message === 'string' && message.includes('requir…
    132|       });
    133|       expect(sawWarning).toBe(true);
       |                          ^
    134|     } finally {
    135|       warnSpy.mockRestore();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/11]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:747:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:56:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/11]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:747:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:82:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/11]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:747:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/11]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
AssertionError: promise rejected "Error: APIリクエストに失敗しました (412 ) { …(1) }" instead of resolving
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:88
     38|     const list = "lists/getbytitle('SupportRecord_Daily')";
     39| 
     40|     await expect(client.updateItem(list, 10, { Title: 'edited' }, { if…
       |                                                                                        ^
     41| 
     42|     expect(fetchMock).toHaveBeenCalledTimes(3);

Caused by: Error: APIリクエストに失敗しました (412 )
 ❯ raiseHttpError src/lib/spClient.ts:252:67
 ❯ spFetch src/lib/spClient.ts:440:7
 ❯ updateItemByTitle src/lib/spClient.ts:487:17
 ❯ tests/unit/spClient.etag-conflict.spec.ts:40:5

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { status: 412 }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/11]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
AssertionError: expected Error: APIリクエストに失敗しました (412 ) { …(1) } to be an instance of SharePointItemNotFoundError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:82:5
     80|     const list = "lists/getbytitle('SupportRecord_Daily')";
     81| 
     82|     await expect(
       |     ^
     83|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
     84|     ).rejects.toBeInstanceOf(SharePointItemNotFoundError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/11]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
AssertionError: expected Error: APIリクエストに失敗しました (412 ) { …(1) } to be an instance of SharePointMissingEtagError
 ❯ tests/unit/spClient.etag-conflict.spec.ts:127:5
    125|     const list = "lists/getbytitle('SupportRecord_Daily')";
    126| 
    127|     await expect(
       |     ^
    128|       client.updateItem(list, 10, { Title: 'edited' }, { ifMatch: 'W/"…
    129|     ).rejects.toBeInstanceOf(SharePointMissingEtagError);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/11]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/11]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/11]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/11]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/11]⎯

 Test Files  8 failed | 19 passed (27)
      Tests  13 failed | 53 passed (66)
   Start at  09:27:03
   Duration  7.94s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ❯ tests/unit/spClient.etag-conflict.spec.ts (5 tests | 1 failed) 14ms
   × spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value 9ms
     → expected undefined to be 'GET' // Object.is equality
 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 3 failed) 19ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 5ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent 2ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 2ms
     → Cannot read properties of undefined (reading 'json')
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 127ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 127ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ❯ tests/unit/spClient.ensureList.spec.ts (5 tests | 1 failed) 13ms
   × spClient ensureListExists > warns when an existing field misses the required flag 7ms
     → expected false to be true // Object.is equality
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 33ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1152ms
   × AppShell navigation > marks current route button with aria-current="page" 126ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1026ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 159ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 140ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 118ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 58ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1535ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1330ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 325ms
   ✓ spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds 324ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 59ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 11ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 5ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 4ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 9 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ tests/unit/spClient.ensureList.spec.ts:133:26
    131|         return typeof message === 'string' && message.includes('requir…
    132|       });
    133|       expect(sawWarning).toBe(true);
       |                          ^
    134|     } finally {
    135|       warnSpy.mockRestore();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/9]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:815:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:56:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/9]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:815:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:82:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/9]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:815:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/9]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
AssertionError: expected undefined to be 'GET' // Object.is equality

- Expected: 
"GET"

+ Received: 
undefined

 ❯ tests/unit/spClient.etag-conflict.spec.ts:56:25
     54| 
     55|   const [url2, init2] = fetchMock.mock.calls[1]!;
     56|   expect(init2?.method).toBe('GET');
       |                         ^
     57|   const url2Obj = new URL(String(url2));
     58|   expect(url2Obj.pathname.endsWith('/items(10)')).toBe(true);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/9]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/9]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/9]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/9]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/9]⎯

 Test Files  8 failed | 19 passed (27)
      Tests  11 failed | 55 passed (66)
   Start at  09:27:49
   Duration  7.88s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 3 failed) 19ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 5ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent 2ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 2ms
     → Cannot read properties of undefined (reading 'json')
 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ tests/unit/spClient.ensureList.spec.ts (5 tests | 1 failed) 13ms
   × spClient ensureListExists > warns when an existing field misses the required flag 7ms
     → expected false to be true // Object.is equality
 ❯ tests/unit/spClient.etag-conflict.spec.ts (5 tests | 1 failed) 14ms
   × spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value 9ms
     → expected undefined to be 'GET' // Object.is equality
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1152ms
   × AppShell navigation > marks current route button with aria-current="page" 126ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1026ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 127ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 127ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 136ms
 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 3ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  8 failed | 1 passed (9)
      Tests  11 failed | 13 passed (24)
   Start at  09:28:19
   Duration  834ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 3 failed) 17ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 5ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent 1ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 2ms
     → Cannot read properties of undefined (reading 'json')
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ❯ tests/unit/spClient.etag-conflict.spec.ts (5 tests | 1 failed) 15ms
   × spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value 10ms
     → expected undefined to be 'GET' // Object.is equality
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 110ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 109ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ❯ tests/unit/spClient.ensureList.spec.ts (5 tests | 1 failed) 18ms
   × spClient ensureListExists > warns when an existing field misses the required flag 6ms
     → expected false to be true // Object.is equality
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 248ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1123ms
   × AppShell navigation > marks current route button with aria-current="page" 106ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1016ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 180ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 135ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 157ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 64ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 62ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 67ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2068ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 308ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1755ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/checklist.api.spec.ts (1 test) 6ms
 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 7ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 9ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 7ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 3ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 9 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ tests/unit/spClient.ensureList.spec.ts:133:26
    131|         return typeof message === 'string' && message.includes('requir…
    132|       });
    133|       expect(sawWarning).toBe(true);
       |                          ^
    134|     } finally {
    135|       warnSpy.mockRestore();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/9]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:815:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:56:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/9]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:815:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:82:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/9]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:815:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/9]⎯

 FAIL  tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
AssertionError: expected undefined to be 'GET' // Object.is equality

- Expected: 
"GET"

+ Received: 
undefined

 ❯ tests/unit/spClient.etag-conflict.spec.ts:56:25
     54| 
     55|   const [url2, init2] = fetchMock.mock.calls[1]!;
     56|   expect(init2?.method).toBe('GET');
       |                         ^
     57|   const url2Obj = new URL(String(url2));
     58|   expect(url2Obj.pathname.endsWith('/items(10)')).toBe(true);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/9]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/9]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/9]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/9]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/9]⎯

 Test Files  8 failed | 19 passed (27)
      Tests  11 failed | 55 passed (66)
   Start at  09:29:31
   Duration  8.50s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 3 failed) 16ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 7ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent 1ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 1ms
     → Cannot read properties of undefined (reading 'json')
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ❯ tests/unit/spClient.ensureList.spec.ts (5 tests | 1 failed) 15ms
   × spClient ensureListExists > warns when an existing field misses the required flag 4ms
     → expected false to be true // Object.is equality
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 111ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 111ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 14ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 3ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 13ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1147ms
   × AppShell navigation > marks current route button with aria-current="page" 125ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1020ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 141ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 109ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 127ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 67ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 193ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1604ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 320ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1275ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 77ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 8ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 6ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 8 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ tests/unit/spClient.ensureList.spec.ts:133:26
    131|         return typeof message === 'string' && message.includes('requir…
    132|       });
    133|       expect(sawWarning).toBe(true);
       |                          ^
    134|     } finally {
    135|       warnSpy.mockRestore();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/8]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:815:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:56:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/8]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:815:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:82:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/8]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:815:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/8]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/8]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/8]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/8]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/8]⎯

 Test Files  7 failed | 20 passed (27)
      Tests  10 failed | 56 passed (66)
   Start at  09:29:39
   Duration  7.37s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 15ms
 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 3 failed) 20ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 6ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent 3ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 3ms
     → Cannot read properties of undefined (reading 'json')
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 270ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 269ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 12ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 6ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 5ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1202ms
   × AppShell navigation > marks current route button with aria-current="page" 182ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1018ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 280ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1397ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1180ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 204ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 210ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 73ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 11ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 71ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 8ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 154ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 8ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 6ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 3ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 7 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:816:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:56:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/7]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:816:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:82:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/7]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:275:30
    273|       const path = buildListItemsPath(listTitle, select, top);
    274|       const res = await client.spFetch(path);
    275|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    276|       return (json.value ?? []) as TRow[];
    277|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:816:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/7]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/7]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/7]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/7]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/7]⎯

 Test Files  6 failed | 21 passed (27)
      Tests  9 failed | 57 passed (66)
   Start at  09:29:56
   Duration  8.99s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 2 failed) 14ms
   × spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing 5ms
     → Cannot read properties of undefined (reading 'json')
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 1ms
     → Cannot read properties of undefined (reading 'json')
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 150ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 149ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 3ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 129ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 99ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 94ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1153ms
   × AppShell navigation > marks current route button with aria-current="page" 140ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1012ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 398ms
   ✓ spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds 397ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 62ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 63ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 6ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 133ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 5ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 6ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 1ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2274ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 2095ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:276:30
    274|       const path = buildListItemsPath(listTitle, select, top);
    275|       const res = await client.spFetch(path);
    276|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    277|       return (json.value ?? []) as TRow[];
    278|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:817:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:56:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:276:30
    274|       const path = buildListItemsPath(listTitle, select, top);
    275|       const res = await client.spFetch(path);
    276|       const json = await res.json().catch(() => ({ value: [] })) as { …
       |                              ^
    277|       return (json.value ?? []) as TRow[];
    278|     } catch (error) {
 ❯ Module.getStaffMaster src/lib/spClient.ts:817:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯

 Test Files  6 failed | 21 passed (27)
      Tests  8 failed | 58 passed (66)
   Start at  09:40:18
   Duration  8.47s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 1 failed) 15ms
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 6ms
     → Failed to fetch list "Staff_Master" after optional field retries. Last query: /lists/getbytitle('Staff_Master')/items?%24select=Id%2CStaffID%2CStaffName%2CRole%2CPhone%2CEmail%2CAttendanceDays%2CCertifications&%24top=25
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 130ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 130ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 8ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 6ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 371ms
   ✓ spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds 370ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 232ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1169ms
   × AppShell navigation > marks current route button with aria-current="page" 153ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1015ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 130ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 170ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 126ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 64ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 57ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1881ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 333ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1540ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 6ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 6ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 3ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 3ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
Error: Failed to fetch list "Staff_Master" after optional field retries. Last query: /lists/getbytitle('Staff_Master')/items?%24select=Id%2CStaffID%2CStaffName%2CRole%2CPhone%2CEmail%2CAttendanceDays%2CCertifications&%24top=25
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:294:9
    292|   }
    293|   const finalPath = buildListItemsPath(listTitle, select, top);
    294|   throw new Error(`Failed to fetch list "${listTitle}" after optional …
       |         ^
    295| };
    296| 
 ❯ Module.getStaffMaster src/lib/spClient.ts:816:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯

 Test Files  6 failed | 21 passed (27)
      Tests  7 failed | 59 passed (66)
   Start at  09:41:11
   Duration  8.15s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > retries without optional fields when SharePoint reports missing FullNameKana
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 0,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'FullNameKana',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}
[spClient optional error] {
  listTitle: 'Users_Master',
  attempt: 0,
  error: Error: The field or property 'FullNameKana' does not exist.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:25:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:277:32)
      at Module.getUsersMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:806:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:34:33
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 1,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}

stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 0,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications',
    'Department',
    'Notes'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 0,
  error: Error: The field or property 'Email' does not exist.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:47:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:277:32)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:822:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:56:33
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 1,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'AttendanceDays',
    'Certifications',
    'Department',
    'Notes'
  ]
}

stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 0,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications',
    'Department',
    'Notes'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 0,
  error: Error: The field or property 'StaffID' does not exist.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:72:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:277:32)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:822:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:82:33
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 1,
  select: [
    'Id',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications',
    'Department',
    'Notes'
  ]
}

stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 0,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications',
    'Department',
    'Notes'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 0,
  error: Error: One or more field types are not installed properly. Go to the list settings page to delete these fields.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:98:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:277:32)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:822:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:112:33
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 1,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications',
    'Department'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 1,
  error: AssertionError: expected 0 to be less than 0
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:108:27)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:277:32)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:822:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:112:33
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17) {
    actual: 0,
    expected: 0,
    showDiff: false,
    operator: 'strictEqual'
  }
}
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 2,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 2,
  error: TypeError: Cannot read properties of undefined (reading 'json')
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:278:30)
      at processTicksAndRejections (node:internal/process/task_queues:95:5)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:822:16)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:112:18
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:5
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:11)
      at runSuite (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1205:15)
      at runSuite (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1205:15)
      at runFiles (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1262:5)
      at startTests (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1271:3)
}
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 3,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 3,
  error: TypeError: Cannot read properties of undefined (reading 'json')
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:278:30)
      at processTicksAndRejections (node:internal/process/task_queues:95:5)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:822:16)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:112:18
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:5
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:11)
      at runSuite (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1205:15)
      at runSuite (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1205:15)
      at runFiles (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1262:5)
      at startTests (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1271:3)
}
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 4,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 4,
  error: TypeError: Cannot read properties of undefined (reading 'json')
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:278:30)
      at processTicksAndRejections (node:internal/process/task_queues:95:5)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:822:16)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:112:18
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:5
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:11)
      at runSuite (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1205:15)
      at runSuite (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1205:15)
      at runFiles (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1262:5)
      at startTests (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1271:3)
}
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 5,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 5,
  error: TypeError: Cannot read properties of undefined (reading 'json')
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:278:30)
      at processTicksAndRejections (node:internal/process/task_queues:95:5)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:822:16)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:112:18
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:5
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:11)
      at runSuite (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1205:15)
      at runSuite (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1205:15)
      at runFiles (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1262:5)
      at startTests (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1271:3)
}
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 6,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 6,
  error: TypeError: Cannot read properties of undefined (reading 'json')
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:278:30)
      at processTicksAndRejections (node:internal/process/task_queues:95:5)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:822:16)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:112:18
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:5
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:11)
      at runSuite (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1205:15)
      at runSuite (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1205:15)
      at runFiles (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1262:5)
      at startTests (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1271:3)
}

stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > skips cached optional fields on subsequent requests
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 0,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'FullNameKana',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}
[spClient optional error] {
  listTitle: 'Users_Master',
  attempt: 0,
  error: Error: The field or property 'FullNameKana' does not exist.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:125:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:277:32)
      at Module.getUsersMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:806:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:138:20
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 1,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 0,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}

stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > restores optional fields after cache reset
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 0,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'FullNameKana',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}
[spClient optional error] {
  listTitle: 'Users_Master',
  attempt: 0,
  error: Error: The field or property 'FullNameKana' does not exist.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:156:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:277:32)
      at Module.getUsersMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:806:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:164:20
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 1,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 0,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'FullNameKana',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}

 ❯ tests/unit/spClient.optionalFields.spec.ts (7 tests | 1 failed) 21ms
   × spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field 3ms
     → Failed to fetch list "Staff_Master" after optional field retries. Last query: /lists/getbytitle('Staff_Master')/items?%24select=Id%2CStaffID%2CStaffName%2CRole%2CPhone%2CEmail%2CAttendanceDays%2CCertifications&%24top=25
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 163ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 163ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 3ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 11ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 18ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 125ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1171ms
   × AppShell navigation > marks current route button with aria-current="page" 154ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1016ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 105ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 865ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 635ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 156ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 12ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 80ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 62ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 6ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 6ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 5 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
Error: Failed to fetch list "Staff_Master" after optional field retries. Last query: /lists/getbytitle('Staff_Master')/items?%24select=Id%2CStaffID%2CStaffName%2CRole%2CPhone%2CEmail%2CAttendanceDays%2CCertifications&%24top=25
 ❯ fetchListItemsWithFallback src/lib/spClient.ts:300:9
    298|   }
    299|   const finalPath = buildListItemsPath(listTitle, select, top);
    300|   throw new Error(`Failed to fetch list "${listTitle}" after optional …
       |         ^
    301| };
    302| 
 ❯ Module.getStaffMaster src/lib/spClient.ts:822:16
 ❯ tests/unit/spClient.optionalFields.spec.ts:112:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/5]⎯

 Test Files  6 failed | 21 passed (27)
      Tests  7 failed | 59 passed (66)
   Start at  09:43:19
   Duration  6.95s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > retries without optional fields when SharePoint reports missing FullNameKana
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 0,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'FullNameKana',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}
[spClient optional error] {
  listTitle: 'Users_Master',
  attempt: 0,
  error: Error: The field or property 'FullNameKana' does not exist.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:25:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:278:32)
      at Module.getUsersMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:807:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:34:33
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 1,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}

stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > drops any non-required Staff_Master column when SharePoint reports it missing
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 0,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications',
    'Department',
    'Notes'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 0,
  error: Error: The field or property 'Email' does not exist.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:47:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:278:32)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:823:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:56:33
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 1,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'AttendanceDays',
    'Certifications',
    'Department',
    'Notes'
  ]
}

stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > falls back to requesting Staff_Master without StaffID when the column is absent
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 0,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications',
    'Department',
    'Notes'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 0,
  error: Error: The field or property 'StaffID' does not exist.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:72:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:278:32)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:823:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:82:33
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 1,
  select: [
    'Id',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications',
    'Department',
    'Notes'
  ]
}

stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > narrows Staff_Master select list even if SharePoint error does not reveal the missing field
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 0,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications',
    'Department',
    'Notes'
  ]
}
[spClient optional error] {
  listTitle: 'Staff_Master',
  attempt: 0,
  error: Error: One or more field types are not installed properly. Go to the list settings page to delete these fields.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:98:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:278:32)
      at Module.getStaffMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:823:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:112:33
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Staff_Master',
  attempt: 1,
  select: [
    'Id',
    'StaffID',
    'StaffName',
    'Role',
    'Phone',
    'Email',
    'AttendanceDays',
    'Certifications',
    'Department'
  ]
}

stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > skips cached optional fields on subsequent requests
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 0,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'FullNameKana',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}
[spClient optional error] {
  listTitle: 'Users_Master',
  attempt: 0,
  error: Error: The field or property 'FullNameKana' does not exist.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:125:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:278:32)
      at Module.getUsersMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:807:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:138:20
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 1,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 0,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}

stdout | tests/unit/spClient.optionalFields.spec.ts > spClient optional field fallback > restores optional fields after cache reset
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 0,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'FullNameKana',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}
[spClient optional error] {
  listTitle: 'Users_Master',
  attempt: 0,
  error: Error: The field or property 'FullNameKana' does not exist.
      at Object.<anonymous> (/Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:156:13)
      at Object.mockCall (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/spy/dist/index.js:61:17)
      at Object.spy [as spFetch] (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/tinyspy/dist/index.js:45:80)
      at fetchListItemsWithFallback (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:278:32)
      at Module.getUsersMaster (/Users/yasutakesougo/audit-management-system-mvp/src/lib/spClient.ts:807:22)
      at /Users/yasutakesougo/audit-management-system-mvp/tests/unit/spClient.optionalFields.spec.ts:164:20
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:146:14
      at file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:533:11
      at runWithTimeout (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:39:7)
      at runTest (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@vitest/runner/dist/index.js:1056:17)
}
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 1,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}
[spClient optional] {
  listTitle: 'Users_Master',
  attempt: 0,
  select: [
    'Id',
    'UserID',
    'FullName',
    'ContractDate',
    'IsHighIntensitySupportTarget',
    'ServiceStartDate',
    'ServiceEndDate',
    'FullNameKana',
    'Furigana',
    'Email',
    'Phone',
    'BirthDate'
  ]
}

 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 16ms
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 115ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 115ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 3ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 96ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 125ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 109ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1149ms
   × AppShell navigation > marks current route button with aria-current="page" 128ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1020ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 68ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 59ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 9ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 386ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 386ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 40ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1769ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1568ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 10ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 6ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
 ✓ src/lib/spClient.spec.ts (4 tests) 4ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯

 Test Files  5 failed | 22 passed (27)
      Tests  6 failed | 60 passed (66)
   Start at  09:43:54
   Duration  7.75s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 96ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 95ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 553ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 326ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 150ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 205ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 110ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1126ms
   × AppShell navigation > marks current route button with aria-current="page" 109ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1017ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 128ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 88ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 65ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 65ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 9ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 11ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 9ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 6ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 5ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 5ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 3ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 4 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯

 FAIL  tests/unit/a11y.records-users.composite.spec.tsx > Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together
Error: expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/a11y.records-users.composite.spec.tsx:102:21
    100|     }
    101| 
    102|     expect(results).toHaveNoViolations();
       |                     ^
    103|   });
    104| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯

 Test Files  5 failed | 22 passed (27)
      Tests  6 failed | 60 passed (66)
   Start at  09:44:02
   Duration  6.16s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/statusDictionary.spec.ts x1 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1126ms
   × AppShell navigation > marks current route button with aria-current="page" 109ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1017ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 96ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 95ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms

 Test Files  5 failed | 1 passed (6)
      Tests  6 failed | 4 passed (10)
   Start at  09:51:20
   Duration  176ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1126ms
   × AppShell navigation > marks current route button with aria-current="page" 109ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1017ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (1 test | 1 failed) 96ms
   × Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 95ms
     → expect(received).toHaveNoViolations(expected)

Expected the HTML found at $('input[type="date"]') to have no violations:

<input type="date" style="min-width: 160px; min-height: 44px; margin-right: 8px;" value="">

Received:

"Form elements must have labels (label)"

Fix any of the following:
  Element does not have an implicit (wrapped) <label>
  Element does not have an explicit <label>
  aria-label attribute does not exist or is empty
  aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
  Element has no title attribute
  Element has no placeholder attribute
  Element's default semantics were not overridden with role="none" or role="presentation"

You can find more information on this issue here: 
https://dequeuniversity.com/rules/axe/4.10/label?application=axeAPI
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 109ms
 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  5 failed | 1 passed (6)
      Tests  6 failed | 1 passed (7)
   Start at  09:54:14
   Duration  832ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/users/UsersPanel.test.tsx 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 110ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 158ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 112ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 122ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 71ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1123ms
   × AppShell navigation > marks current route button with aria-current="page" 108ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1014ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 59ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯

 Test Files  4 failed | 7 passed (11)
      Tests  5 failed | 16 passed (21)
   Start at  09:54:33
   Duration  4.08s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 149ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 227ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 108ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1136ms
   × AppShell navigation > marks current route button with aria-current="page" 116ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1018ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 122ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 122ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 65ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 55ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 62ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2506ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 318ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 2183ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 7ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 6ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 3ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 4ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯

 Test Files  4 failed | 23 passed (27)
      Tests  5 failed | 61 passed (66)
   Start at  09:54:56
   Duration  8.24s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/users/UsersPanel.test.tsx 

 ❯ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests | 2 failed) 9ms
   × useOperationHubData > aggregates SharePoint data into dashboard state 7ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
   × useOperationHubData > refresh triggers ensure and reloads 0ms
     → Failed to resolve import "@/stores/useUsers" from "src/features/operation-hub/useOperationHubData.ts". Does the file exist?
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 403ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 402ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 6ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 5ms
     → registerNotifier does not exist
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 111ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 77ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 78ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1230ms
   × AppShell navigation > marks current route button with aria-current="page" 198ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1031ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 97ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 57ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1884ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 319ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1560ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 55ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 21ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 6ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 8ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 4ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 5ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 3ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯

 Test Files  4 failed | 24 passed (28)
      Tests  5 failed | 62 passed (67)
   Start at  10:31:25
   Duration  9.13s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  package.json 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 112ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 339ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 339ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 134ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1131ms
   × AppShell navigation > marks current route button with aria-current="page" 115ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1016ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 144ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1004ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 774ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 137ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 139ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 112ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 108ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 64ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 70ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 60ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 24ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 229ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 9ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 10ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 9ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 9ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 7ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 8ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 7ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 5ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 5ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 2ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 2ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 1ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 1ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 4ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/features/schedule/__tests__/spClient.usercare.spec.ts [ src/features/schedule/__tests__/spClient.usercare.spec.ts ]
Error: Failed to resolve import "@/lib/spWrite" from "src/features/schedule/spClient.schedule.ts". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/features/schedule/spClient.schedule.ts:13:33
  8  |    SCHEDULE_FIELD_PERSON_TYPE
  9  |  } from "@/sharepoint/fields";
  10 |  import { spWriteResilient } from "@/lib/spWrite";
     |                                    ^
  11 |  import { readEnv } from "@/lib/env";
  12 |  const DEFAULT_LIST_TITLE = "Schedules";
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯

 Test Files  3 failed | 43 passed (46)
      Tests  3 failed | 106 passed (109)
   Start at  10:37:53
   Duration  10.17s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  package.json 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 200ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 821ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 786ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 334ms
   ✓ spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds 334ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 130ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 107ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1120ms
   × AppShell navigation > marks current route button with aria-current="page" 104ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1015ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 134ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 84ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 167ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 106ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 94ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 32ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 76ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 62ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 26ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 17ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 12ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 13ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 9ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 5ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 2ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 5ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 5ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 6ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 2ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 4ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 2ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 1ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 2ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 1ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/features/schedule/__tests__/spClient.usercare.spec.ts [ src/features/schedule/__tests__/spClient.usercare.spec.ts ]
Error: Failed to resolve import "@/lib/spWrite" from "src/features/schedule/spClient.schedule.ts". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/features/schedule/spClient.schedule.ts:13:33
  8  |    SCHEDULE_FIELD_PERSON_TYPE
  9  |  } from "@/sharepoint/fields";
  10 |  import { spWriteResilient } from "@/lib/spWrite";
     |                                    ^
  11 |  import { readEnv } from "@/lib/env";
  12 |  const DEFAULT_LIST_TITLE = "Schedules";
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯

 Test Files  3 failed | 43 passed (46)
      Tests  3 failed | 106 passed (109)
   Start at  10:38:23
   Duration  9.22s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  package.json 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 3ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 3ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 248ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 368ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 367ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 131ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1103ms
   × AppShell navigation > marks current route button with aria-current="page" 91ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1011ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 121ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 113ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 136ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2033ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 335ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1692ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 120ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 102ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 89ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 71ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 67ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 37ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 21ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 11ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 11ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 10ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 12ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 8ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 3ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 5ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 3ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 4ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 2ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 1ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 2ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 3ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 2ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/features/schedule/__tests__/spClient.usercare.spec.ts [ src/features/schedule/__tests__/spClient.usercare.spec.ts ]
Error: Failed to resolve import "@/lib/spWrite" from "src/features/schedule/spClient.schedule.ts". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/features/schedule/spClient.schedule.ts:13:33
  8  |    SCHEDULE_FIELD_PERSON_TYPE
  9  |  } from "@/sharepoint/fields";
  10 |  import { spWriteResilient } from "@/lib/spWrite";
     |                                    ^
  11 |  import { readEnv } from "@/lib/env";
  12 |  const DEFAULT_LIST_TITLE = "Schedules";
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯

 Test Files  3 failed | 43 passed (46)
      Tests  3 failed | 106 passed (109)
   Start at  10:42:15
   Duration  10.63s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  package.json 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 98ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 83ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 130ms
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1116ms
   × AppShell navigation > marks current route button with aria-current="page" 100ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1015ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 147ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 109ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1491ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1434ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 112ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 118ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 84ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 99ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 64ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 68ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 36ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 23ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 21ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 9ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 6ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 10ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 8ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 6ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 8ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 9ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 8ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 4ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 6ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 4ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 2ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 3ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 1ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/audit.spec.ts (3 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 1ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/features/schedule/__tests__/spClient.usercare.spec.ts [ src/features/schedule/__tests__/spClient.usercare.spec.ts ]
Error: Failed to resolve import "@/lib/spWrite" from "src/features/schedule/spClient.schedule.ts". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/features/schedule/spClient.schedule.ts:13:33
  8  |    SCHEDULE_FIELD_PERSON_TYPE
  9  |  } from "@/sharepoint/fields";
  10 |  import { spWriteResilient } from "@/lib/spWrite";
     |                                    ^
  11 |  import { readEnv } from "@/lib/env";
  12 |  const DEFAULT_LIST_TITLE = "Schedules";
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/4]⎯

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/AppShell.nav.spec.tsx:93:21
     91|     }
     92| 
     93|     expect(navRoot).toBeTruthy();
       |                     ^
     94|     expect(navRoot).toHaveAccessibleName(/主要ナビゲーション/i);
     95|     const nav = within(navRoot ?? screen.getByRole('navigation'));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/4]⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
TestingLibraryElementError: Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/AppShell.nav.spec.tsx:142:40
    140|     });
    141| 
    142|     const checkingLabel = await screen.findByText(/Checking/i);
       |                                        ^
    143|     expect(checkingLabel.closest('[role="status"]')).not.toBeNull();
    144|     expect(screen.queryByText(/SP Error/i)).toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/4]⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/4]⎯

 Test Files  3 failed | 43 passed (46)
      Tests  3 failed | 106 passed (109)
   Start at  10:42:24
   Duration  9.30s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useUsers.ts x7 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1116ms
   × AppShell navigation > marks current route button with aria-current="page" 100ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1015ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 87ms

 Test Files  3 failed | 1 passed (4)
      Tests  3 failed | 2 passed (5)
   Start at  10:47:30
   Duration  279ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useUsers.ts x8 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1116ms
   × AppShell navigation > marks current route button with aria-current="page" 100ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1015ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 67ms

 Test Files  3 failed | 1 passed (4)
      Tests  3 failed | 2 passed (5)
   Start at  10:47:46
   Duration  247ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useStaff.ts x9 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1116ms
   × AppShell navigation > marks current route button with aria-current="page" 100ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1015ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 62ms

 Test Files  3 failed | 1 passed (4)
      Tests  3 failed | 2 passed (5)
   Start at  10:47:56
   Duration  233ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1116ms
   × AppShell navigation > marks current route button with aria-current="page" 100ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1015ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 78ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 131ms
 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 2ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 2ms
     → registerNotifier does not exist

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  3 failed | 2 passed (5)
      Tests  3 failed | 3 passed (6)
   Start at  10:48:03
   Duration  1.08s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/sharepoint/fields.ts 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1116ms
   × AppShell navigation > marks current route button with aria-current="page" 100ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1015ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 69ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 102ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 85ms
 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 4ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 4ms
     → registerNotifier does not exist

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: registerNotifier does not exist
 ❯ tests/unit/App.notifier.spec.tsx:12:22
     10| describe('App notifier → toast bridge', () => {
     11|   beforeEach(() => {
     12|     registerSpy = vi.spyOn(noticeModule, 'registerNotifier').mockImple…
       |                      ^
     13|       lastHandler = fn;
     14|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  3 failed | 3 passed (6)
      Tests  3 failed | 4 passed (7)
   Start at  10:50:58
   Duration  1.57s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/notice.ts 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 1116ms
   × AppShell navigation > marks current route button with aria-current="page" 100ms
     → expected null to be truthy
   × AppShell navigation > leaves status neutral when ping aborts 1015ms
     → Unable to find an element with the text: /Checking/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<header[39m
      [33mclass[39m=[32m"MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-ptdwpq-MuiPaper-root-MuiAppBar-root"[39m
      [33mstyle[39m=[32m"--Paper-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-1bb4lqe-MuiToolbar-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-1bv5yfe-MuiTypography-root"[39m
        [36m>[39m
          [0m運営指導・記録管理[0m
        [36m</div>[39m
        [36m<span[39m
          [33mstyle[39m=[32m"color: rgb(255, 255, 255); padding: 2px 8px; border-radius: 12px; font-size: 12px; background: rgb(211, 47, 47);"[39m
        [36m>[39m
          [0mSP Error[0m
        [36m</span>[39m
        [36m<a[39m
          [33maria-label[39m=[32m"監査ログ"[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-sizeMedium css-h7cjts-MuiButtonBase-root-MuiIconButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"HistoryIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</a>[39m
      [36m</div>[39m
    [36m</header>[39m
    [36m<div[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-1kof7mf-MuiStack-root"[39m
      [36m>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeSmall MuiButton-containedSizeSmall MuiButton-colorPrimary css-tw6tsg-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m日次記録[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/checklist"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m自己点検[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/audit"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0m監査ログ[0m
        [36m</a>[39m
        [36m<a[39m
          [33mclass[39m=[32m"MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"[39m
          [33mhref[39m=[32m"/schedules/week"[39m
          [33mtabindex[39m=[32m"0"[39m
        [36m>[39m
          [0mスケジュール（週表示）[0m
        [36m</a>[39m
      [36m</div>[39m
      [36m<div />[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 128ms
stderr | tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Warning: React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: undefined. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.

Check your code at App.notifier.spec.tsx:26.
Error: Uncaught [Error: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: undefined. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: undefined. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.
    at createFiberFromTypeAndProps (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:28478:17)
    at createFiberFromElement (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:28504:15)
    at createChild (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:13345:28)
    at reconcileChildrenArray (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:13640:25)
    at reconcileChildFibers (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:14057:16)
    at reconcileChildren (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:19186:28)
    at updateContextProvider (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21193:3)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21688:14)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
Error: Uncaught [Error: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: undefined. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: undefined. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.
    at createFiberFromTypeAndProps (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:28478:17)
    at createFiberFromElement (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:28504:15)
    at createChild (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:13345:28)
    at reconcileChildrenArray (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:13640:25)
    at reconcileChildFibers (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:14057:16)
    at reconcileChildren (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:19186:28)
    at updateContextProvider (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21193:3)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21688:14)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
The above error occurred in the <Context.Provider> component:

    at ToastProvider (/Users/yasutakesougo/audit-management-system-mvp/src/hooks/useToast.ts:14:26)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

 ❯ tests/unit/App.notifier.spec.tsx (1 test | 1 failed) 12ms
   × App notifier → toast bridge > registers notifier and shows a toast when invoked 12ms
     → Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: undefined. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/App.notifier.spec.tsx > App notifier → toast bridge > registers notifier and shows a toast when invoked
Error: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: undefined. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.
 ❯ createFiberFromTypeAndProps node_modules/react-dom/cjs/react-dom.development.js:28478:17
 ❯ createFiberFromElement node_modules/react-dom/cjs/react-dom.development.js:28504:15
 ❯ createChild node_modules/react-dom/cjs/react-dom.development.js:13345:28
 ❯ reconcileChildrenArray node_modules/react-dom/cjs/react-dom.development.js:13640:25
 ❯ reconcileChildFibers node_modules/react-dom/cjs/react-dom.development.js:14057:16
 ❯ reconcileChildren node_modules/react-dom/cjs/react-dom.development.js:19186:28
 ❯ updateContextProvider node_modules/react-dom/cjs/react-dom.development.js:21193:3
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21688:14
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  3 failed | 1 passed (4)
      Tests  3 failed | 2 passed (5)
   Start at  10:57:01
   Duration  1.06s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/AppShell.tsx 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ❯ tests/unit/App.notifier.spec.tsx (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 2 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx [ tests/unit/AppShell.nav.spec.tsx ]
 FAIL  tests/unit/App.notifier.spec.tsx [ tests/unit/App.notifier.spec.tsx ]
Error: Failed to resolve import "@/ui/components/SignInButton" from "src/app/AppShell.tsx". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/app/AppShell.tsx:16:25
  15 |  import { Link as RouterLink, useLocation } from "react-router-dom";
  16 |  import { isComplianceFormEnabled, isSchedulesCreateEnabled, isSchedulesFeatureEnabled } from "@/lib/env";
  17 |  import SignInButton from "@/ui/components/SignInButton";
     |                            ^
  18 |  import { ColorModeContext } from "@/app/theme";
  19 |  import { useSP } from "../lib/spClient";
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯

 Test Files  3 failed (3)
      Tests  no tests
   Start at  10:57:26
   Duration  240ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/AppShell.tsx 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ❯ tests/unit/App.notifier.spec.tsx (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 2 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx [ tests/unit/AppShell.nav.spec.tsx ]
 FAIL  tests/unit/App.notifier.spec.tsx [ tests/unit/App.notifier.spec.tsx ]
Error: Failed to resolve import "@/ui/components/SignInButton" from "src/app/AppShell.tsx". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/app/AppShell.tsx:16:25
  15 |  import { Link as RouterLink, useLocation } from "react-router-dom";
  16 |  import { isComplianceFormEnabled, isSchedulesCreateEnabled, isSchedulesFeatureEnabled } from "@/lib/env";
  17 |  import SignInButton from "@/ui/components/SignInButton";
     |                            ^
  18 |  import { ColorModeContext } from "@/app/theme";
  19 |  import { useSP } from "../lib/spClient";
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯

 Test Files  3 failed (3)
      Tests  no tests
   Start at  10:58:01
   Duration  289ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/App.tsx x29 

 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (0 test)
 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  2 failed | 1 passed (3)
      Tests  1 passed (1)
   Start at  10:58:59
   Duration  369ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/schedule/spClient.schedule.ts 

 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 20ms

 Test Files  1 failed | 2 passed (3)
      Tests  4 passed (4)
   Start at  11:08:12
   Duration  548ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/schedule/spClient.schedule.org.ts x8 

 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 12ms

 Test Files  1 failed | 1 passed (2)
      Tests  2 passed (2)
   Start at  11:09:17
   Duration  210ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/schedule/spClient.schedule.org.ts x9 

 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 14ms

 Test Files  1 failed | 1 passed (2)
      Tests  2 passed (2)
   Start at  11:09:25
   Duration  182ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/schedule/spClient.schedule.org.ts x10 

 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 12ms

 Test Files  1 failed | 1 passed (2)
      Tests  2 passed (2)
   Start at  11:09:41
   Duration  179ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/schedule/spClient.schedule.staff.ts x11 

 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 12ms

 Test Files  1 failed | 1 passed (2)
      Tests  2 passed (2)
   Start at  11:10:49
   Duration  164ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spWrite.ts 

 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests | 1 failed) 29ms
   × schedule SharePoint client (user-care) > create → get → update flow 21ms
     → Failed to parse URL from [object Object]
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/features/schedule/__tests__/spClient.usercare.spec.ts > schedule SharePoint client (user-care) > create → get → update flow
TypeError: Failed to parse URL from [object Object]
 ❯ Module.spWriteResilient src/lib/spWrite.ts:42:17
     40| 
     41|   while (attempt <= retries) {
     42|     const res = await fetch(url, {
       |                 ^
     43|       method,
     44|       headers,
 ❯ execute src/features/schedule/spClient.schedule.ts:224:25
 ❯ withScheduleFieldFallback src/features/schedule/spClient.schedule.ts:34:12

Caused by: TypeError: Invalid URL: [object Object]
 ❯ new URLImpl node_modules/whatwg-url/lib/URL-impl.js:20:13
 ❯ Object.exports.setup node_modules/whatwg-url/lib/URL.js:54:12
 ❯ new URL node_modules/whatwg-url/lib/URL.js:115:22
 ❯ Module.spWriteResilient src/lib/spWrite.ts:42:23
 ❯ execute src/features/schedule/spClient.schedule.ts:224:31
 ❯ withScheduleFieldFallback src/features/schedule/spClient.schedule.ts:34:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  2 failed | 1 passed (3)
      Tests  1 failed | 3 passed (4)
   Start at  11:38:19
   Duration  475ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spWrite.ts 

 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ❯ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests | 1 failed) 26ms
   × schedule SharePoint client (user-care) > create → get → update flow 19ms
     → Failed to parse URL from [object Object]
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/features/schedule/__tests__/spClient.usercare.spec.ts > schedule SharePoint client (user-care) > create → get → update flow
TypeError: Failed to parse URL from [object Object]
 ❯ Module.spWriteResilient src/lib/spWrite.ts:50:17
     48| 
     49|   while (attempt <= retries) {
     50|     const res = await fetch(url, {
       |                 ^
     51|       method,
     52|       headers,
 ❯ execute src/features/schedule/spClient.schedule.ts:224:25
 ❯ withScheduleFieldFallback src/features/schedule/spClient.schedule.ts:34:12

Caused by: TypeError: Invalid URL: [object Object]
 ❯ new URLImpl node_modules/whatwg-url/lib/URL-impl.js:20:13
 ❯ Object.exports.setup node_modules/whatwg-url/lib/URL.js:54:12
 ❯ new URL node_modules/whatwg-url/lib/URL.js:115:22
 ❯ Module.spWriteResilient src/lib/spWrite.ts:50:23
 ❯ execute src/features/schedule/spClient.schedule.ts:224:31
 ❯ withScheduleFieldFallback src/features/schedule/spClient.schedule.ts:34:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  2 failed | 1 passed (3)
      Tests  1 failed | 3 passed (4)
   Start at  11:43:27
   Duration  482ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spWrite.ts 

 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 21ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms

 Test Files  1 failed | 2 passed (3)
      Tests  4 passed (4)
   Start at  11:45:40
   Duration  460ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spWrite.ts 

 ❯ tests/unit/AppShell.nav.spec.tsx (0 test)
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 12ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 21ms

 Test Files  1 failed | 2 passed (3)
      Tests  4 passed (4)
   Start at  11:45:47
   Duration  274ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  package.json 

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 126ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 147ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 98ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 102ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 101ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 146ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 134ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 83ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 64ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 100ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 64ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 72ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 43ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 20ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 18ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2281ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 331ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1941ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 20ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 8ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 6ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 20ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 9ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 7ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 5ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 9ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 4ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 6ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 6ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 3ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 2ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 2ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 1ms
 ✓ tests/unit/audit.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

 Test Files  46 passed (46)
      Tests  111 passed (111)
   Start at  11:48:18
   Duration  10.11s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/auth/useAuth.ts 

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 121ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 139ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 395ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 394ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 117ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 160ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 99ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1345ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 312ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1025ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 75ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 338ms
   ✓ Composite accessibility smoke (records + users) > has no detectable violations when RecordList and UsersPanel render together 338ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 93ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 11ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 186ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 6ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 8ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 5ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 5ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

 Test Files  26 passed (26)
      Tests  66 passed (66)
   Start at  11:48:52
   Duration  8.01s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/audit/batchUtil.ts 

 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 58ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 111ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 132ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 304ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 303ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 4ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 3ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 16ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 1ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

 Test Files  12 passed (12)
      Tests  28 passed (28)
   Start at  11:49:11
   Duration  2.28s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/audit/useAuditSync.ts 

 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 63ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 110ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 144ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms

 Test Files  5 passed (5)
      Tests  13 passed (13)
   Start at  11:49:21
   Duration  1.37s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/audit/useAuditSyncBatch.ts 

 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 59ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 111ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 142ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 13ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

 Test Files  6 passed (6)
      Tests  17 passed (17)
   Start at  11:49:37
   Duration  1.49s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/records/RecordList.tsx 

 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 75ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  2 passed (2)
      Tests  2 passed (2)
   Start at  11:49:49
   Duration  595ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/debugLogger.ts 

 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 73ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 126ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 149ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 13ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

 Test Files  6 passed (6)
      Tests  17 passed (17)
   Start at  11:50:40
   Duration  2.07s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/adapters/schedules/sharepoint.ts x9 

stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 119ms

 Test Files  1 passed (1)
      Tests  2 passed (2)
   Start at  12:06:39
   Duration  449ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useUsers.ts x13 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 86ms

 Test Files  1 passed (1)
      Tests  2 passed (2)
   Start at  12:07:18
   Duration  249ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useStaff.ts x14 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 55ms

 Test Files  1 passed (1)
      Tests  2 passed (2)
   Start at  12:07:32
   Duration  156ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 74ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 129ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  3 passed (3)
      Tests  4 passed (4)
   Start at  12:07:42
   Duration  1.19s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/users/api.ts 

 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 77ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 104ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 103ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  4 passed (4)
      Tests  5 passed (5)
   Start at  12:08:35
   Duration  1.72s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/sharepoint/fields.ts 

 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 23ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 76ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 120ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 100ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 16ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 11ms

 Test Files  6 passed (6)
      Tests  9 passed (9)
   Start at  12:08:47
   Duration  1.82s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/operation-hub/ensureCoreLists.ts x16 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 58ms

 Test Files  1 passed (1)
      Tests  2 passed (2)
   Start at  12:09:05
   Duration  156ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/schedule/spMap.ts 

 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 20ms

 Test Files  2 passed (2)
      Tests  4 passed (4)
   Start at  12:09:12
   Duration  273ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 95ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 126ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 13ms

 Test Files  3 passed (3)
      Tests  4 passed (4)
   Start at  12:11:53
   Duration  1.41s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/theme.tsx 

stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 83ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 14ms

 Test Files  2 passed (2)
      Tests  3 passed (3)
   Start at  12:12:04
   Duration  698ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/theme.tsx 

stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 87ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 13ms

 Test Files  2 passed (2)
      Tests  3 passed (3)
   Start at  12:12:23
   Duration  700ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 107ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 209ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 397ms
   ✓ spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds 396ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 607ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 595ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 123ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 118ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 93ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 117ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 76ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 106ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 61ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 30ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 15ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 10ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/App.notifier.spec.tsx (1 test) 13ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 11ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 5ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 3ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 3ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

 Test Files  26 passed (26)
      Tests  66 passed (66)
   Start at  12:12:56
   Duration  6.07s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useStaff.ts x19 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 89ms

 Test Files  1 passed (1)
      Tests  2 passed (2)
   Start at  12:13:39
   Duration  280ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/operation-hub/useOperationHubData.ts x20 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 91ms

 Test Files  1 passed (1)
      Tests  2 passed (2)
   Start at  12:16:15
   Duration  284ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/operation-hub/useOperationHubData.ts x21 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 59ms

 Test Files  1 passed (1)
      Tests  2 passed (2)
   Start at  12:16:26
   Duration  164ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 69ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 115ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 11ms

 Test Files  3 passed (3)
      Tests  4 passed (4)
   Start at  12:16:56
   Duration  1.06s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 61ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 114ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  3 passed (3)
      Tests  4 passed (4)
   Start at  12:17:27
   Duration  1.03s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/schedule/__tests__/spClient.usercare.spec.ts x15 

 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 21ms

 Test Files  1 passed (1)
      Tests  2 passed (2)
   Start at  12:18:01
   Duration  174ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 93ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 113ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  3 passed (3)
      Tests  4 passed (4)
   Start at  12:24:07
   Duration  1.23s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/schedule/WeekPage.tsx 

 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 97ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 11ms

 Test Files  2 passed (2)
      Tests  2 passed (2)
   Start at  12:28:59
   Duration  850ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/schedule/WeekPage.tsx 

 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 105ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 11ms

 Test Files  2 passed (2)
      Tests  2 passed (2)
   Start at  12:29:10
   Duration  623ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/schedule/dateutils.local.spec.ts x1 

 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 12ms

 Test Files  1 passed (1)
      Tests  3 passed (3)
   Start at  12:34:38
   Duration  158ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/schedule/dateutils.local.spec.ts x2 

 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 12ms

 Test Files  1 passed (1)
      Tests  3 passed (3)
   Start at  12:34:47
   Duration  135ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/schedule/move.spec.ts x1 

 ✓ tests/unit/schedule/move.spec.ts (3 tests) 12ms

 Test Files  1 passed (1)
      Tests  3 passed (3)
   Start at  12:35:00
   Duration  145ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/schedule/move.spec.ts x2 

 ✓ tests/unit/schedule/move.spec.ts (3 tests) 11ms

 Test Files  1 passed (1)
      Tests  3 passed (3)
   Start at  12:35:15
   Duration  86ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/schedule/move.spec.ts x3 

 ✓ tests/unit/schedule/move.spec.ts (3 tests) 12ms

 Test Files  1 passed (1)
      Tests  3 passed (3)
   Start at  12:35:38
   Duration  94ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/schedule/workPattern.spec.ts x1 

 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 2ms

 Test Files  1 passed (1)
      Tests  5 passed (5)
   Start at  12:36:02
   Duration  149ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 127ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 167ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  3 passed (3)
      Tests  4 passed (4)
   Start at  12:38:23
   Duration  1.42s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 72ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 119ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 11ms

 Test Files  3 passed (3)
      Tests  4 passed (4)
   Start at  12:38:52
   Duration  1.16s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 98ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 123ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 11ms

 Test Files  3 passed (3)
      Tests  4 passed (4)
   Start at  12:38:59
   Duration  999ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/stores/useSchedules.ts 

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 87ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 126ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  3 passed (3)
      Tests  4 passed (4)
   Start at  12:39:30
   Duration  1.29s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/router.tsx x53 

 ✓ tests/unit/App.notifier.spec.tsx (1 test) 11ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  13:01:35
   Duration  493ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/router.tsx x54 

 ✓ tests/unit/App.notifier.spec.tsx (1 test) 14ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  13:02:19
   Duration  580ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/App.tsx x55 

 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  13:02:33
   Duration  467ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  package.json 

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 63ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 108ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 406ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 403ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 124ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 173ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 110ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 150ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1278ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1050ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 122ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 114ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 96ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 81ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 65ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 35ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 4ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 23ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 22ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 10ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 15ms
 ✓ tests/unit/schedule/move.spec.ts (3 tests) 19ms
 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 14ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 8ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 7ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 16ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 12ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 5ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 8ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 8ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 9ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 4ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 4ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 7ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 4ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 5ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 4ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 3ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 3ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 3ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 2ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 3ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

 Test Files  49 passed (49)
      Tests  122 passed (122)
   Start at  13:15:00
   Duration  10.04s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/ui.snapshot.spec.tsx x1 

 ❯ tests/unit/ui.snapshot.spec.tsx (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/ui.snapshot.spec.tsx [ tests/unit/ui.snapshot.spec.tsx ]
ReferenceError: test is not defined
 ❯ tests/unit/ui.snapshot.spec.tsx:7:1
      5| 
      6| // Wrap with MemoryRouter since AppShell renders navigation links usin…
      7| test("AppShell snapshot", () => {
       | ^
      8|   const { container } = render(
      9|     <MemoryRouter>

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  1 failed (1)
      Tests  no tests
   Start at  13:16:42
   Duration  146ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/ui.snapshot.spec.tsx x2 

 ❯ tests/unit/ui.snapshot.spec.tsx (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/ui.snapshot.spec.tsx [ tests/unit/ui.snapshot.spec.tsx ]
ReferenceError: test is not defined
 ❯ tests/unit/ui.snapshot.spec.tsx:7:1
      5| 
      6| // Wrap with MemoryRouter since AppShell renders navigation links usin…
      7| test("AppShell snapshot", () => {
       | ^
      8|   const { container } = render(
      9|     <MemoryRouter>

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  1 failed (1)
      Tests  no tests
   Start at  13:17:03
   Duration  122ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/ui.snapshot.spec.tsx x3 

stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 33ms

  Snapshots  1 written
 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  13:18:45
   Duration  257ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/features/schedule/spClient.schedule.ts 

 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 22ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms

 Test Files  2 passed (2)
      Tests  4 passed (4)
   Start at  13:22:52
   Duration  442ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/router.tsx x57 

 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  13:25:08
   Duration  488ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/AppShell.tsx 

stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/ui.snapshot.spec.tsx (1 test | 1 failed) 47ms
   × AppShell snapshot 47ms
     → Snapshot `AppShell snapshot 1` mismatched
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 99ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
Error: Snapshot `AppShell snapshot 1` mismatched

- Expected
+ Received

@@ -90,10 +90,17 @@
          >
            スケジュール（週表示）
          </a>
          <a
            class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"
+           href="/schedules/month"
+           tabindex="0"
+         >
+           スケジュール（月表示）
+         </a>
+         <a
+           class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"
            href="/audit"
            tabindex="0"
          >
            監査ログ
          </a>

 ❯ tests/unit/ui.snapshot.spec.tsx:17:21
     15|   );
     16| 
     17|   expect(container).toMatchSnapshot();
       |                     ^
     18| });
     19| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

  Snapshots  1 failed
 Test Files  1 failed | 2 passed (3)
      Tests  1 failed | 3 passed (4)
   Start at  13:25:15
   Duration  1.45s

 FAIL  Tests failed. Watching for file changes...
       press u to update snapshot, press h to show help
c[3J RERUN  tests/unit/schedule/month.spec.ts x1 

 ❯ tests/unit/ui.snapshot.spec.tsx (1 test | 1 failed) 47ms
   × AppShell snapshot 47ms
     → Snapshot `AppShell snapshot 1` mismatched
 ❯ tests/unit/schedule/month.spec.ts (2 tests | 1 failed) 6ms
   × getMonthlySchedule > queries entire calendar month window 4ms
     → Cannot read properties of undefined (reading 'json')

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/schedule/month.spec.ts > getMonthlySchedule > queries entire calendar month window
TypeError: Cannot read properties of undefined (reading 'json')
 ❯ execute src/features/schedule/spClient.schedule.ts:212:31
    210|     const path = `${LIST_PATH}?${search.toString()}`;
    211|     const res = await sp.spFetch(path, { headers: getHeadersWithPrefs(…
    212|     const payload = await res.json();
       |                               ^
    213|     return mapResponseItems(payload).map((item) => ensureUserSchedule(…
    214|   };
 ❯ withScheduleFieldFallback src/features/schedule/spClient.schedule.ts:34:12

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  2 failed (2)
      Tests  2 failed | 1 passed (3)
   Start at  13:25:47
   Duration  160ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/schedule/month.spec.ts x2 

 ❯ tests/unit/ui.snapshot.spec.tsx (1 test | 1 failed) 47ms
   × AppShell snapshot 47ms
     → Snapshot `AppShell snapshot 1` mismatched
 ❯ tests/unit/schedule/month.spec.ts (2 tests | 1 failed) 9ms
   × getMonthlySchedule > queries entire calendar month window 7ms
     → expected '/lists/getbytitle(\'ScheduleEvents\')…' to contain 'EventDate lt datetime\'2025-11-01T00:…'

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/schedule/month.spec.ts > getMonthlySchedule > queries entire calendar month window
AssertionError: expected '/lists/getbytitle(\'ScheduleEvents\')…' to contain 'EventDate lt datetime\'2025-11-01T00:…'

Expected: "EventDate lt datetime'2025-11-01T00:00:00.000Z'"
Received: "/lists/getbytitle('ScheduleEvents')/items?%24top=500&%24filter=%28cr014_category+eq+%27User%27%29+and+%28EventDate+lt+datetime%272025-11-01T00%3A00%3A00.000Z%27%29+and+%28EndDate+gt+datetime%272025-10-01T00%3A00%3A00.000Z%27%29&%24orderby=EventDate+asc%2CId+asc&%24select=Id%2CTitle%2CStartDateTime%2CEndDateTime%2CStatus%2Ccr014_category%2CServiceType%2Ccr014_personType%2Ccr014_personId%2Ccr014_personName%2Ccr014_externalPersonName%2Ccr014_externalPersonOrg%2Ccr014_externalPersonContact%2Ccr014_staffIds%2Ccr014_staffNames%2CBillingFlags%2CNote%2CAssignedStaff%2CAssignedStaffId%2CTargetUser%2CTargetUserId%2CRelatedResource%2CRelatedResourceId%2CRowKey%2Ccr014_dayKey%2Ccr014_fiscalYear%2CMonthKey%2CSubType%2Ccr014_orgAudience%2Ccr014_resourceId%2CExternalOrgName%2Ccr014_dayPart%2CCreatedAt%2CUpdatedAt%2CCreated%2CModified%2C%40odata.etag"

 ❯ tests/unit/schedule/month.spec.ts:25:20
     23|     expect(typeof path).toBe("string");
     24|     if (typeof path === "string") {
     25|       expect(path).toContain("EventDate lt datetime'2025-11-01T00:00:0…
       |                    ^
     26|       expect(path).toContain("EndDate gt datetime'2025-10-01T00:00:00.…
     27|     }

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  2 failed (2)
      Tests  2 failed | 1 passed (3)
   Start at  13:27:00
   Duration  176ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/schedule/month.spec.ts x3 

 ❯ tests/unit/ui.snapshot.spec.tsx (1 test | 1 failed) 47ms
   × AppShell snapshot 47ms
     → Snapshot `AppShell snapshot 1` mismatched
 ❯ tests/unit/schedule/month.spec.ts (2 tests | 1 failed) 7ms
   × getMonthlySchedule > queries entire calendar month window 6ms
     → expected '/lists/getbytitle(\'ScheduleEvents\')…' to contain 'EventDate lt datetime\'2025-11-01T00:…'

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/schedule/month.spec.ts > getMonthlySchedule > queries entire calendar month window
AssertionError: expected '/lists/getbytitle(\'ScheduleEvents\')…' to contain 'EventDate lt datetime\'2025-11-01T00:…'

Expected: "EventDate lt datetime'2025-11-01T00:00:00.000Z'"
Received: "/lists/getbytitle('ScheduleEvents')/items?$top=500&$filter=(cr014_category+eq+'User')+and+(EventDate+lt+datetime'2025-11-01T00:00:00.000Z')+and+(EndDate+gt+datetime'2025-10-01T00:00:00.000Z')&$orderby=EventDate+asc,Id+asc&$select=Id,Title,StartDateTime,EndDateTime,Status,cr014_category,ServiceType,cr014_personType,cr014_personId,cr014_personName,cr014_externalPersonName,cr014_externalPersonOrg,cr014_externalPersonContact,cr014_staffIds,cr014_staffNames,BillingFlags,Note,AssignedStaff,AssignedStaffId,TargetUser,TargetUserId,RelatedResource,RelatedResourceId,RowKey,cr014_dayKey,cr014_fiscalYear,MonthKey,SubType,cr014_orgAudience,cr014_resourceId,ExternalOrgName,cr014_dayPart,CreatedAt,UpdatedAt,Created,Modified,@odata.etag"

 ❯ tests/unit/schedule/month.spec.ts:26:23
     24|     if (typeof path === "string") {
     25|       const decoded = decodeURIComponent(path);
     26|       expect(decoded).toContain("EventDate lt datetime'2025-11-01T00:0…
       |                       ^
     27|       expect(decoded).toContain("EndDate gt datetime'2025-10-01T00:00:…
     28|     }

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  2 failed (2)
      Tests  2 failed | 1 passed (3)
   Start at  13:27:24
   Duration  104ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/schedule/month.spec.ts x4 

 ❯ tests/unit/ui.snapshot.spec.tsx (1 test | 1 failed) 47ms
   × AppShell snapshot 47ms
     → Snapshot `AppShell snapshot 1` mismatched
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 4ms

 Test Files  1 failed | 1 passed (2)
      Tests  1 failed | 2 passed (3)
   Start at  13:27:53
   Duration  217ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit

Restarting due to config changes...

 DEV  v2.1.9 /Users/yasutakesougo/audit-management-system-mvp

 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 6ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 109ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 130ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 15ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 20ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 27ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 105ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 125ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 103ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 4ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 2ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 77ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/schedule/move.spec.ts (3 tests) 15ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 130ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 273ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/lib/hashUtil.spec.ts (5 tests) 2ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 2ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 3ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 1ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/audit.spec.ts (3 tests) 1ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 56ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 59ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 3ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1931ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1684ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 3ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 15ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 1ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 5ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 1ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 14ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 2ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 119ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 38ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 106ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/ui.snapshot.spec.tsx (1 test | 1 failed) 39ms
   × AppShell snapshot 38ms
     → Snapshot `AppShell snapshot 1` mismatched

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
Error: Snapshot `AppShell snapshot 1` mismatched

- Expected
+ Received

@@ -90,10 +90,17 @@
          >
            スケジュール（週表示）
          </a>
          <a
            class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"
+           href="/schedules/month"
+           tabindex="0"
+         >
+           スケジュール（月表示）
+         </a>
+         <a
+           class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"
            href="/audit"
            tabindex="0"
          >
            監査ログ
          </a>

 ❯ tests/unit/ui.snapshot.spec.tsx:17:21
     15|   );
     16| 
     17|   expect(container).toMatchSnapshot();
       |                     ^
     18| });
     19| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

  Snapshots  1 failed
 Test Files  1 failed | 50 passed (51)
      Tests  1 failed | 124 passed (125)
   Start at  13:29:02
   Duration  6.25s (transform 430ms, setup 4.03s, collect 2.24s, tests 3.60s, environment 9.24s, prepare 1.48s)

 FAIL  Tests failed. Watching for file changes...
       press u to update snapshot, press h to show help
c[3J RERUN  package.json 

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 25ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 136ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/ui.snapshot.spec.tsx (1 test | 1 failed) 47ms
   × AppShell snapshot 46ms
     → Snapshot `AppShell snapshot 1` mismatched
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 125ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 148ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 148ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1143ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1102ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 97ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 120ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 165ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 163ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 104ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 76ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 76ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 50ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 22ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 25ms
 ✓ tests/unit/schedule/move.spec.ts (3 tests) 20ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 11ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 14ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 17ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 16ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 12ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 11ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 6ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 6ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 8ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 4ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 4ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 4ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 4ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 2ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 4ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 3ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 2ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 2ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 3ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 4ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
Error: Snapshot `AppShell snapshot 1` mismatched

- Expected
+ Received

@@ -90,10 +90,17 @@
          >
            スケジュール（週表示）
          </a>
          <a
            class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"
+           href="/schedules/month"
+           tabindex="0"
+         >
+           スケジュール（月表示）
+         </a>
+         <a
+           class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary MuiButton-root MuiButton-outlined MuiButton-outlinedPrimary MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorPrimary css-wyro15-MuiButtonBase-root-MuiButton-root"
            href="/audit"
            tabindex="0"
          >
            監査ログ
          </a>

 ❯ tests/unit/ui.snapshot.spec.tsx:17:21
     15|   );
     16| 
     17|   expect(container).toMatchSnapshot();
       |                     ^
     18| });
     19| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

  Snapshots  1 failed
 Test Files  1 failed | 50 passed (51)
      Tests  1 failed | 124 passed (125)
   Start at  13:29:18
   Duration  10.37s

 FAIL  Tests failed. Watching for file changes...
       press u to update snapshot, press h to show help
c[3J RERUN  package.json 

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 116ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 42ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 102ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 32ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 136ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 159ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 115ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 101ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 80ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 93ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1757ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1554ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 87ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 69ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 37ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 22ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 21ms
 ✓ tests/unit/schedule/move.spec.ts (3 tests) 12ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 366ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 366ms
 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 14ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 19ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 10ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 12ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 15ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ src/features/audit/batchParser.spec.ts (4 tests) 4ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 5ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 7ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 9ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 5ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 7ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 2ms
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 4ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 3ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 3ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 3ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 3ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ tests/unit/audit.spec.ts (3 tests) 1ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms

 Test Files  51 passed (51)
      Tests  125 passed (125)
   Start at  13:42:37
   Duration  10.67s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 116ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 143ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 381ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 380ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 105ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 98ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 70ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 64ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 84ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 59ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 34ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 37ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 11ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 6ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 8ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 6ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2468ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 2394ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 7ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 3ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms

 Test Files  27 passed (27)
      Tests  67 passed (67)
   Start at  13:48:16
   Duration  7.69s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/lib/spClient.ts 

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 108ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 140ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 320ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 319ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 106ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 94ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 92ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 71ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 64ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 61ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 38ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 110ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 5ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2200ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1984ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 5ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 7ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 3ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 3ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 2ms

 Test Files  27 passed (27)
      Tests  67 passed (67)
   Start at  13:49:34
   Duration  7.35s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  package.json 

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 131ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 175ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 150ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 34ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 119ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 97ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 104ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 86ms
 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 100ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1498ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1401ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 106ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 99ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 75ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 39ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 39ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 22ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 24ms
 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 14ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 14ms
 ✓ tests/unit/schedule/move.spec.ts (3 tests) 17ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 14ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 7ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 16ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 7ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 4ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 5ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 15ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 8ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 4ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 4ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 3ms
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 5ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 3ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 3ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 3ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 3ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 1ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 2ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

 Test Files  51 passed (51)
      Tests  125 passed (125)
   Start at  13:56:43
   Duration  10.17s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  package.json 

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 116ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 142ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 303ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 303ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 134ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 100ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 106ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 77ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 113ms
 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 97ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 82ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 59ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 36ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 35ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 20ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2429ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 2293ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 322ms
   ✓ spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds 321ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 26ms
 ✓ tests/unit/schedule/move.spec.ts (3 tests) 13ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 11ms
 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 14ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 9ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 22ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 7ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 14ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 4ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 4ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 6ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 3ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 6ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 3ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 3ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 5ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 3ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 2ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 4ms
 ✓ tests/unit/audit.spec.ts (3 tests) 1ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 3ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 3ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 2ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 3ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 3ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 2ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

 Test Files  51 passed (51)
      Tests  125 passed (125)
   Start at  13:56:55
   Duration  10.77s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  package.json 

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 124ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 183ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 167ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 120ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 138ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 117ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 105ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 81ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 89ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 71ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 104ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 57ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 36ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2179ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1967ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 43ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 22ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 24ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 8ms
 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 14ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 17ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 16ms
 ✓ tests/unit/schedule/move.spec.ts (3 tests) 16ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 8ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 8ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 6ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 9ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 5ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 3ms
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 6ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 6ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 2ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 3ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 3ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 4ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 3ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 3ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 1ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 1ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

 Test Files  51 passed (51)
      Tests  125 passed (125)
   Start at  13:59:16
   Duration  10.60s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  package.json 

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 37ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 142ms
stderr | tests/unit/Home.spec.tsx > Home > renders all tiles as accessible navigation links
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (2 tests) 145ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 238ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 111ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 116ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 99ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 86ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1348ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 301ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1042ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 113ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 76ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 67ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 74ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 41ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 51ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 30ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 20ms
 ✓ tests/unit/schedule/move.spec.ts (3 tests) 13ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms
 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 13ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 13ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 6ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 7ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 13ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 19ms
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 10ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 6ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 6ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 7ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 3ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 7ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 3ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 7ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 4ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 4ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 5ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 3ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 4ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 3ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 3ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 3ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 2ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 3ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

 Test Files  51 passed (51)
      Tests  125 passed (125)
   Start at  13:59:30
   Duration  10.95s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/config/featureFlags.spec.ts x1 

 ✓ tests/unit/config/featureFlags.spec.ts (3 tests) 2ms

 Test Files  1 passed (1)
      Tests  3 passed (3)
   Start at  14:14:27
   Duration  139ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/AppShell.tsx 

stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 45ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 98ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  3 passed (3)
      Tests  4 passed (4)
   Start at  14:14:43
   Duration  1.47s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/router.tsx x10 

 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  14:14:55
   Duration  361ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/Home.tsx x7 

 ❯ tests/unit/Home.spec.tsx (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx [ tests/unit/Home.spec.tsx ]
ReferenceError: Cannot access 'isSchedulesFeatureEnabledMock' before initialization
 ❯ Proxy.isSchedulesFeatureEnabled tests/unit/Home.spec.tsx:4:36
      2| import { render, screen } from '@testing-library/react';
      3| import { MemoryRouter } from 'react-router-dom';
      4| import { ThemeProvider, createTheme } from '@mui/material/styles';
       |                                    ^
      5| import { describe, expect, it, vi, beforeEach } from 'vitest';
      6| import Home from '@/app/Home';
 ❯ resolveFeatureFlags src/config/featureFlags.ts:10:14
 ❯ src/config/featureFlags.ts:15:50
 ❯ src/app/Home.tsx:30:32

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  1 failed (1)
      Tests  no tests
   Start at  14:15:39
   Duration  124ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/Home.tsx x8 

 ❯ tests/unit/Home.spec.tsx (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx [ tests/unit/Home.spec.tsx ]
ReferenceError: Cannot access 'isSchedulesFeatureEnabledMock' before initialization
 ❯ Proxy.isSchedulesFeatureEnabled tests/unit/Home.spec.tsx:4:36
      2| import { render, screen } from '@testing-library/react';
      3| import { MemoryRouter } from 'react-router-dom';
      4| import { ThemeProvider, createTheme } from '@mui/material/styles';
       |                                    ^
      5| import { describe, expect, it, vi, beforeEach } from 'vitest';
      6| import Home from '@/app/Home';
 ❯ resolveFeatureFlags src/config/featureFlags.ts:10:14
 ❯ src/config/featureFlags.ts:15:50
 ❯ src/app/Home.tsx:30:32

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  1 failed (1)
      Tests  no tests
   Start at  14:15:53
   Duration  66ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/AppShell.nav.spec.tsx x10 

 ❯ tests/unit/Home.spec.tsx (0 test)
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 86ms

 Test Files  1 failed | 1 passed (2)
      Tests  2 passed (2)
   Start at  14:16:10
   Duration  387ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/Home.spec.tsx x9 

 ❯ tests/unit/Home.spec.tsx (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx [ tests/unit/Home.spec.tsx ]
Error: [vitest] There was an error when mocking a module. If you are using "vi.mock" factory, make sure there are no top level variables inside, since this call is hoisted to top of the file. Read more: https://vitest.dev/api/vi.html#vi-mock
 ❯ src/app/Home.tsx:30:32
     28| import { isDemoModeEnabled } from '@/lib/env';
     29| import { useSchedulesToday } from '@/features/schedule/useSchedulesTod…
     30| import { featureFlags } from '@/config/featureFlags';
       |                                ^
     31| 
     32| type TileTone = 'primary' | 'success' | 'info' | 'warning' | 'secondar…

Caused by: ReferenceError: Cannot access 'featureFlagsMock' before initialization
 ❯ tests/unit/Home.spec.tsx:7:17
 ❯ src/app/Home.tsx:30:32

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  1 failed (1)
      Tests  no tests
   Start at  14:16:48
   Duration  123ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/Home.spec.tsx x10 

 ❯ tests/unit/Home.spec.tsx (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx [ tests/unit/Home.spec.tsx ]
Error: [vitest] There was an error when mocking a module. If you are using "vi.mock" factory, make sure there are no top level variables inside, since this call is hoisted to top of the file. Read more: https://vitest.dev/api/vi.html#vi-mock
 ❯ src/app/Home.tsx:30:32
     28| import { isDemoModeEnabled } from '@/lib/env';
     29| import { useSchedulesToday } from '@/features/schedule/useSchedulesTod…
     30| import { featureFlags } from '@/config/featureFlags';
       |                                ^
     31| 
     32| type TileTone = 'primary' | 'success' | 'info' | 'warning' | 'secondar…

Caused by: ReferenceError: Cannot access 'featureFlagsMock' before initialization
 ❯ tests/unit/Home.spec.tsx:7:17
 ❯ src/app/Home.tsx:30:32

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  1 failed (1)
      Tests  no tests
   Start at  14:17:05
   Duration  68ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/AppShell.nav.spec.tsx x11 

 ❯ tests/unit/Home.spec.tsx (0 test)
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 86ms

 Test Files  1 failed | 1 passed (2)
      Tests  2 passed (2)
   Start at  14:17:20
   Duration  300ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/Home.spec.tsx x11 

stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
Error: Uncaught [Error: [vitest] No "isSchedulesFeatureEnabled" export is defined on the "@/lib/env" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27165:5) Error: [vitest] No "isSchedulesFeatureEnabled" export is defined on the "@/lib/env" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at /Users/yasutakesougo/audit-management-system-mvp/src/features/schedule/useSchedulesToday.ts:64:10
    at commitHookEffectListMount (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27023:14) {
  codeFrame: 'vi.mock(import("@/lib/env"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.
The above error occurred in the <Home> component:

    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:167:40)
    at Router (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at MemoryRouter (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1101:7)
    at DefaultPropsProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/DefaultPropsProvider/DefaultPropsProvider.js:9:3)
    at RtlProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/RtlProvider/index.js:8:3)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/private-theming/esm/ThemeProvider/ThemeProvider.js:33:5)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/ThemeProvider/ThemeProvider.js:49:5)
    at ThemeProviderNoVars (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProviderNoVars.js:8:10)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProvider.js:9:3)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/unit/Home.spec.tsx > Home > shows schedule tiles and chips when flag enabled
Error: Uncaught [Error: [vitest] No "isSchedulesFeatureEnabled" export is defined on the "@/lib/env" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27165:5) Error: [vitest] No "isSchedulesFeatureEnabled" export is defined on the "@/lib/env" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at /Users/yasutakesougo/audit-management-system-mvp/src/features/schedule/useSchedulesToday.ts:64:10
    at commitHookEffectListMount (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27023:14) {
  codeFrame: 'vi.mock(import("@/lib/env"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
The above error occurred in the <Home> component:

    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:167:40)
    at Router (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at MemoryRouter (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1101:7)
    at DefaultPropsProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/DefaultPropsProvider/DefaultPropsProvider.js:9:3)
    at RtlProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/RtlProvider/index.js:8:3)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/private-theming/esm/ThemeProvider/ThemeProvider.js:33:5)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/ThemeProvider/ThemeProvider.js:49:5)
    at ThemeProviderNoVars (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProviderNoVars.js:8:10)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProvider.js:9:3)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

 ❯ tests/unit/Home.spec.tsx (3 tests | 3 failed) 83ms
   × Home > hides schedule tiles and chips when schedule flag disabled 51ms
     → [vitest] No "isSchedulesFeatureEnabled" export is defined on the "@/lib/env" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

   × Home > shows schedule tiles and chips when flag enabled 16ms
     → [vitest] No "isSchedulesFeatureEnabled" export is defined on the "@/lib/env" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

   × Home > indicates when demo mode is active 16ms
     → [vitest] No "isSchedulesFeatureEnabled" export is defined on the "@/lib/env" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

stderr | tests/unit/Home.spec.tsx > Home > indicates when demo mode is active
Error: Uncaught [Error: [vitest] No "isSchedulesFeatureEnabled" export is defined on the "@/lib/env" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27165:5) Error: [vitest] No "isSchedulesFeatureEnabled" export is defined on the "@/lib/env" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at /Users/yasutakesougo/audit-management-system-mvp/src/features/schedule/useSchedulesToday.ts:64:10
    at commitHookEffectListMount (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27023:14) {
  codeFrame: 'vi.mock(import("@/lib/env"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
The above error occurred in the <Home> component:

    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:167:40)
    at Router (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at MemoryRouter (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1101:7)
    at DefaultPropsProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/DefaultPropsProvider/DefaultPropsProvider.js:9:3)
    at RtlProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/RtlProvider/index.js:8:3)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/private-theming/esm/ThemeProvider/ThemeProvider.js:33:5)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/ThemeProvider/ThemeProvider.js:49:5)
    at ThemeProviderNoVars (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProviderNoVars.js:8:10)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProvider.js:9:3)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.


⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
 FAIL  tests/unit/Home.spec.tsx > Home > shows schedule tiles and chips when flag enabled
 FAIL  tests/unit/Home.spec.tsx > Home > indicates when demo mode is active
Error: [vitest] No "isSchedulesFeatureEnabled" export is defined on the "@/lib/env" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock(import("@/lib/env"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ src/features/schedule/useSchedulesToday.ts:64:10
     62|   useEffect(() => {
     63|     let alive = true;
     64|     if (!isSchedulesFeatureEnabled()) {
       |          ^
     65|       setData([]);
     66|       setLoading(false);
 ❯ commitHookEffectListMount node_modules/react-dom/cjs/react-dom.development.js:23189:26
 ❯ commitPassiveMountOnFiber node_modules/react-dom/cjs/react-dom.development.js:24970:11
 ❯ commitPassiveMountEffects_complete node_modules/react-dom/cjs/react-dom.development.js:24930:9
 ❯ commitPassiveMountEffects_begin node_modules/react-dom/cjs/react-dom.development.js:24917:7
 ❯ commitPassiveMountEffects node_modules/react-dom/cjs/react-dom.development.js:24905:3
 ❯ flushPassiveEffectsImpl node_modules/react-dom/cjs/react-dom.development.js:27078:3
 ❯ flushPassiveEffects node_modules/react-dom/cjs/react-dom.development.js:27023:14

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯

 Test Files  1 failed (1)
      Tests  3 failed (3)
   Start at  14:18:11
   Duration  377ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/Home.spec.tsx x12 

stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stderr | tests/unit/Home.spec.tsx
Warning: React has detected a change in the order of Hooks called by Home. This will lead to bugs and errors if not fixed. For more information, read the Rules of Hooks: https://reactjs.org/link/rules-of-hooks

   Previous render            Next render
   ------------------------------------------------------
1. useContext                 useContext
2. useDebugValue              useDebugValue
3. useState                   useState
4. useState                   useState
5. useState                   useState
6. useState                   useState
7. useState                   useState
8. useState                   useState
9. useRef                     useRef
10. useMemo                   useMemo
11. useEffect                 useEffect
12. useMemo                   useMemo
13. useMemo                   useMemo
14. useMemo                   useMemo
15. useMemo                   useMemo
16. useMemo                   useMemo
17. useMemo                   useMemo
18. undefined                 useMemo
   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:167:40)
    at Router (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at MemoryRouter (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1101:7)
    at DefaultPropsProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/DefaultPropsProvider/DefaultPropsProvider.js:9:3)
    at RtlProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/RtlProvider/index.js:8:3)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/private-theming/esm/ThemeProvider/ThemeProvider.js:33:5)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/ThemeProvider/ThemeProvider.js:49:5)
    at ThemeProviderNoVars (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProviderNoVars.js:8:10)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProvider.js:9:3)
Error: Uncaught [Error: Rendered more hooks than during the previous render.]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: Rendered more hooks than during the previous render.
    at updateWorkInProgressHook (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15688:13)
    at updateMemo (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:16412:14)
    at Object.useMemo (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:17067:16)
    at Object.useMemo (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react/cjs/react.development.js:1650:21)
    at /Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:230:35
    at Array.map (<anonymous>)
    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:229:24)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at updateFunctionComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:19617:20)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21640:16)
Error: Uncaught [Error: Rendered more hooks than during the previous render.]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: Rendered more hooks than during the previous render.
    at updateWorkInProgressHook (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15688:13)
    at updateMemo (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:16412:14)
    at Object.useMemo (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:17067:16)
    at Object.useMemo (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react/cjs/react.development.js:1650:21)
    at /Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:230:35
    at Array.map (<anonymous>)
    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:229:24)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at updateFunctionComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:19617:20)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21640:16)
The above error occurred in the <Home> component:

    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:167:40)
    at Router (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at MemoryRouter (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1101:7)
    at DefaultPropsProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/DefaultPropsProvider/DefaultPropsProvider.js:9:3)
    at RtlProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/RtlProvider/index.js:8:3)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/private-theming/esm/ThemeProvider/ThemeProvider.js:33:5)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/ThemeProvider/ThemeProvider.js:49:5)
    at ThemeProviderNoVars (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProviderNoVars.js:8:10)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProvider.js:9:3)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

 ❯ tests/unit/Home.spec.tsx (3 tests | 2 failed) 164ms
   × Home > shows schedule tiles and chips when flag enabled 44ms
     → expected [ <a …(4)>…(3)</a>, …(10) ] to have a length of 6 but got 11
   × Home > indicates when demo mode is active 30ms
     → Found multiple elements by: [data-testid="home-data-source-chip"]

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<div[39m
  [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeSmall MuiChip-colorInfo MuiChip-outlinedInfo css-91znoi-MuiChip-root"[39m
  [33mdata-testid[39m=[32m"home-data-source-chip"[39m
[36m>[39m
  [36m<span[39m
    [33mclass[39m=[32m"MuiChip-label MuiChip-labelSmall css-19m61dl-MuiChip-label"[39m
  [36m>[39m
    [0mデータソース: Demo[0m
  [36m</span>[39m
[36m</div>[39m

Ignored nodes: comments, script, style
[36m<div[39m
  [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeSmall MuiChip-colorInfo MuiChip-outlinedInfo css-91znoi-MuiChip-root"[39m
  [33mdata-testid[39m=[32m"home-data-source-chip"[39m
[36m>[39m
  [36m<span[39m
    [33mclass[39m=[32m"MuiChip-label MuiChip-labelSmall css-19m61dl-MuiChip-label"[39m
  [36m>[39m
    [0mデータソース: Demo[0m
  [36m</span>[39m
[36m</div>[39m

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<main[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-1h3ocin-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-8mcjw0-MuiStack-root"[39m
      [36m>[39m
        [36m<section[39m
          [33mclass[39m=[32m"MuiStack-root css-1sazv7p-MuiStack-root"[39m
        [36m>[39m
          [36m<div>[39m
            [36m<h1[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-ppzics-MuiTypography-root"[39m
            [36m>[39m
              [0mAudit Management MVP[0m
            [36m</h1>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body1 css-k16oju-MuiTypography-root"[39m
            [36m>[39m
              [0mSharePoint 接続や MSAL 認証を待たずに、利用者マスタと日次記録フローをすぐに体験できます。[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-rsvakl-MuiStack-root"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeMedium MuiChip-colorWarning MuiChip-outlinedWarning css-px44bf-MuiChip-root"[39m
              [33mdata-testid[39m=[32m"home-mode-chip"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall MuiChip-icon MuiChip-iconMedium MuiChip-iconColorWarning css-120dh41-MuiSvgIcon-root"[39m
                [33mdata-testid[39m=[32m"FiberManualRecordRoundedIcon"[39m
                [33mfocusable[39m=[32m"false"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
              [36m>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"12"[39m
                  [33mr[39m=[32m"8"[39m
                [36m/>[39m
              [36m</svg>[39m
              [36m<span[39m
                [33mclass[39m=[32m"MuiChip-label MuiChip-labelMedium css-16cgrcw-MuiChip-label"[39m
              [36m>[39m
                [0m本番モード（MSAL 認証あり）[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [36m<code[39m
                [33mclass[39m=[32m"MuiBox-root css-42drcr"[39m
              [36m>[39m
                [0mVITE_DEMO_MODE=1[0m
              [36m</code>[39m
              [0m [0m
              [0mに切り替えるとサンプルデータで試せます。[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</section>[39m
        [36m<section[39m
          [33maria-label[39m=[32m"主要機能のタイル一覧"[39m
          [33mclass[39m=[32m"MuiBox-root css-2o31b7"[39m
          [33mrole[39m=[32m"list"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-sarrn7-MuiPaper-root-MuiCard-root"[39m
            [33mdata-testid[39m=[32m"home-tile-users"[39m
            [33mrole[39m=[32m"listitem"[39m
          [36m>[39m
            [36m<a[39m
              [33maria-label[39m=[32m"利用者マスタへ移動"[39m
              [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
              [33mhref[39m=[32m"/users"[39m
              [33mtabindex[39m=[32m"0"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
                [36m>[39m
                  [36m<div[39m
                    [33maria-hidden[39m=[32m"true"[39m
                    [33mclass[39m=[32m"tile-icon MuiBox-root css-11ig4tz"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
                      [33mdata-testid[39m=[32m"PeopleAltRoundedIcon"[39m
                      [33mfocusable[39m=[32m"false"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h3c.55 0 1-.45 1-1v-2c0-2.18-3.57-3.47-6.33-3.87"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"9"[39m
                        [33mcy[39m=[32m"8"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                        [33mr[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24m-6 1c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
                  [36m>[39m
                    [36m<h2[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者マスタ[0m
                    [36m</h2>[39m
                    [36m<p[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者情報を閲覧・管理[0m
                    [36m</p>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-kdc3n8-MuiStack-root"[39m
                [36m>[39m
                  [36m<p[39m
                    [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-vi8kcg-MuiTypography-root"[39m
                  [36m>[39m
                    [0m詳細を開く[0m
                  [36m</p>[39m
     ...

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx > Home > shows schedule tiles and chips when flag enabled
AssertionError: expected [ <a …(4)>…(3)</a>, …(10) ] to have a length of 6 but got 11

- Expected
+ Received

- 6
+ 11

 ❯ tests/unit/Home.spec.tsx:60:19
     58|     renderHome();
     59|     const links = screen.getAllByRole('link', { name: /へ移動$/ });
     60|     expect(links).toHaveLength(6);
       |                   ^
     61|     expect(screen.getByRole('link', { name: 'マスタースケジュールへ移…
     62|     expect(screen.getByTestId('home-data-source-chip')).toHaveTextCont…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯

 FAIL  tests/unit/Home.spec.tsx > Home > indicates when demo mode is active
TestingLibraryElementError: Found multiple elements by: [data-testid="home-data-source-chip"]

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<div[39m
  [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeSmall MuiChip-colorInfo MuiChip-outlinedInfo css-91znoi-MuiChip-root"[39m
  [33mdata-testid[39m=[32m"home-data-source-chip"[39m
[36m>[39m
  [36m<span[39m
    [33mclass[39m=[32m"MuiChip-label MuiChip-labelSmall css-19m61dl-MuiChip-label"[39m
  [36m>[39m
    [0mデータソース: Demo[0m
  [36m</span>[39m
[36m</div>[39m

Ignored nodes: comments, script, style
[36m<div[39m
  [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeSmall MuiChip-colorInfo MuiChip-outlinedInfo css-91znoi-MuiChip-root"[39m
  [33mdata-testid[39m=[32m"home-data-source-chip"[39m
[36m>[39m
  [36m<span[39m
    [33mclass[39m=[32m"MuiChip-label MuiChip-labelSmall css-19m61dl-MuiChip-label"[39m
  [36m>[39m
    [0mデータソース: Demo[0m
  [36m</span>[39m
[36m</div>[39m

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<main[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-1h3ocin-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-8mcjw0-MuiStack-root"[39m
      [36m>[39m
        [36m<section[39m
          [33mclass[39m=[32m"MuiStack-root css-1sazv7p-MuiStack-root"[39m
        [36m>[39m
          [36m<div>[39m
            [36m<h1[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-ppzics-MuiTypography-root"[39m
            [36m>[39m
              [0mAudit Management MVP[0m
            [36m</h1>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body1 css-k16oju-MuiTypography-root"[39m
            [36m>[39m
              [0mSharePoint 接続や MSAL 認証を待たずに、利用者マスタと日次記録フローをすぐに体験できます。[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-rsvakl-MuiStack-root"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeMedium MuiChip-colorWarning MuiChip-outlinedWarning css-px44bf-MuiChip-root"[39m
              [33mdata-testid[39m=[32m"home-mode-chip"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall MuiChip-icon MuiChip-iconMedium MuiChip-iconColorWarning css-120dh41-MuiSvgIcon-root"[39m
                [33mdata-testid[39m=[32m"FiberManualRecordRoundedIcon"[39m
                [33mfocusable[39m=[32m"false"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
              [36m>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"12"[39m
                  [33mr[39m=[32m"8"[39m
                [36m/>[39m
              [36m</svg>[39m
              [36m<span[39m
                [33mclass[39m=[32m"MuiChip-label MuiChip-labelMedium css-16cgrcw-MuiChip-label"[39m
              [36m>[39m
                [0m本番モード（MSAL 認証あり）[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [36m<code[39m
                [33mclass[39m=[32m"MuiBox-root css-42drcr"[39m
              [36m>[39m
                [0mVITE_DEMO_MODE=1[0m
              [36m</code>[39m
              [0m [0m
              [0mに切り替えるとサンプルデータで試せます。[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</section>[39m
        [36m<section[39m
          [33maria-label[39m=[32m"主要機能のタイル一覧"[39m
          [33mclass[39m=[32m"MuiBox-root css-2o31b7"[39m
          [33mrole[39m=[32m"list"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-sarrn7-MuiPaper-root-MuiCard-root"[39m
            [33mdata-testid[39m=[32m"home-tile-users"[39m
            [33mrole[39m=[32m"listitem"[39m
          [36m>[39m
            [36m<a[39m
              [33maria-label[39m=[32m"利用者マスタへ移動"[39m
              [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
              [33mhref[39m=[32m"/users"[39m
              [33mtabindex[39m=[32m"0"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
                [36m>[39m
                  [36m<div[39m
                    [33maria-hidden[39m=[32m"true"[39m
                    [33mclass[39m=[32m"tile-icon MuiBox-root css-11ig4tz"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
                      [33mdata-testid[39m=[32m"PeopleAltRoundedIcon"[39m
                      [33mfocusable[39m=[32m"false"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h3c.55 0 1-.45 1-1v-2c0-2.18-3.57-3.47-6.33-3.87"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"9"[39m
                        [33mcy[39m=[32m"8"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                        [33mr[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24m-6 1c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
                  [36m>[39m
                    [36m<h2[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者マスタ[0m
                    [36m</h2>[39m
                    [36m<p[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者情報を閲覧・管理[0m
                    [36m</p>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-kdc3n8-MuiStack-root"[39m
                [36m>[39m
                  [36m<p[39m
                    [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-vi8kcg-MuiTypography-root"[39m
                  [36m>[39m
                    [0m詳細を開く[0m
                  [36m</p>[39m
     ...
 ❯ Object.getElementError node_modules/@testing-library/dom/dist/config.js:37:19
 ❯ getElementError node_modules/@testing-library/dom/dist/query-helpers.js:20:35
 ❯ getMultipleElementsFoundError node_modules/@testing-library/dom/dist/query-helpers.js:23:10
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:55:13
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:95:19
 ❯ tests/unit/Home.spec.tsx:70:19
     68|     renderHome();
     69|     expect(screen.getByText('デモモードが有効です')).toBeVisible();
     70|     expect(screen.getByTestId('home-data-source-chip')).toHaveTextCont…
       |                   ^
     71|   });
     72| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯

⎯⎯⎯⎯⎯⎯ Unhandled Errors ⎯⎯⎯⎯⎯⎯

Vitest caught 1 unhandled error during the test run.
This might cause false positive tests. Resolve unhandled errors to make sure your tests are not affected.

⎯⎯⎯⎯⎯ Uncaught Exception ⎯⎯⎯⎯⎯
Error: Rendered more hooks than during the previous render.
 ❯ updateWorkInProgressHook node_modules/react-dom/cjs/react-dom.development.js:15688:13
 ❯ updateMemo node_modules/react-dom/cjs/react-dom.development.js:16412:14
 ❯ Object.useMemo node_modules/react-dom/cjs/react-dom.development.js:17067:16
 ❯ Object.useMemo node_modules/react/cjs/react.development.js:1650:21
 ❯ src/app/Home.tsx:230:35
    228|         >
    229|           {activeTiles.map(({ to, label, caption, Icon, tone, ariaLabe…
    230|             const palette = React.useMemo(() => toneStyles(tone, theme…
       |                                   ^
    231|             return (
    232|               <Card
 ❯ Home src/app/Home.tsx:229:24
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ updateFunctionComponent node_modules/react-dom/cjs/react-dom.development.js:19617:20
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21640:16

This error originated in "tests/unit/Home.spec.tsx" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "tests/unit/Home.spec.tsx". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- If the error occurred after the test had been completed, this was the last documented test before it was thrown.
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 Test Files  1 failed (1)
      Tests  2 failed | 1 passed (3)
     Errors  1 error
   Start at  14:18:33
   Duration  355ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/Home.tsx x13 

stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/Home.spec.tsx (3 tests | 2 failed) 161ms
   × Home > shows schedule tiles and chips when flag enabled 43ms
     → expected [ <a …(4)>…(3)</a>, …(10) ] to have a length of 6 but got 11
   × Home > indicates when demo mode is active 30ms
     → Found multiple elements by: [data-testid="home-data-source-chip"]

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<div[39m
  [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeSmall MuiChip-colorInfo MuiChip-outlinedInfo css-91znoi-MuiChip-root"[39m
  [33mdata-testid[39m=[32m"home-data-source-chip"[39m
[36m>[39m
  [36m<span[39m
    [33mclass[39m=[32m"MuiChip-label MuiChip-labelSmall css-19m61dl-MuiChip-label"[39m
  [36m>[39m
    [0mデータソース: Demo[0m
  [36m</span>[39m
[36m</div>[39m

Ignored nodes: comments, script, style
[36m<div[39m
  [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeSmall MuiChip-colorInfo MuiChip-outlinedInfo css-91znoi-MuiChip-root"[39m
  [33mdata-testid[39m=[32m"home-data-source-chip"[39m
[36m>[39m
  [36m<span[39m
    [33mclass[39m=[32m"MuiChip-label MuiChip-labelSmall css-19m61dl-MuiChip-label"[39m
  [36m>[39m
    [0mデータソース: Demo[0m
  [36m</span>[39m
[36m</div>[39m

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<main[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-1h3ocin-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-8mcjw0-MuiStack-root"[39m
      [36m>[39m
        [36m<section[39m
          [33mclass[39m=[32m"MuiStack-root css-1sazv7p-MuiStack-root"[39m
        [36m>[39m
          [36m<div>[39m
            [36m<h1[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-ppzics-MuiTypography-root"[39m
            [36m>[39m
              [0mAudit Management MVP[0m
            [36m</h1>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body1 css-k16oju-MuiTypography-root"[39m
            [36m>[39m
              [0mSharePoint 接続や MSAL 認証を待たずに、利用者マスタと日次記録フローをすぐに体験できます。[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-rsvakl-MuiStack-root"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeMedium MuiChip-colorWarning MuiChip-outlinedWarning css-px44bf-MuiChip-root"[39m
              [33mdata-testid[39m=[32m"home-mode-chip"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall MuiChip-icon MuiChip-iconMedium MuiChip-iconColorWarning css-120dh41-MuiSvgIcon-root"[39m
                [33mdata-testid[39m=[32m"FiberManualRecordRoundedIcon"[39m
                [33mfocusable[39m=[32m"false"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
              [36m>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"12"[39m
                  [33mr[39m=[32m"8"[39m
                [36m/>[39m
              [36m</svg>[39m
              [36m<span[39m
                [33mclass[39m=[32m"MuiChip-label MuiChip-labelMedium css-16cgrcw-MuiChip-label"[39m
              [36m>[39m
                [0m本番モード（MSAL 認証あり）[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [36m<code[39m
                [33mclass[39m=[32m"MuiBox-root css-42drcr"[39m
              [36m>[39m
                [0mVITE_DEMO_MODE=1[0m
              [36m</code>[39m
              [0m [0m
              [0mに切り替えるとサンプルデータで試せます。[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</section>[39m
        [36m<section[39m
          [33maria-label[39m=[32m"主要機能のタイル一覧"[39m
          [33mclass[39m=[32m"MuiBox-root css-2o31b7"[39m
          [33mrole[39m=[32m"list"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-sarrn7-MuiPaper-root-MuiCard-root"[39m
            [33mdata-testid[39m=[32m"home-tile-users"[39m
            [33mrole[39m=[32m"listitem"[39m
          [36m>[39m
            [36m<a[39m
              [33maria-label[39m=[32m"利用者マスタへ移動"[39m
              [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
              [33mhref[39m=[32m"/users"[39m
              [33mtabindex[39m=[32m"0"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
                [36m>[39m
                  [36m<div[39m
                    [33maria-hidden[39m=[32m"true"[39m
                    [33mclass[39m=[32m"tile-icon MuiBox-root css-11ig4tz"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
                      [33mdata-testid[39m=[32m"PeopleAltRoundedIcon"[39m
                      [33mfocusable[39m=[32m"false"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h3c.55 0 1-.45 1-1v-2c0-2.18-3.57-3.47-6.33-3.87"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"9"[39m
                        [33mcy[39m=[32m"8"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                        [33mr[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24m-6 1c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
                  [36m>[39m
                    [36m<h2[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者マスタ[0m
                    [36m</h2>[39m
                    [36m<p[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者情報を閲覧・管理[0m
                    [36m</p>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-kdc3n8-MuiStack-root"[39m
                [36m>[39m
                  [36m<p[39m
                    [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-vi8kcg-MuiTypography-root"[39m
                  [36m>[39m
                    [0m詳細を開く[0m
                  [36m</p>[39m
     ...

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx > Home > shows schedule tiles and chips when flag enabled
AssertionError: expected [ <a …(4)>…(3)</a>, …(10) ] to have a length of 6 but got 11

- Expected
+ Received

- 6
+ 11

 ❯ tests/unit/Home.spec.tsx:60:19
     58|     renderHome();
     59|     const links = screen.getAllByRole('link', { name: /へ移動$/ });
     60|     expect(links).toHaveLength(6);
       |                   ^
     61|     expect(screen.getByRole('link', { name: 'マスタースケジュールへ移…
     62|     expect(screen.getByTestId('home-data-source-chip')).toHaveTextCont…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯

 FAIL  tests/unit/Home.spec.tsx > Home > indicates when demo mode is active
TestingLibraryElementError: Found multiple elements by: [data-testid="home-data-source-chip"]

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<div[39m
  [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeSmall MuiChip-colorInfo MuiChip-outlinedInfo css-91znoi-MuiChip-root"[39m
  [33mdata-testid[39m=[32m"home-data-source-chip"[39m
[36m>[39m
  [36m<span[39m
    [33mclass[39m=[32m"MuiChip-label MuiChip-labelSmall css-19m61dl-MuiChip-label"[39m
  [36m>[39m
    [0mデータソース: Demo[0m
  [36m</span>[39m
[36m</div>[39m

Ignored nodes: comments, script, style
[36m<div[39m
  [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeSmall MuiChip-colorInfo MuiChip-outlinedInfo css-91znoi-MuiChip-root"[39m
  [33mdata-testid[39m=[32m"home-data-source-chip"[39m
[36m>[39m
  [36m<span[39m
    [33mclass[39m=[32m"MuiChip-label MuiChip-labelSmall css-19m61dl-MuiChip-label"[39m
  [36m>[39m
    [0mデータソース: Demo[0m
  [36m</span>[39m
[36m</div>[39m

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<main[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-1h3ocin-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-8mcjw0-MuiStack-root"[39m
      [36m>[39m
        [36m<section[39m
          [33mclass[39m=[32m"MuiStack-root css-1sazv7p-MuiStack-root"[39m
        [36m>[39m
          [36m<div>[39m
            [36m<h1[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-ppzics-MuiTypography-root"[39m
            [36m>[39m
              [0mAudit Management MVP[0m
            [36m</h1>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body1 css-k16oju-MuiTypography-root"[39m
            [36m>[39m
              [0mSharePoint 接続や MSAL 認証を待たずに、利用者マスタと日次記録フローをすぐに体験できます。[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-rsvakl-MuiStack-root"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeMedium MuiChip-colorWarning MuiChip-outlinedWarning css-px44bf-MuiChip-root"[39m
              [33mdata-testid[39m=[32m"home-mode-chip"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall MuiChip-icon MuiChip-iconMedium MuiChip-iconColorWarning css-120dh41-MuiSvgIcon-root"[39m
                [33mdata-testid[39m=[32m"FiberManualRecordRoundedIcon"[39m
                [33mfocusable[39m=[32m"false"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
              [36m>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"12"[39m
                  [33mr[39m=[32m"8"[39m
                [36m/>[39m
              [36m</svg>[39m
              [36m<span[39m
                [33mclass[39m=[32m"MuiChip-label MuiChip-labelMedium css-16cgrcw-MuiChip-label"[39m
              [36m>[39m
                [0m本番モード（MSAL 認証あり）[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [36m<code[39m
                [33mclass[39m=[32m"MuiBox-root css-42drcr"[39m
              [36m>[39m
                [0mVITE_DEMO_MODE=1[0m
              [36m</code>[39m
              [0m [0m
              [0mに切り替えるとサンプルデータで試せます。[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</section>[39m
        [36m<section[39m
          [33maria-label[39m=[32m"主要機能のタイル一覧"[39m
          [33mclass[39m=[32m"MuiBox-root css-2o31b7"[39m
          [33mrole[39m=[32m"list"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-sarrn7-MuiPaper-root-MuiCard-root"[39m
            [33mdata-testid[39m=[32m"home-tile-users"[39m
            [33mrole[39m=[32m"listitem"[39m
          [36m>[39m
            [36m<a[39m
              [33maria-label[39m=[32m"利用者マスタへ移動"[39m
              [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
              [33mhref[39m=[32m"/users"[39m
              [33mtabindex[39m=[32m"0"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
                [36m>[39m
                  [36m<div[39m
                    [33maria-hidden[39m=[32m"true"[39m
                    [33mclass[39m=[32m"tile-icon MuiBox-root css-11ig4tz"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
                      [33mdata-testid[39m=[32m"PeopleAltRoundedIcon"[39m
                      [33mfocusable[39m=[32m"false"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h3c.55 0 1-.45 1-1v-2c0-2.18-3.57-3.47-6.33-3.87"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"9"[39m
                        [33mcy[39m=[32m"8"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                        [33mr[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24m-6 1c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
                  [36m>[39m
                    [36m<h2[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者マスタ[0m
                    [36m</h2>[39m
                    [36m<p[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者情報を閲覧・管理[0m
                    [36m</p>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-kdc3n8-MuiStack-root"[39m
                [36m>[39m
                  [36m<p[39m
                    [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-vi8kcg-MuiTypography-root"[39m
                  [36m>[39m
                    [0m詳細を開く[0m
                  [36m</p>[39m
     ...
 ❯ Object.getElementError node_modules/@testing-library/dom/dist/config.js:37:19
 ❯ getElementError node_modules/@testing-library/dom/dist/query-helpers.js:20:35
 ❯ getMultipleElementsFoundError node_modules/@testing-library/dom/dist/query-helpers.js:23:10
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:55:13
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:95:19
 ❯ tests/unit/Home.spec.tsx:70:19
     68|     renderHome();
     69|     expect(screen.getByText('デモモードが有効です')).toBeVisible();
     70|     expect(screen.getByTestId('home-data-source-chip')).toHaveTextCont…
       |                   ^
     71|   });
     72| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯

 Test Files  1 failed (1)
      Tests  2 failed | 1 passed (3)
   Start at  14:18:50
   Duration  368ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/Home.spec.tsx x14 

stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/Home.spec.tsx (3 tests | 1 failed) 146ms
   × Home > shows schedule tiles and chips when flag enabled 43ms
     → Found multiple elements with the role "list" and name "主要機能のタイル一覧"

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<section[39m
  [33maria-label[39m=[32m"主要機能のタイル一覧"[39m
  [33mclass[39m=[32m"MuiBox-root css-2o31b7"[39m
  [33mrole[39m=[32m"list"[39m
[36m>[39m
  [36m<div[39m
    [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-sarrn7-MuiPaper-root-MuiCard-root"[39m
    [33mdata-testid[39m=[32m"home-tile-users"[39m
    [33mrole[39m=[32m"listitem"[39m
  [36m>[39m
    [36m<a[39m
      [33maria-label[39m=[32m"利用者マスタへ移動"[39m
      [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
      [33mhref[39m=[32m"/users"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
        [36m>[39m
          [36m<div[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"tile-icon MuiBox-root css-11ig4tz"[39m
          [36m>[39m
            [36m<svg[39m
              [33maria-hidden[39m=[32m"true"[39m
              [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
              [33mdata-testid[39m=[32m"PeopleAltRoundedIcon"[39m
              [33mfocusable[39m=[32m"false"[39m
              [33mviewBox[39m=[32m"0 0 24 24"[39m
            [36m>[39m
              [36m<path[39m
                [33md[39m=[32m"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h3c.55 0 1-.45 1-1v-2c0-2.18-3.57-3.47-6.33-3.87"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
              [36m/>[39m
              [36m<circle[39m
                [33mcx[39m=[32m"9"[39m
                [33mcy[39m=[32m"8"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
                [33mr[39m=[32m"4"[39m
              [36m/>[39m
              [36m<path[39m
                [33md[39m=[32m"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24m-6 1c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
              [36m/>[39m
            [36m</svg>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
          [36m>[39m
            [36m<h2[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
            [36m>[39m
              [0m利用者マスタ[0m
            [36m</h2>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [0m利用者情報を閲覧・管理[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-kdc3n8-MuiStack-root"[39m
        [36m>[39m
          [36m<p[39m
            [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-vi8kcg-MuiTypography-root"[39m
          [36m>[39m
            [0m詳細を開く[0m
          [36m</p>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-colorPrimary MuiSvgIcon-fontSizeSmall css-os5i4q-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"ArrowForwardRoundedIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42s1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<span[39m
        [33mclass[39m=[32m"MuiCardActionArea-focusHighlight css-1h5un5t-MuiCardActionArea-focusHighlight"[39m
      [36m/>[39m
    [36m</a>[39m
  [36m</div>[39m
  [36m<div[39m
    [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-xdz57k-MuiPaper-root-MuiCard-root"[39m
    [33mdata-testid[39m=[32m"home-tile-dashboard"[39m
    [33mrole[39m=[32m"listitem"[39m
  [36m>[39m
    [36m<a[39m
      [33maria-label[39m=[32m"オペレーションハブへ移動"[39m
      [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
      [33mhref[39m=[32m"/dashboard"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
        [36m>[39m
          [36m<div[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"tile-icon MuiBox-root css-1cdavp5"[39m
          [36m>[39m
            [36m<svg[39m
              [33maria-hidden[39m=[32m"true"[39m
              [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
              [33mdata-testid[39m=[32m"SpaceDashboardRoundedIcon"[39m
              [33mfocusable[39m=[32m"false"[39m
              [33mviewBox[39m=[32m"0 0 24 24"[39m
            [36m>[39m
              [36m<path[39m
                [33md[39m=[32m"M9 21H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2v14c0 1.1-.9 2-2 2m6 0h4c1.1 0 2-.9 2-2v-5c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v5c0 1.1.9 2 2 2m6-13V5c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2h4c1.1 0 2-.9 2-2"[39m
              [36m/>[39m
            [36m</svg>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
          [36m>[39m
            [36m<h2[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
            [36m>[39m
              [0mオペレーションハブ[0m
            [36m</h2>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [0m施設全体の運営状況を俯瞰[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[...

Ignored nodes: comments, script, style
[36m<section[39m
  [33maria-label[39m=[32m"主要機能のタイル一覧"[39m
  [33mclass[39m=[32m"MuiBox-root css-2o31b7"[39m
  [33mrole[39m=[32m"list"[39m
[36m>[39m
  [36m<div[39m
    [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-sarrn7-MuiPaper-root-MuiCard-root"[39m
    [33mdata-testid[39m=[32m"home-tile-users"[39m
    [33mrole[39m=[32m"listitem"[39m
  [36m>[39m
    [36m<a[39m
      [33maria-label[39m=[32m"利用者マスタへ移動"[39m
      [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
      [33mhref[39m=[32m"/users"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
        [36m>[39m
          [36m<div[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"tile-icon MuiBox-root css-11ig4tz"[39m
          [36m>[39m
            [36m<svg[39m
              [33maria-hidden[39m=[32m"true"[39m
              [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
              [33mdata-testid[39m=[32m"PeopleAltRoundedIcon"[39m
              [33mfocusable[39m=[32m"false"[39m
              [33mviewBox[39m=[32m"0 0 24 24"[39m
            [36m>[39m
              [36m<path[39m
                [33md[39m=[32m"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h3c.55 0 1-.45 1-1v-2c0-2.18-3.57-3.47-6.33-3.87"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
              [36m/>[39m
              [36m<circle[39m
                [33mcx[39m=[32m"9"[39m
                [33mcy[39m=[32m"8"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
                [33mr[39m=[32m"4"[39m
              [36m/>[39m
              [36m<path[39m
                [33md[39m=[32m"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24m-6 1c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
              [36m/>[39m
            [36m</svg>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
          [36m>[39m
            [36m<h2[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
            [36m>[39m
              [0m利用者マスタ[0m
            [36m</h2>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [0m利用者情報を閲覧・管理[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-kdc3n8-MuiStack-root"[39m
        [36m>[39m
          [36m<p[39m
            [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-vi8kcg-MuiTypography-root"[39m
          [36m>[39m
            [0m詳細を開く[0m
          [36m</p>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-colorPrimary MuiSvgIcon-fontSizeSmall css-os5i4q-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"ArrowForwardRoundedIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42s1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<span[39m
        [33mclass[39m=[32m"MuiCardActionArea-focusHighlight css-1h5un5t-MuiCardActionArea-focusHighlight"[39m
      [36m/>[39m
    [36m</a>[39m
  [36m</div>[39m
  [36m<div[39m
    [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-xdz57k-MuiPaper-root-MuiCard-root"[39m
    [33mdata-testid[39m=[32m"home-tile-dashboard"[39m
    [33mrole[39m=[32m"listitem"[39m
  [36m>[39m
    [36m<a[39m
      [33maria-label[39m=[32m"オペレーションハブへ移動"[39m
      [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
      [33mhref[39m=[32m"/dashboard"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
        [36m>[39m
          [36m<div[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"tile-icon MuiBox-root css-1cdavp5"[39m
          [36m>[39m
            [36m<svg[39m
              [33maria-hidden[39m=[32m"true"[39m
              [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
              [33mdata-testid[39m=[32m"SpaceDashboardRoundedIcon"[39m
              [33mfocusable[39m=[32m"false"[39m
              [33mviewBox[39m=[32m"0 0 24 24"[39m
            [36m>[39m
              [36m<path[39m
                [33md[39m=[32m"M9 21H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2v14c0 1.1-.9 2-2 2m6 0h4c1.1 0 2-.9 2-2v-5c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v5c0 1.1.9 2 2 2m6-13V5c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2h4c1.1 0 2-.9 2-2"[39m
              [36m/>[39m
            [36m</svg>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
          [36m>[39m
            [36m<h2[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
            [36m>[39m
              [0mオペレーションハブ[0m
            [36m</h2>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [0m施設全体の運営状況を俯瞰[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[...

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<main[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-1h3ocin-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-8mcjw0-MuiStack-root"[39m
      [36m>[39m
        [36m<section[39m
          [33mclass[39m=[32m"MuiStack-root css-1sazv7p-MuiStack-root"[39m
        [36m>[39m
          [36m<div>[39m
            [36m<h1[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-ppzics-MuiTypography-root"[39m
            [36m>[39m
              [0mAudit Management MVP[0m
            [36m</h1>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body1 css-k16oju-MuiTypography-root"[39m
            [36m>[39m
              [0mSharePoint 接続や MSAL 認証を待たずに、利用者マスタと日次記録フローをすぐに体験できます。[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-rsvakl-MuiStack-root"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeMedium MuiChip-colorWarning MuiChip-outlinedWarning css-px44bf-MuiChip-root"[39m
              [33mdata-testid[39m=[32m"home-mode-chip"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall MuiChip-icon MuiChip-iconMedium MuiChip-iconColorWarning css-120dh41-MuiSvgIcon-root"[39m
                [33mdata-testid[39m=[32m"FiberManualRecordRoundedIcon"[39m
                [33mfocusable[39m=[32m"false"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
              [36m>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"12"[39m
                  [33mr[39m=[32m"8"[39m
                [36m/>[39m
              [36m</svg>[39m
              [36m<span[39m
                [33mclass[39m=[32m"MuiChip-label MuiChip-labelMedium css-16cgrcw-MuiChip-label"[39m
              [36m>[39m
                [0m本番モード（MSAL 認証あり）[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [36m<code[39m
                [33mclass[39m=[32m"MuiBox-root css-42drcr"[39m
              [36m>[39m
                [0mVITE_DEMO_MODE=1[0m
              [36m</code>[39m
              [0m [0m
              [0mに切り替えるとサンプルデータで試せます。[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</section>[39m
        [36m<section[39m
          [33maria-label[39m=[32m"主要機能のタイル一覧"[39m
          [33mclass[39m=[32m"MuiBox-root css-2o31b7"[39m
          [33mrole[39m=[32m"list"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-sarrn7-MuiPaper-root-MuiCard-root"[39m
            [33mdata-testid[39m=[32m"home-tile-users"[39m
            [33mrole[39m=[32m"listitem"[39m
          [36m>[39m
            [36m<a[39m
              [33maria-label[39m=[32m"利用者マスタへ移動"[39m
              [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
              [33mhref[39m=[32m"/users"[39m
              [33mtabindex[39m=[32m"0"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
                [36m>[39m
                  [36m<div[39m
                    [33maria-hidden[39m=[32m"true"[39m
                    [33mclass[39m=[32m"tile-icon MuiBox-root css-11ig4tz"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
                      [33mdata-testid[39m=[32m"PeopleAltRoundedIcon"[39m
                      [33mfocusable[39m=[32m"false"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h3c.55 0 1-.45 1-1v-2c0-2.18-3.57-3.47-6.33-3.87"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"9"[39m
                        [33mcy[39m=[32m"8"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                        [33mr[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24m-6 1c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
                  [36m>[39m
                    [36m<h2[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者マスタ[0m
                    [36m</h2>[39m
                    [36m<p[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者情報を閲覧・管理[0m
                    [36m</p>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-kdc3n8-MuiStack-root"[39m
                [36m>[39m
                  [36m<p[39m
                    [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-vi8kcg-MuiTypography-root"[39m
                  [36m>[39m
                    [0m詳細を開く[0m
                  [36m</p>[39m
     ...

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx > Home > shows schedule tiles and chips when flag enabled
TestingLibraryElementError: Found multiple elements with the role "list" and name "主要機能のタイル一覧"

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<section[39m
  [33maria-label[39m=[32m"主要機能のタイル一覧"[39m
  [33mclass[39m=[32m"MuiBox-root css-2o31b7"[39m
  [33mrole[39m=[32m"list"[39m
[36m>[39m
  [36m<div[39m
    [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-sarrn7-MuiPaper-root-MuiCard-root"[39m
    [33mdata-testid[39m=[32m"home-tile-users"[39m
    [33mrole[39m=[32m"listitem"[39m
  [36m>[39m
    [36m<a[39m
      [33maria-label[39m=[32m"利用者マスタへ移動"[39m
      [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
      [33mhref[39m=[32m"/users"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
        [36m>[39m
          [36m<div[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"tile-icon MuiBox-root css-11ig4tz"[39m
          [36m>[39m
            [36m<svg[39m
              [33maria-hidden[39m=[32m"true"[39m
              [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
              [33mdata-testid[39m=[32m"PeopleAltRoundedIcon"[39m
              [33mfocusable[39m=[32m"false"[39m
              [33mviewBox[39m=[32m"0 0 24 24"[39m
            [36m>[39m
              [36m<path[39m
                [33md[39m=[32m"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h3c.55 0 1-.45 1-1v-2c0-2.18-3.57-3.47-6.33-3.87"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
              [36m/>[39m
              [36m<circle[39m
                [33mcx[39m=[32m"9"[39m
                [33mcy[39m=[32m"8"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
                [33mr[39m=[32m"4"[39m
              [36m/>[39m
              [36m<path[39m
                [33md[39m=[32m"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24m-6 1c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
              [36m/>[39m
            [36m</svg>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
          [36m>[39m
            [36m<h2[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
            [36m>[39m
              [0m利用者マスタ[0m
            [36m</h2>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [0m利用者情報を閲覧・管理[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-kdc3n8-MuiStack-root"[39m
        [36m>[39m
          [36m<p[39m
            [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-vi8kcg-MuiTypography-root"[39m
          [36m>[39m
            [0m詳細を開く[0m
          [36m</p>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-colorPrimary MuiSvgIcon-fontSizeSmall css-os5i4q-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"ArrowForwardRoundedIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42s1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<span[39m
        [33mclass[39m=[32m"MuiCardActionArea-focusHighlight css-1h5un5t-MuiCardActionArea-focusHighlight"[39m
      [36m/>[39m
    [36m</a>[39m
  [36m</div>[39m
  [36m<div[39m
    [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-xdz57k-MuiPaper-root-MuiCard-root"[39m
    [33mdata-testid[39m=[32m"home-tile-dashboard"[39m
    [33mrole[39m=[32m"listitem"[39m
  [36m>[39m
    [36m<a[39m
      [33maria-label[39m=[32m"オペレーションハブへ移動"[39m
      [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
      [33mhref[39m=[32m"/dashboard"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
        [36m>[39m
          [36m<div[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"tile-icon MuiBox-root css-1cdavp5"[39m
          [36m>[39m
            [36m<svg[39m
              [33maria-hidden[39m=[32m"true"[39m
              [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
              [33mdata-testid[39m=[32m"SpaceDashboardRoundedIcon"[39m
              [33mfocusable[39m=[32m"false"[39m
              [33mviewBox[39m=[32m"0 0 24 24"[39m
            [36m>[39m
              [36m<path[39m
                [33md[39m=[32m"M9 21H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2v14c0 1.1-.9 2-2 2m6 0h4c1.1 0 2-.9 2-2v-5c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v5c0 1.1.9 2 2 2m6-13V5c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2h4c1.1 0 2-.9 2-2"[39m
              [36m/>[39m
            [36m</svg>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
          [36m>[39m
            [36m<h2[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
            [36m>[39m
              [0mオペレーションハブ[0m
            [36m</h2>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [0m施設全体の運営状況を俯瞰[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[...

Ignored nodes: comments, script, style
[36m<section[39m
  [33maria-label[39m=[32m"主要機能のタイル一覧"[39m
  [33mclass[39m=[32m"MuiBox-root css-2o31b7"[39m
  [33mrole[39m=[32m"list"[39m
[36m>[39m
  [36m<div[39m
    [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-sarrn7-MuiPaper-root-MuiCard-root"[39m
    [33mdata-testid[39m=[32m"home-tile-users"[39m
    [33mrole[39m=[32m"listitem"[39m
  [36m>[39m
    [36m<a[39m
      [33maria-label[39m=[32m"利用者マスタへ移動"[39m
      [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
      [33mhref[39m=[32m"/users"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
        [36m>[39m
          [36m<div[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"tile-icon MuiBox-root css-11ig4tz"[39m
          [36m>[39m
            [36m<svg[39m
              [33maria-hidden[39m=[32m"true"[39m
              [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
              [33mdata-testid[39m=[32m"PeopleAltRoundedIcon"[39m
              [33mfocusable[39m=[32m"false"[39m
              [33mviewBox[39m=[32m"0 0 24 24"[39m
            [36m>[39m
              [36m<path[39m
                [33md[39m=[32m"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h3c.55 0 1-.45 1-1v-2c0-2.18-3.57-3.47-6.33-3.87"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
              [36m/>[39m
              [36m<circle[39m
                [33mcx[39m=[32m"9"[39m
                [33mcy[39m=[32m"8"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
                [33mr[39m=[32m"4"[39m
              [36m/>[39m
              [36m<path[39m
                [33md[39m=[32m"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24m-6 1c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4"[39m
                [33mfill-rule[39m=[32m"evenodd"[39m
              [36m/>[39m
            [36m</svg>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
          [36m>[39m
            [36m<h2[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
            [36m>[39m
              [0m利用者マスタ[0m
            [36m</h2>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [0m利用者情報を閲覧・管理[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-kdc3n8-MuiStack-root"[39m
        [36m>[39m
          [36m<p[39m
            [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-vi8kcg-MuiTypography-root"[39m
          [36m>[39m
            [0m詳細を開く[0m
          [36m</p>[39m
          [36m<svg[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-colorPrimary MuiSvgIcon-fontSizeSmall css-os5i4q-MuiSvgIcon-root"[39m
            [33mdata-testid[39m=[32m"ArrowForwardRoundedIcon"[39m
            [33mfocusable[39m=[32m"false"[39m
            [33mviewBox[39m=[32m"0 0 24 24"[39m
          [36m>[39m
            [36m<path[39m
              [33md[39m=[32m"M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42s1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1"[39m
            [36m/>[39m
          [36m</svg>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<span[39m
        [33mclass[39m=[32m"MuiCardActionArea-focusHighlight css-1h5un5t-MuiCardActionArea-focusHighlight"[39m
      [36m/>[39m
    [36m</a>[39m
  [36m</div>[39m
  [36m<div[39m
    [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-xdz57k-MuiPaper-root-MuiCard-root"[39m
    [33mdata-testid[39m=[32m"home-tile-dashboard"[39m
    [33mrole[39m=[32m"listitem"[39m
  [36m>[39m
    [36m<a[39m
      [33maria-label[39m=[32m"オペレーションハブへ移動"[39m
      [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
      [33mhref[39m=[32m"/dashboard"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
        [36m>[39m
          [36m<div[39m
            [33maria-hidden[39m=[32m"true"[39m
            [33mclass[39m=[32m"tile-icon MuiBox-root css-1cdavp5"[39m
          [36m>[39m
            [36m<svg[39m
              [33maria-hidden[39m=[32m"true"[39m
              [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
              [33mdata-testid[39m=[32m"SpaceDashboardRoundedIcon"[39m
              [33mfocusable[39m=[32m"false"[39m
              [33mviewBox[39m=[32m"0 0 24 24"[39m
            [36m>[39m
              [36m<path[39m
                [33md[39m=[32m"M9 21H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2v14c0 1.1-.9 2-2 2m6 0h4c1.1 0 2-.9 2-2v-5c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v5c0 1.1.9 2 2 2m6-13V5c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2h4c1.1 0 2-.9 2-2"[39m
              [36m/>[39m
            [36m</svg>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
          [36m>[39m
            [36m<h2[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
            [36m>[39m
              [0mオペレーションハブ[0m
            [36m</h2>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [0m施設全体の運営状況を俯瞰[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[...

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<main[39m
      [33mclass[39m=[32m"MuiContainer-root MuiContainer-maxWidthLg css-1h3ocin-MuiContainer-root"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"MuiStack-root css-8mcjw0-MuiStack-root"[39m
      [36m>[39m
        [36m<section[39m
          [33mclass[39m=[32m"MuiStack-root css-1sazv7p-MuiStack-root"[39m
        [36m>[39m
          [36m<div>[39m
            [36m<h1[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-ppzics-MuiTypography-root"[39m
            [36m>[39m
              [0mAudit Management MVP[0m
            [36m</h1>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body1 css-k16oju-MuiTypography-root"[39m
            [36m>[39m
              [0mSharePoint 接続や MSAL 認証を待たずに、利用者マスタと日次記録フローをすぐに体験できます。[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiStack-root css-rsvakl-MuiStack-root"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"MuiChip-root MuiChip-outlined MuiChip-sizeMedium MuiChip-colorWarning MuiChip-outlinedWarning css-px44bf-MuiChip-root"[39m
              [33mdata-testid[39m=[32m"home-mode-chip"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall MuiChip-icon MuiChip-iconMedium MuiChip-iconColorWarning css-120dh41-MuiSvgIcon-root"[39m
                [33mdata-testid[39m=[32m"FiberManualRecordRoundedIcon"[39m
                [33mfocusable[39m=[32m"false"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
              [36m>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"12"[39m
                  [33mr[39m=[32m"8"[39m
                [36m/>[39m
              [36m</svg>[39m
              [36m<span[39m
                [33mclass[39m=[32m"MuiChip-label MuiChip-labelMedium css-16cgrcw-MuiChip-label"[39m
              [36m>[39m
                [0m本番モード（MSAL 認証あり）[0m
              [36m</span>[39m
            [36m</div>[39m
            [36m<p[39m
              [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
            [36m>[39m
              [36m<code[39m
                [33mclass[39m=[32m"MuiBox-root css-42drcr"[39m
              [36m>[39m
                [0mVITE_DEMO_MODE=1[0m
              [36m</code>[39m
              [0m [0m
              [0mに切り替えるとサンプルデータで試せます。[0m
            [36m</p>[39m
          [36m</div>[39m
        [36m</section>[39m
        [36m<section[39m
          [33maria-label[39m=[32m"主要機能のタイル一覧"[39m
          [33mclass[39m=[32m"MuiBox-root css-2o31b7"[39m
          [33mrole[39m=[32m"list"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"MuiPaper-root MuiPaper-outlined MuiPaper-rounded MuiCard-root css-sarrn7-MuiPaper-root-MuiCard-root"[39m
            [33mdata-testid[39m=[32m"home-tile-users"[39m
            [33mrole[39m=[32m"listitem"[39m
          [36m>[39m
            [36m<a[39m
              [33maria-label[39m=[32m"利用者マスタへ移動"[39m
              [33mclass[39m=[32m"MuiButtonBase-root MuiCardActionArea-root css-iimtit-MuiButtonBase-root-MuiCardActionArea-root"[39m
              [33mhref[39m=[32m"/users"[39m
              [33mtabindex[39m=[32m"0"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardContent-root css-x4lmbv-MuiCardContent-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-1sos3zc-MuiStack-root"[39m
                [36m>[39m
                  [36m<div[39m
                    [33maria-hidden[39m=[32m"true"[39m
                    [33mclass[39m=[32m"tile-icon MuiBox-root css-11ig4tz"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1umw9bq-MuiSvgIcon-root"[39m
                      [33mdata-testid[39m=[32m"PeopleAltRoundedIcon"[39m
                      [33mfocusable[39m=[32m"false"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h3c.55 0 1-.45 1-1v-2c0-2.18-3.57-3.47-6.33-3.87"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"9"[39m
                        [33mcy[39m=[32m"8"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                        [33mr[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24m-6 1c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4"[39m
                        [33mfill-rule[39m=[32m"evenodd"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"MuiStack-root css-j3ygch-MuiStack-root"[39m
                  [36m>[39m
                    [36m<h2[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-h6 css-fe0fwj-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者マスタ[0m
                    [36m</h2>[39m
                    [36m<p[39m
                      [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-1wle3ir-MuiTypography-root"[39m
                    [36m>[39m
                      [0m利用者情報を閲覧・管理[0m
                    [36m</p>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"MuiCardActions-root MuiCardActions-spacing css-1ecu8l1-MuiCardActions-root"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"MuiStack-root css-kdc3n8-MuiStack-root"[39m
                [36m>[39m
                  [36m<p[39m
                    [33mclass[39m=[32m"MuiTypography-root MuiTypography-body2 css-vi8kcg-MuiTypography-root"[39m
                  [36m>[39m
                    [0m詳細を開く[0m
                  [36m</p>[39m
     ...
 ❯ Object.getElementError node_modules/@testing-library/dom/dist/config.js:37:19
 ❯ getElementError node_modules/@testing-library/dom/dist/query-helpers.js:20:35
 ❯ getMultipleElementsFoundError node_modules/@testing-library/dom/dist/query-helpers.js:23:10
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:55:13
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:95:19
 ❯ tests/unit/Home.spec.tsx:60:29
     58|     featureFlagsMock.schedules = true;
     59|     renderHome();
     60|     const tileList = screen.getByRole('list', { name: '主要機能のタイ…
       |                             ^
     61|     const links = within(tileList).getAllByRole('link', { name: /へ移…
     62|     expect(links).toHaveLength(6);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  1 failed (1)
      Tests  1 failed | 2 passed (3)
   Start at  14:19:20
   Duration  419ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/Home.spec.tsx x15 

stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/Home.spec.tsx (3 tests | 1 failed) 154ms
   × Home > shows schedule tiles and chips when flag enabled 42ms
     → expected [ <a …(4)>…(3)</a>, …(4) ] to have a length of 6 but got 5

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx > Home > shows schedule tiles and chips when flag enabled
AssertionError: expected [ <a …(4)>…(3)</a>, …(4) ] to have a length of 6 but got 5

- Expected
+ Received

- 6
+ 5

 ❯ tests/unit/Home.spec.tsx:62:19
     60|   const tileList = screen.getAllByRole('list', { name: '主要機能のタイ…
     61|     const links = within(tileList).getAllByRole('link', { name: /へ移…
     62|     expect(links).toHaveLength(6);
       |                   ^
     63|     expect(within(tileList).getByRole('link', { name: 'マスタースケジ…
     64|     const chips = screen.getAllByTestId('home-data-source-chip');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  1 failed (1)
      Tests  1 failed | 2 passed (3)
   Start at  14:19:36
   Duration  349ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/Home.spec.tsx x16 

stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/Home.spec.tsx (3 tests | 1 failed) 157ms
   × Home > shows schedule tiles and chips when flag enabled 41ms
     → expected [ <div …(3)>…(1)</div>, …(4) ] to have a length of 6 but got 5

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx > Home > shows schedule tiles and chips when flag enabled
AssertionError: expected [ <div …(3)>…(1)</div>, …(4) ] to have a length of 6 but got 5

- Expected
+ Received

- 6
+ 5

 ❯ tests/unit/Home.spec.tsx:62:17
     60|   const tileList = screen.getAllByRole('list', { name: '主要機能のタイ…
     61|   const items = within(tileList).getAllByRole('listitem');
     62|   expect(items).toHaveLength(6);
       |                 ^
     63|   expect(screen.getByTestId('home-tile-schedule')).toBeVisible();
     64|     const chips = screen.getAllByTestId('home-data-source-chip');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  1 failed (1)
      Tests  1 failed | 2 passed (3)
   Start at  14:20:11
   Duration  448ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/Home.spec.tsx x17 

stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (3 tests) 138ms

 Test Files  1 passed (1)
      Tests  3 passed (3)
   Start at  14:20:34
   Duration  334ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/Home.spec.tsx x18 

stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (3 tests) 135ms

 Test Files  1 passed (1)
      Tests  3 passed (3)
   Start at  14:20:48
   Duration  324ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/config/featureFlags.ts 

 ❯ tests/unit/ui.snapshot.spec.tsx (0 test)
 ❯ tests/unit/App.notifier.spec.tsx (0 test)
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 154ms
stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (3 tests) 186ms
 ❯ tests/unit/config/featureFlags.spec.ts (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 3 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/config/featureFlags.spec.ts [ tests/unit/config/featureFlags.spec.ts ]
 FAIL  tests/unit/App.notifier.spec.tsx [ tests/unit/App.notifier.spec.tsx ]
 FAIL  tests/unit/ui.snapshot.spec.tsx [ tests/unit/ui.snapshot.spec.tsx ]
Error: Transform failed with 1 error:
/Users/yasutakesougo/audit-management-system-mvp/src/config/featureFlags.ts:44:34: ERROR: Expected ">" but found "value"
  Plugin: vite:esbuild
  File: /Users/yasutakesougo/audit-management-system-mvp/src/config/featureFlags.ts:44:34
  
  Expected ">" but found "value"
  42 |  
  43 |    return (
  44 |      <FeatureFlagsContext.Provider value={memoized}>
     |                                    ^
  45 |        {children}
  46 |      </FeatureFlagsContext.Provider>
  
 ❯ failureErrorWithLog node_modules/vitest/node_modules/esbuild/lib/main.js:1472:15
 ❯ node_modules/vitest/node_modules/esbuild/lib/main.js:755:50
 ❯ responseCallbacks.<computed> node_modules/vitest/node_modules/esbuild/lib/main.js:622:9
 ❯ handleIncomingPacket node_modules/vitest/node_modules/esbuild/lib/main.js:677:12
 ❯ Socket.readFromStdout node_modules/vitest/node_modules/esbuild/lib/main.js:600:7

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯

 Test Files  3 failed | 2 passed (5)
      Tests  5 passed (5)
   Start at  14:26:02
   Duration  1.73s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/config/featureFlags.ts 

 ✓ tests/unit/config/featureFlags.spec.ts (3 tests) 2ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 52ms
stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (3 tests) 219ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 16ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 94ms

 Test Files  5 passed (5)
      Tests  10 passed (10)
   Start at  14:26:23
   Duration  2.38s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/App.tsx x13 

 ✓ tests/unit/App.notifier.spec.tsx (1 test) 11ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  14:26:42
   Duration  351ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/AppShell.tsx 

stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
Error: Uncaught [Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at AppShell (/Users/yasutakesougo/audit-management-system-mvp/src/app/AppShell.tsx:79:17)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3) {
  codeFrame: 'vi.mock(import("@/config/featureFlags"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
Error: Uncaught [Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at AppShell (/Users/yasutakesougo/audit-management-system-mvp/src/app/AppShell.tsx:79:17)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3) {
  codeFrame: 'vi.mock(import("@/config/featureFlags"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
The above error occurred in the <AppShell> component:

    at AppShell (/Users/yasutakesougo/audit-management-system-mvp/src/app/AppShell.tsx:86:21)
    at Router (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at MemoryRouter (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1101:7)
    at DefaultPropsProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/DefaultPropsProvider/DefaultPropsProvider.js:9:3)
    at RtlProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/RtlProvider/index.js:8:3)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/private-theming/esm/ThemeProvider/ThemeProvider.js:33:5)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/ThemeProvider/ThemeProvider.js:49:5)
    at ThemeProviderNoVars (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProviderNoVars.js:8:10)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProvider.js:9:3)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
Error: Uncaught [Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at AppShell (/Users/yasutakesougo/audit-management-system-mvp/src/app/AppShell.tsx:79:17)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3) {
  codeFrame: 'vi.mock(import("@/config/featureFlags"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
Error: Uncaught [Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at AppShell (/Users/yasutakesougo/audit-management-system-mvp/src/app/AppShell.tsx:79:17)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3) {
  codeFrame: 'vi.mock(import("@/config/featureFlags"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
The above error occurred in the <AppShell> component:

    at AppShell (/Users/yasutakesougo/audit-management-system-mvp/src/app/AppShell.tsx:86:21)
    at Router (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at MemoryRouter (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1101:7)
    at DefaultPropsProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/DefaultPropsProvider/DefaultPropsProvider.js:9:3)
    at RtlProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/RtlProvider/index.js:8:3)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/private-theming/esm/ThemeProvider/ThemeProvider.js:33:5)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/ThemeProvider/ThemeProvider.js:49:5)
    at ThemeProviderNoVars (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProviderNoVars.js:8:10)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProvider.js:9:3)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 20ms
   × AppShell navigation > marks current route button with aria-current="page" 17ms
     → [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

   × AppShell navigation > leaves status neutral when ping aborts 2ms
     → [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 39ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 18ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 2 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
 FAIL  tests/unit/AppShell.nav.spec.tsx > AppShell navigation > leaves status neutral when ping aborts
Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock(import("@/config/featureFlags"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ AppShell src/app/AppShell.tsx:79:17
     77| const AppShell: React.FC<{ children: React.ReactNode }> = ({ children …
     78|   const location = useLocation();
     79|   const flags = useFeatureFlags();
       |                 ^
     80|   const { mode, toggle } = useContext(ColorModeContext);
     81|   const navItems = useMemo(() => buildNavItems(flags), [flags, locatio…
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯

 Test Files  1 failed | 2 passed (3)
      Tests  2 failed | 2 passed (4)
   Start at  14:27:02
   Duration  1.08s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/router.tsx x15 

 ❯ tests/unit/AppShell.nav.spec.tsx (2 tests | 2 failed) 20ms
   × AppShell navigation > marks current route button with aria-current="page" 17ms
     → [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

   × AppShell navigation > leaves status neutral when ping aborts 2ms
     → [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

 ❯ tests/unit/App.notifier.spec.tsx (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/App.notifier.spec.tsx [ tests/unit/App.notifier.spec.tsx ]
Error: Failed to resolve import "./ProtectedRoute" from "src/app/router.tsx". Does the file exist?
  Plugin: vite:import-analysis
  File: /Users/yasutakesougo/audit-management-system-mvp/src/app/router.tsx:8:27
  7  |  import AuditPanel from "../features/audit/AuditPanel";
  8  |  import { UsersPanel } from "@/features/users";
  9  |  import ProtectedRoute from "./ProtectedRoute";
     |                              ^
  10 |  const WeekPage = React.lazy(() => import("@/features/schedule/WeekPage"));
  11 |  const MonthPage = React.lazy(() => import("@/features/schedule/views/MonthView"));
 ❯ TransformPluginContext._formatError node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49258:41
 ❯ TransformPluginContext.error node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49253:16
 ❯ normalizeUrl node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64306:23
 ❯ node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64438:39
 ❯ TransformPluginContext.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:64365:7
 ❯ PluginContainer.transform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:49099:18
 ❯ loadAndTransform node_modules/vitest/node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51977:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  2 failed (2)
      Tests  2 failed (2)
   Start at  14:28:11
   Duration  136ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/AppShell.nav.spec.tsx x15 

 ❯ tests/unit/App.notifier.spec.tsx (0 test)
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 84ms

 Test Files  1 failed | 1 passed (2)
      Tests  2 passed (2)
   Start at  14:29:18
   Duration  392ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/Home.tsx x21 

 ❯ tests/unit/App.notifier.spec.tsx (0 test)
stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
Error: Uncaught [Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:142:43)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3) {
  codeFrame: 'vi.mock(import("@/config/featureFlags"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
Error: Uncaught [Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:142:43)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3) {
  codeFrame: 'vi.mock(import("@/config/featureFlags"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
The above error occurred in the <Home> component:

    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:165:40)
    at Router (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at MemoryRouter (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1101:7)
    at DefaultPropsProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/DefaultPropsProvider/DefaultPropsProvider.js:9:3)
    at RtlProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/RtlProvider/index.js:8:3)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/private-theming/esm/ThemeProvider/ThemeProvider.js:33:5)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/ThemeProvider/ThemeProvider.js:49:5)
    at ThemeProviderNoVars (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProviderNoVars.js:8:10)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProvider.js:9:3)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/unit/Home.spec.tsx > Home > shows schedule tiles and chips when flag enabled
Error: Uncaught [Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:142:43)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3) {
  codeFrame: 'vi.mock(import("@/config/featureFlags"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
Error: Uncaught [Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:142:43)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3) {
  codeFrame: 'vi.mock(import("@/config/featureFlags"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
The above error occurred in the <Home> component:

    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:165:40)
    at Router (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at MemoryRouter (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1101:7)
    at DefaultPropsProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/DefaultPropsProvider/DefaultPropsProvider.js:9:3)
    at RtlProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/RtlProvider/index.js:8:3)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/private-theming/esm/ThemeProvider/ThemeProvider.js:33:5)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/ThemeProvider/ThemeProvider.js:49:5)
    at ThemeProviderNoVars (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProviderNoVars.js:8:10)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProvider.js:9:3)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

 ❯ tests/unit/Home.spec.tsx (3 tests | 3 failed) 21ms
   × Home > hides schedule tiles and chips when schedule flag disabled 16ms
     → [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

   × Home > shows schedule tiles and chips when flag enabled 2ms
     → [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

   × Home > indicates when demo mode is active 2ms
     → [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

stderr | tests/unit/Home.spec.tsx > Home > indicates when demo mode is active
Error: Uncaught [Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:142:43)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3) {
  codeFrame: 'vi.mock(import("@/config/featureFlags"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
Error: Uncaught [Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:
]
    at reportException (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

    at VitestMocker.createError (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:321:19)
    at Object.get (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/vitest/dist/chunks/execute.2pr0rHgK.js:389:22)
    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:142:43)
    at renderWithHooks (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/Users/yasutakesougo/audit-management-system-mvp/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3) {
  codeFrame: 'vi.mock(import("@/config/featureFlags"), async (importOriginal) => {\n' +
    '  const actual = await importOriginal()\n' +
    '  return {\n' +
    '    ...actual,\n' +
    '    // your mocked methods\n' +
    '  }\n' +
    '})'
}
The above error occurred in the <Home> component:

    at Home (/Users/yasutakesougo/audit-management-system-mvp/src/app/Home.tsx:165:40)
    at Router (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at MemoryRouter (/Users/yasutakesougo/audit-management-system-mvp/node_modules/react-router/dist/umd/react-router.development.js:1101:7)
    at DefaultPropsProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/DefaultPropsProvider/DefaultPropsProvider.js:9:3)
    at RtlProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/RtlProvider/index.js:8:3)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/private-theming/esm/ThemeProvider/ThemeProvider.js:33:5)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/system/esm/ThemeProvider/ThemeProvider.js:49:5)
    at ThemeProviderNoVars (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProviderNoVars.js:8:10)
    at ThemeProvider (file:///Users/yasutakesougo/audit-management-system-mvp/node_modules/@mui/material/esm/styles/ThemeProvider.js:9:3)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.


⎯⎯⎯⎯⎯⎯⎯ Failed Tests 3 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
 FAIL  tests/unit/Home.spec.tsx > Home > shows schedule tiles and chips when flag enabled
 FAIL  tests/unit/Home.spec.tsx > Home > indicates when demo mode is active
Error: [vitest] No "useFeatureFlags" export is defined on the "@/config/featureFlags" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock(import("@/config/featureFlags"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ Home src/app/Home.tsx:142:43
    140|   const theme = useTheme();
    141|   const demoModeEnabled = isDemoModeEnabled();
    142|   const { schedules: schedulesEnabled } = useFeatureFlags();
       |                                           ^
    143|   const bullets = demoModeEnabled ? demoBullets : productionBullets;
    144|   const filteredTiles = tiles.filter((tile) => schedulesEnabled || til…
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯

 Test Files  2 failed (2)
      Tests  3 failed (3)
   Start at  14:29:40
   Duration  311ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/Home.spec.tsx x22 

 ❯ tests/unit/App.notifier.spec.tsx (0 test)
 ❯ tests/unit/Home.spec.tsx (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/Home.spec.tsx [ tests/unit/Home.spec.tsx ]
Error: [vitest] No "isSchedulesCreateEnabled" export is defined on the "@/lib/env" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock(import("@/lib/env"), async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ resolveFeatureFlags src/config/featureFlags.ts:12:20
     10| export const resolveFeatureFlags = (envOverride?: EnvRecord): FeatureF…
     11|   schedules: isSchedulesFeatureEnabled(envOverride),
     12|   schedulesCreate: isSchedulesCreateEnabled(envOverride),
       |                    ^
     13|   complianceForm: isComplianceFormEnabled(envOverride),
     14| });
 ❯ src/config/featureFlags.ts:16:25
 ❯ src/app/Home.tsx:29:32

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  2 failed (2)
      Tests  no tests
   Start at  14:30:24
   Duration  147ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/config/featureFlags.spec.ts x4 

 ❯ tests/unit/Home.spec.tsx (0 test)
 ❯ tests/unit/App.notifier.spec.tsx (0 test)
 ❯ tests/unit/config/featureFlags.spec.ts (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/config/featureFlags.spec.ts [ tests/unit/config/featureFlags.spec.ts ]
Error: Transform failed with 1 error:
/Users/yasutakesougo/audit-management-system-mvp/tests/unit/config/featureFlags.spec.ts:77:28: ERROR: Expected ">" but found "value"
  Plugin: vite:esbuild
  File: /Users/yasutakesougo/audit-management-system-mvp/tests/unit/config/featureFlags.spec.ts:77:28
  
  Expected ">" but found "value"
  75 |  
  76 |      render(
  77 |        <FeatureFlagsProvider value={nextSnapshot}>
     |                              ^
  78 |          <Probe />
  79 |        </FeatureFlagsProvider>,
  
 ❯ failureErrorWithLog node_modules/vitest/node_modules/esbuild/lib/main.js:1472:15
 ❯ node_modules/vitest/node_modules/esbuild/lib/main.js:755:50
 ❯ responseCallbacks.<computed> node_modules/vitest/node_modules/esbuild/lib/main.js:622:9
 ❯ handleIncomingPacket node_modules/vitest/node_modules/esbuild/lib/main.js:677:12
 ❯ Socket.readFromStdout node_modules/vitest/node_modules/esbuild/lib/main.js:600:7

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  3 failed (3)
      Tests  no tests
   Start at  14:30:55
   Duration  124ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/config/featureFlags.spec.ts x5 

 ❯ tests/unit/Home.spec.tsx (0 test)
 ❯ tests/unit/App.notifier.spec.tsx (0 test)
 ❯ tests/unit/config/featureFlags.spec.ts (5 tests | 1 failed) 10ms
   × featureFlags config > returns current snapshot from getFeatureFlags 3ms
     → expected { schedules: true, …(2) } to deeply equal { schedules: false, …(2) }

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/config/featureFlags.spec.ts > featureFlags config > returns current snapshot from getFeatureFlags
AssertionError: expected { schedules: true, …(2) } to deeply equal { schedules: false, …(2) }

- Expected
+ Received

  Object {
    "complianceForm": false,
-   "schedules": false,
+   "schedules": true,
    "schedulesCreate": false,
  }

 ❯ tests/unit/config/featureFlags.spec.ts:58:39
     56|     };
     57| 
     58|     expect(getFeatureFlags(override)).toEqual(override);
       |                                       ^
     59|   });
     60| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  3 failed (3)
      Tests  1 failed | 4 passed (5)
   Start at  14:31:06
   Duration  131ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/config/featureFlags.spec.ts x6 

 ❯ tests/unit/Home.spec.tsx (0 test)
 ❯ tests/unit/App.notifier.spec.tsx (0 test)
 ❯ tests/unit/config/featureFlags.spec.ts (5 tests | 1 failed) 11ms
   × featureFlags config > returns current snapshot from getFeatureFlags 3ms
     → expected { schedules: true, …(2) } to deeply equal { schedules: false, …(2) }

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/config/featureFlags.spec.ts > featureFlags config > returns current snapshot from getFeatureFlags
AssertionError: expected { schedules: true, …(2) } to deeply equal { schedules: false, …(2) }

- Expected
+ Received

  Object {
    "complianceForm": false,
-   "schedules": false,
+   "schedules": true,
    "schedulesCreate": false,
  }

 ❯ tests/unit/config/featureFlags.spec.ts:58:39
     56|     };
     57| 
     58|     expect(getFeatureFlags(override)).toEqual(override);
       |                                       ^
     59|   });
     60| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  3 failed (3)
      Tests  1 failed | 4 passed (5)
   Start at  14:31:18
   Duration  111ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/ProtectedRoute.spec.tsx x1 

 ❯ tests/unit/Home.spec.tsx (0 test)
 ❯ tests/unit/App.notifier.spec.tsx (0 test)
 ❯ tests/unit/config/featureFlags.spec.ts (5 tests | 1 failed) 11ms
   × featureFlags config > returns current snapshot from getFeatureFlags 3ms
     → expected { schedules: true, …(2) } to deeply equal { schedules: false, …(2) }
stderr | tests/unit/ProtectedRoute.spec.tsx > ProtectedRoute > renders children when flag enabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/ProtectedRoute.spec.tsx (2 tests | 1 failed) 17ms
   × ProtectedRoute > redirects to fallback when flag disabled 5ms
     → expected <div data-testid="allowed"></div> to be null

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/ProtectedRoute.spec.tsx > ProtectedRoute > redirects to fallback when flag disabled
AssertionError: expected <div data-testid="allowed"></div> to be null

- Expected: 
null

+ Received: 
<div
  data-testid="allowed"
>
  allowed
</div>

 ❯ tests/unit/ProtectedRoute.spec.tsx:51:45
     49| 
     50|     renderWithFlags(disabledFlags);
     51|     expect(screen.queryByTestId('allowed')).toBeNull();
       |                                             ^
     52|     expect(screen.getByTestId('location')).toHaveTextContent('/');
     53|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  4 failed (4)
      Tests  2 failed | 5 passed (7)
   Start at  14:31:42
   Duration  134ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/Home.spec.tsx x23 

 ❯ tests/unit/App.notifier.spec.tsx (0 test)
 ❯ tests/unit/config/featureFlags.spec.ts (5 tests | 1 failed) 11ms
   × featureFlags config > returns current snapshot from getFeatureFlags 3ms
     → expected { schedules: true, …(2) } to deeply equal { schedules: false, …(2) }
 ❯ tests/unit/ProtectedRoute.spec.tsx (2 tests | 1 failed) 17ms
   × ProtectedRoute > redirects to fallback when flag disabled 5ms
     → expected <div data-testid="allowed"></div> to be null
stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (3 tests) 167ms

 Test Files  3 failed | 1 passed (4)
      Tests  2 failed | 8 passed (10)
   Start at  14:32:52
   Duration  372ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/ProtectedRoute.spec.tsx x2 

 ❯ tests/unit/App.notifier.spec.tsx (0 test)
 ❯ tests/unit/config/featureFlags.spec.ts (5 tests | 1 failed) 11ms
   × featureFlags config > returns current snapshot from getFeatureFlags 3ms
     → expected { schedules: true, …(2) } to deeply equal { schedules: false, …(2) }
stderr | tests/unit/ProtectedRoute.spec.tsx > ProtectedRoute > renders children when flag enabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/ProtectedRoute.spec.tsx (2 tests | 1 failed) 1034ms
   × ProtectedRoute > redirects to fallback when flag disabled 1023ms
     → expected <div data-testid="allowed"></div> to be null

Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body>[39m
    [36m<div>[39m
      [36m<div[39m
        [33mdata-testid[39m=[32m"allowed"[39m
      [36m>[39m
        [0mallowed[0m
      [36m</div>[39m
    [36m</div>[39m
    [36m<div>[39m
      [36m<span[39m
        [33mdata-testid[39m=[32m"location"[39m
      [36m>[39m
        [0m/[0m
      [36m</span>[39m
    [36m</div>[39m
  [36m</body>[39m
[36m</html>[39m

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/ProtectedRoute.spec.tsx > ProtectedRoute > redirects to fallback when flag disabled
AssertionError: expected <div data-testid="allowed"></div> to be null

Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body>[39m
    [36m<div>[39m
      [36m<div[39m
        [33mdata-testid[39m=[32m"allowed"[39m
      [36m>[39m
        [0mallowed[0m
      [36m</div>[39m
    [36m</div>[39m
    [36m<div>[39m
      [36m<span[39m
        [33mdata-testid[39m=[32m"location"[39m
      [36m>[39m
        [0m/[0m
      [36m</span>[39m
    [36m</div>[39m
  [36m</body>[39m
[36m</html>[39m

- Expected: 
null

+ Received: 
<div
  data-testid="allowed"
>
  allowed
</div>

 ❯ tests/unit/ProtectedRoute.spec.tsx:52:47
     50|     renderWithFlags(disabledFlags);
     51|     await waitFor(() => {
     52|       expect(screen.queryByTestId('allowed')).toBeNull();
       |                                               ^
     53|     });
     54|     expect(screen.getByTestId('location')).toHaveTextContent('/');
 ❯ runWithExpensiveErrorDiagnosticsDisabled node_modules/@testing-library/dom/dist/config.js:47:12
 ❯ checkCallback node_modules/@testing-library/dom/dist/wait-for.js:124:77
 ❯ Timeout.checkRealTimersCallback node_modules/@testing-library/dom/dist/wait-for.js:118:16

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  3 failed (3)
      Tests  2 failed | 5 passed (7)
   Start at  14:33:38
   Duration  1.24s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/config/featureFlags.spec.ts x7 

 ❯ tests/unit/App.notifier.spec.tsx (0 test)
 ❯ tests/unit/ProtectedRoute.spec.tsx (2 tests | 1 failed) 1034ms
   × ProtectedRoute > redirects to fallback when flag disabled 1023ms
     → expected <div data-testid="allowed"></div> to be null

Ignored nodes: comments, script, style
[36m<html>[39m
  [36m<head />[39m
  [36m<body>[39m
    [36m<div>[39m
      [36m<div[39m
        [33mdata-testid[39m=[32m"allowed"[39m
      [36m>[39m
        [0mallowed[0m
      [36m</div>[39m
    [36m</div>[39m
    [36m<div>[39m
      [36m<span[39m
        [33mdata-testid[39m=[32m"location"[39m
      [36m>[39m
        [0m/[0m
      [36m</span>[39m
    [36m</div>[39m
  [36m</body>[39m
[36m</html>[39m
 ✓ tests/unit/config/featureFlags.spec.ts (5 tests) 7ms

 Test Files  2 failed | 1 passed (3)
      Tests  1 failed | 6 passed (7)
   Start at  14:34:21
   Duration  185ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  tests/unit/ProtectedRoute.spec.tsx x3 

 ❯ tests/unit/App.notifier.spec.tsx (0 test)
stderr | tests/unit/ProtectedRoute.spec.tsx > ProtectedRoute > renders children when flag enabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ProtectedRoute.spec.tsx (2 tests) 15ms

 Test Files  1 failed | 1 passed (2)
      Tests  2 passed (2)
   Start at  14:35:42
   Duration  198ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit

Restarting due to config changes...

 DEV  v2.1.9 /Users/yasutakesougo/audit-management-system-mvp

 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 93ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 144ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 15ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 26ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 21ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 109ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 116ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 116ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 4ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 2ms
 ✓ tests/unit/config/featureFlags.spec.ts (5 tests) 8ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 80ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (3 tests) 144ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 319ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 319ms
 ✓ tests/unit/schedule/move.spec.ts (3 tests) 12ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 2ms
stderr | tests/unit/ProtectedRoute.spec.tsx > ProtectedRoute > renders children when flag enabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ProtectedRoute.spec.tsx (2 tests) 18ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 2ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 3ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 2ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1553ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1447ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 61ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 63ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 3ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 1ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 7ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 3ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 12ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/hashUtil.spec.ts (2 tests) 2ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 139ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 95ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 28ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 32ms

 Test Files  53 passed (53)
      Tests  133 passed (133)
   Start at  14:43:44
   Duration  6.47s (transform 416ms, setup 4.27s, collect 2.39s, tests 3.31s, environment 9.48s, prepare 1.56s)

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  vitest.setup.ts 

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 116ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (3 tests) 134ms
 ✓ tests/unit/spClient.batch.spec.ts (1 test) 388ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 387ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 205ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 98ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 102ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 97ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 96ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 89ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 93ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 61ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 62ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 2125ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1886ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 31ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 19ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 35ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 20ms
stderr | tests/unit/ProtectedRoute.spec.tsx > ProtectedRoute > renders children when flag enabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ProtectedRoute.spec.tsx (2 tests) 20ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 8ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms
 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 12ms
 ✓ tests/unit/schedule/move.spec.ts (3 tests) 12ms
 ✓ tests/unit/config/featureFlags.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 6ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 7ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 4ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 5ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 3ms
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 3ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 1ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 2ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 1ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 2ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

 Test Files  53 passed (53)
      Tests  133 passed (133)
   Start at  14:51:54
   Duration  10.07s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/app/router.tsx x2 

 ✓ tests/unit/App.notifier.spec.tsx (1 test) 11ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  14:55:06
   Duration  483ms

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/ui/components/SignInButton.tsx 

stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ❯ tests/unit/ui.snapshot.spec.tsx (1 test | 1 failed) 63ms
   × AppShell snapshot 62ms
     → Snapshot `AppShell snapshot 1` mismatched
 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 124ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 13ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
Error: Snapshot `AppShell snapshot 1` mismatched

- Expected
+ Received

@@ -53,10 +53,18 @@
            <path
              d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"
            />
          </svg>
        </a>
+       <button
+         aria-label="サインイン"
+         class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedInherit MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorInherit MuiButton-root MuiButton-outlined MuiButton-outlinedInherit MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorInherit css-bnyy0h-MuiButtonBase-root-MuiButton-root"
+         tabindex="0"
+         type="button"
+       >
+         サインイン
+       </button>
      </div>
    </header>
    <div
      class="MuiContainer-root MuiContainer-maxWidthLg css-xsov46-MuiContainer-root"
    >

 ❯ tests/unit/ui.snapshot.spec.tsx:17:21
     15|   );
     16| 
     17|   expect(container).toMatchSnapshot();
       |                     ^
     18| });
     19| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

  Snapshots  1 failed
 Test Files  1 failed | 2 passed (3)
      Tests  1 failed | 3 passed (4)
   Start at  14:59:41
   Duration  1.92s

 FAIL  Tests failed. Watching for file changes...
       press u to update snapshot, press h to show help
c[3J RERUN  src/auth/msalConfig.ts 

 ❯ tests/unit/spClient.batch.spec.ts (0 test)
 ❯ tests/unit/spClient.retry504.spec.ts (0 test)
 ❯ tests/unit/spClient.retry.spec.ts (0 test)
 ❯ tests/unit/ui.snapshot.spec.tsx (0 test)
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 102ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 137ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 105ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 95ms
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (0 test)
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 120ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 79ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 77ms
 ❯ tests/unit/spClient.etag-conflict.spec.ts (0 test)
 ❯ tests/unit/App.notifier.spec.tsx (0 test)
 ❯ tests/unit/spClient.ensureList.spec.ts (0 test)
 ❯ tests/unit/spClient.postBatch.spec.ts (0 test)
 ❯ tests/unit/spClient.retryRetryAfterDate.spec.ts (0 test)
 ❯ tests/unit/spClient.optionalFields.spec.ts (0 test)
 ❯ tests/unit/records.api.spec.ts (0 test)
 ❯ tests/unit/checklist.api.spec.ts (0 test)
 ❯ src/lib/spClient.spec.ts (0 test)
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 3ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ❯ src/features/audit/useAuditSyncBatch.resend.spec.ts (0 test)
 ❯ tests/unit/ensureConfig.spec.ts (0 test)
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ❯ tests/unit/useAuditSyncBatch.summary.spec.ts (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 17 ⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts [ tests/unit/spClient.ensureList.spec.ts ]
 FAIL  tests/unit/spClient.optionalFields.spec.ts [ tests/unit/spClient.optionalFields.spec.ts ]
 FAIL  tests/unit/spClient.etag-conflict.spec.ts [ tests/unit/spClient.etag-conflict.spec.ts ]
 FAIL  tests/unit/ui.snapshot.spec.tsx [ tests/unit/ui.snapshot.spec.tsx ]
 FAIL  tests/unit/spClient.postBatch.spec.ts [ tests/unit/spClient.postBatch.spec.ts ]
 FAIL  tests/unit/spClient.retry.spec.ts [ tests/unit/spClient.retry.spec.ts ]
 FAIL  tests/unit/spClient.batch.spec.ts [ tests/unit/spClient.batch.spec.ts ]
 FAIL  tests/unit/a11y.records-users.composite.spec.tsx [ tests/unit/a11y.records-users.composite.spec.tsx ]
 FAIL  src/features/audit/useAuditSyncBatch.resend.spec.ts [ src/features/audit/useAuditSyncBatch.resend.spec.ts ]
 FAIL  tests/unit/useAuditSyncBatch.summary.spec.ts [ tests/unit/useAuditSyncBatch.summary.spec.ts ]
 FAIL  tests/unit/checklist.api.spec.ts [ tests/unit/checklist.api.spec.ts ]
 FAIL  src/lib/spClient.spec.ts [ src/lib/spClient.spec.ts ]
 FAIL  tests/unit/spClient.retryRetryAfterDate.spec.ts [ tests/unit/spClient.retryRetryAfterDate.spec.ts ]
 FAIL  tests/unit/records.api.spec.ts [ tests/unit/records.api.spec.ts ]
 FAIL  tests/unit/ensureConfig.spec.ts [ tests/unit/ensureConfig.spec.ts ]
 FAIL  tests/unit/spClient.retry504.spec.ts [ tests/unit/spClient.retry504.spec.ts ]
Error: [MSAL 設定エラー]
VITE_MSAL_CLIENT_ID が設定されていません。
.env に SPA アプリのクライアント ID (GUID) を設定してください。
例: VITE_MSAL_CLIENT_ID=00000000-0000-0000-0000-000000000000
 ❯ resolveClientId src/auth/msalConfig.ts:16:11
     14|   const raw = readOptionalEnv('VITE_MSAL_CLIENT_ID')?.trim() ?? '';
     15|   if (!raw || isPlaceholder(raw, PLACEHOLDER_CLIENT_IDS)) {
     16|     throw new Error(
       |           ^
     17|       `[MSAL 設定エラー]\nVITE_MSAL_CLIENT_ID が設定されていません。\n…
     18|     );
 ❯ src/auth/msalConfig.ts:68:15
 ❯ src/auth/useAuth.ts:2:31

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/17]⎯

 FAIL  tests/unit/App.notifier.spec.tsx [ tests/unit/App.notifier.spec.tsx ]
Error: [MSAL 設定エラー]
VITE_MSAL_CLIENT_ID が設定されていません。
.env に SPA アプリのクライアント ID (GUID) を設定してください。
例: VITE_MSAL_CLIENT_ID=00000000-0000-0000-0000-000000000000
 ❯ resolveClientId src/auth/msalConfig.ts:16:11
     14|   const raw = readOptionalEnv('VITE_MSAL_CLIENT_ID')?.trim() ?? '';
     15|   if (!raw || isPlaceholder(raw, PLACEHOLDER_CLIENT_IDS)) {
     16|     throw new Error(
       |           ^
     17|       `[MSAL 設定エラー]\nVITE_MSAL_CLIENT_ID が設定されていません。\n…
     18|     );
 ❯ src/auth/msalConfig.ts:68:15
 ❯ src/auth/MsalProvider.tsx:4:31

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/17]⎯

 Test Files  17 failed | 10 passed (27)
      Tests  23 passed (23)
   Start at  15:05:38
   Duration  4.86s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  src/auth/msalConfig.ts 

 ❯ tests/unit/spClient.etag-conflict.spec.ts (0 test)
 ❯ tests/unit/spClient.optionalFields.spec.ts (0 test)
 ❯ tests/unit/spClient.ensureList.spec.ts (0 test)
 ❯ tests/unit/App.notifier.spec.tsx (0 test)
 ❯ tests/unit/spClient.postBatch.spec.ts (0 test)
 ❯ tests/unit/spClient.retry.spec.ts (0 test)
 ❯ tests/unit/spClient.batch.spec.ts (0 test)
 ❯ tests/unit/ui.snapshot.spec.tsx (0 test)
 ❯ src/features/audit/useAuditSyncBatch.resend.spec.ts (0 test)
 ❯ tests/unit/a11y.records-users.composite.spec.tsx (0 test)
 ❯ tests/unit/useAuditSyncBatch.summary.spec.ts (0 test)
 ❯ tests/unit/checklist.api.spec.ts (0 test)
 ❯ src/lib/spClient.spec.ts (0 test)
 ❯ tests/unit/spClient.retryRetryAfterDate.spec.ts (0 test)
 ❯ tests/unit/records.api.spec.ts (0 test)
 ❯ tests/unit/ensureConfig.spec.ts (0 test)
 ❯ tests/unit/spClient.retry504.spec.ts (0 test)
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 92ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 154ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 90ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 109ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 106ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 59ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 60ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms

⎯⎯⎯⎯⎯⎯ Failed Suites 17 ⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/spClient.ensureList.spec.ts [ tests/unit/spClient.ensureList.spec.ts ]
 FAIL  tests/unit/spClient.optionalFields.spec.ts [ tests/unit/spClient.optionalFields.spec.ts ]
 FAIL  tests/unit/spClient.etag-conflict.spec.ts [ tests/unit/spClient.etag-conflict.spec.ts ]
 FAIL  tests/unit/ui.snapshot.spec.tsx [ tests/unit/ui.snapshot.spec.tsx ]
 FAIL  tests/unit/spClient.postBatch.spec.ts [ tests/unit/spClient.postBatch.spec.ts ]
 FAIL  tests/unit/spClient.retry.spec.ts [ tests/unit/spClient.retry.spec.ts ]
 FAIL  tests/unit/spClient.batch.spec.ts [ tests/unit/spClient.batch.spec.ts ]
 FAIL  tests/unit/a11y.records-users.composite.spec.tsx [ tests/unit/a11y.records-users.composite.spec.tsx ]
 FAIL  src/features/audit/useAuditSyncBatch.resend.spec.ts [ src/features/audit/useAuditSyncBatch.resend.spec.ts ]
 FAIL  tests/unit/useAuditSyncBatch.summary.spec.ts [ tests/unit/useAuditSyncBatch.summary.spec.ts ]
 FAIL  tests/unit/checklist.api.spec.ts [ tests/unit/checklist.api.spec.ts ]
 FAIL  src/lib/spClient.spec.ts [ src/lib/spClient.spec.ts ]
 FAIL  tests/unit/spClient.retryRetryAfterDate.spec.ts [ tests/unit/spClient.retryRetryAfterDate.spec.ts ]
 FAIL  tests/unit/records.api.spec.ts [ tests/unit/records.api.spec.ts ]
 FAIL  tests/unit/ensureConfig.spec.ts [ tests/unit/ensureConfig.spec.ts ]
 FAIL  tests/unit/spClient.retry504.spec.ts [ tests/unit/spClient.retry504.spec.ts ]
Error: [MSAL 設定エラー]
VITE_MSAL_CLIENT_ID が設定されていません。
.env に SPA アプリのクライアント ID (GUID) を設定してください。
例: VITE_MSAL_CLIENT_ID=00000000-0000-0000-0000-000000000000
 ❯ resolveClientId src/auth/msalConfig.ts:16:11
     14|   const raw = readOptionalEnv('VITE_MSAL_CLIENT_ID')?.trim() ?? '';
     15|   if (!raw || isPlaceholder(raw, PLACEHOLDER_CLIENT_IDS)) {
     16|     throw new Error(
       |           ^
     17|       `[MSAL 設定エラー]\nVITE_MSAL_CLIENT_ID が設定されていません。\n…
     18|     );
 ❯ src/auth/msalConfig.ts:68:15
 ❯ src/auth/useAuth.ts:2:31

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/17]⎯

 FAIL  tests/unit/App.notifier.spec.tsx [ tests/unit/App.notifier.spec.tsx ]
Error: [MSAL 設定エラー]
VITE_MSAL_CLIENT_ID が設定されていません。
.env に SPA アプリのクライアント ID (GUID) を設定してください。
例: VITE_MSAL_CLIENT_ID=00000000-0000-0000-0000-000000000000
 ❯ resolveClientId src/auth/msalConfig.ts:16:11
     14|   const raw = readOptionalEnv('VITE_MSAL_CLIENT_ID')?.trim() ?? '';
     15|   if (!raw || isPlaceholder(raw, PLACEHOLDER_CLIENT_IDS)) {
     16|     throw new Error(
       |           ^
     17|       `[MSAL 設定エラー]\nVITE_MSAL_CLIENT_ID が設定されていません。\n…
     18|     );
 ❯ src/auth/msalConfig.ts:68:15
 ❯ src/auth/MsalProvider.tsx:4:31

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/17]⎯

 Test Files  17 failed | 10 passed (27)
      Tests  23 passed (23)
   Start at  15:05:46
   Duration  3.61s

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  vitest.setup.ts 

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 6ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 8ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 7ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 75ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 316ms
   ✓ $batch retry + parse > 503 -> retry then 200 success, mixed statuses returned 315ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 5ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/App.notifier.spec.tsx (1 test) 12ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 154ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 43ms
 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 126ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1749ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1504ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 104ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 110ms
stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (3 tests) 165ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 114ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 100ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 63ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 62ms
stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 94ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 32ms
stderr | tests/unit/ProtectedRoute.spec.tsx > ProtectedRoute > renders children when flag enabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ProtectedRoute.spec.tsx (2 tests) 21ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 28ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 19ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 13ms
 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 12ms
 ✓ tests/unit/schedule/move.spec.ts (3 tests) 12ms
 ✓ tests/unit/config/featureFlags.spec.ts (5 tests) 8ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 3ms
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 4ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 3ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 2ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 2ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 2ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 1ms
 ✓ tests/unit/audit.spec.ts (3 tests) 2ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 1ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

 Test Files  53 passed (53)
      Tests  133 passed (133)
   Start at  15:06:56
   Duration  9.89s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
c[3J RERUN  vitest.setup.ts 

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 401 -> token refresh -> success (single refresh)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

 ✓ tests/unit/spClient.batch.spec.ts (1 test) 107ms
stdout | tests/unit/spClient.retry504.spec.ts > spClient retry for 504 Gateway Timeout > retries once on 504 then succeeds
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retry504.spec.ts (1 test) 177ms
stderr | tests/unit/Home.spec.tsx > Home > hides schedule tiles and chips when schedule flag disabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/Home.spec.tsx (3 tests) 140ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 429 -> retry once -> success
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/whatever

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/AuditPanel.actions.spec.tsx (6 tests) 120ms
 ✓ src/features/schedule/__tests__/WeekPage.smoke.test.tsx (1 test) 114ms
 ✓ src/features/users/UsersPanel.a11y.test.tsx (2 tests) 97ms
 ✓ tests/unit/AuditPanel.metrics.spec.tsx (4 tests) 98ms
 ✓ tests/unit/operation-hub.useOperationHubData.spec.ts (2 tests) 65ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

stderr | tests/unit/AppShell.nav.spec.tsx > AppShell navigation > marks current route button with aria-current="page"
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/AppShell.nav.spec.tsx (2 tests) 87ms
 ✓ src/features/users/UsersPanel.smoke.test.tsx (1 test) 58ms
 ✓ tests/unit/a11y.records-users.composite.spec.tsx (1 test) 76ms
 ✓ tests/unit/AuditPanel.overlay.spec.tsx (1 test) 54ms
stdout | tests/unit/spClient.retry.spec.ts > spClient retries & refresh > 503 -> exhaust retries -> throws
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/x

 ✓ tests/unit/spClient.retry.spec.ts (3 tests) 1818ms
   ✓ spClient retries & refresh > 429 -> retry once -> success 354ms
   ✓ spClient retries & refresh > 503 -> exhaust retries -> throws 1461ms
 ✓ tests/unit/uuid.collision.spec.ts (1 test) 34ms
stderr | tests/unit/ui.snapshot.spec.tsx > AppShell snapshot
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ui.snapshot.spec.tsx (1 test) 58ms
 ✓ src/features/schedule/__tests__/spClient.usercare.spec.ts (2 tests) 21ms
stderr | tests/unit/ProtectedRoute.spec.tsx > ProtectedRoute > renders children when flag enabled
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ tests/unit/ProtectedRoute.spec.tsx (2 tests) 40ms
 ✓ tests/unit/LayoutContext.spec.tsx (3 tests) 30ms
 ✓ tests/unit/schedule/dateutils.local.spec.ts (3 tests) 12ms
 ✓ src/features/schedule/__tests__/briefing.org-staff.spec.ts (2 tests) 12ms
 ✓ tests/unit/schedule/move.spec.ts (3 tests) 13ms
stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > sends PATCH with auth headers, refreshes ETag, and retries with the new value
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > throws a descriptive error if item disappeared (GET 404 after 412)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 409 conflict and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > does not retry on 428 precondition required and surfaces the error
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)

stdout | tests/unit/spClient.etag-conflict.spec.ts > spClient ETag / 412 handling > fails clearly if refreshed ETag header is missing
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items(10)?%24select=Id

 ✓ tests/unit/spClient.etag-conflict.spec.ts (5 tests) 8ms
 ✓ tests/unit/config/featureFlags.spec.ts (5 tests) 9ms
stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > returns existing list metadata when the list is already provisioned
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing%20List')?$select=Id,Title

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > creates the list and adds missing fields
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields?$select=InternalName,TypeAsString,Required
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('New%20List')/fields/createfieldasxml

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > skips adding fields that already exist on the target list
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

stdout | tests/unit/spClient.ensureList.spec.ts > spClient ensureListExists > warns when an existing field misses the required flag
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')?$select=Id,Title
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Existing')/fields?$select=InternalName,TypeAsString,Required

 ✓ tests/unit/spClient.ensureList.spec.ts (5 tests) 7ms
 ✓ tests/unit/App.notifier.spec.tsx (1 test) 16ms
stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > getListItemsByTitle builds query string with select/filter/orderby/top
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items?%24select=Id%2CTitle&%24filter=Title+eq+%27A%27&%24orderby=Id+desc&%24top=10

stdout | tests/unit/spClient.postBatch.spec.ts > spClient additional coverage (postBatch + list/add) > addListItemByTitle returns created item
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.postBatch.spec.ts (4 tests) 8ms
 ✓ tests/unit/spClient.optionalFields.spec.ts (7 tests) 6ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

stdout | tests/unit/records.api.spec.ts > records add failure (500) > propagates server error message on 500
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('SupportRecord_Daily')/items

 ✓ tests/unit/records.api.spec.ts (1 test) 4ms
stdout | tests/unit/spClient.retryRetryAfterDate.spec.ts > spClient retry with HTTP-date Retry-After header > parses HTTP-date Retry-After and retries
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('X')/items

 ✓ tests/unit/spClient.retryRetryAfterDate.spec.ts (1 test) 31ms
 ✓ tests/unit/schedule/month.spec.ts (2 tests) 5ms
 ✓ src/features/audit/batchParser.spec.ts (4 tests) 4ms
stdout | tests/unit/checklist.api.spec.ts > checklist list 401 refresh flow > 401 then refreshed token returns data
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200
[SPFetch] URL: https://contoso.sharepoint.com/sites/wf/_api/web/lists/getbytitle('Compliance_Checklist')/items?$top=200

 ✓ tests/unit/checklist.api.spec.ts (1 test) 4ms
 ✓ tests/unit/batchUtil.fallback.spec.ts (2 tests) 3ms
 ✓ tests/unit/batchUtil.fallback.single.spec.ts (1 test) 2ms
 ✓ tests/unit/batchUtil.fallback.malformed.spec.ts (2 tests) 3ms
 ✓ src/lib/hashUtil.spec.ts (5 tests) 3ms
 ✓ tests/unit/statusDictionary.spec.ts (4 tests) 2ms
 ✓ tests/unit/schedule/workPattern.spec.ts (5 tests) 2ms
 ✓ tests/unit/useAuditSync.dup.spec.ts (1 test) 2ms
 ✓ tests/unit/hashUtil.deep.spec.ts (2 tests) 3ms
 ✓ tests/unit/records.hook.spec.ts (2 tests) 2ms
 ✓ tests/unit/hashUtil.spec.ts (2 tests) 2ms
 ✓ src/lib/spClient.spec.ts (4 tests) 2ms
 ✓ tests/unit/audit.spec.ts (3 tests) 1ms
 ✓ tests/unit/uuid.spec.ts (3 tests) 2ms
 ✓ tests/unit/ensureConfig.spec.ts (3 tests) 2ms
 ✓ src/features/audit/useAuditSyncBatch.resend.spec.ts (3 tests) 2ms
 ✓ src/features/audit/batchUtil.spec.ts (1 test) 1ms
 ✓ src/features/schedule/__tests__/validation.usercare.spec.ts (2 tests) 1ms
 ✓ tests/unit/checklist.hook.spec.ts (2 tests) 1ms
 ✓ tests/unit/useAuditSyncBatch.summary.spec.ts (2 tests) 1ms
 ✓ tests/unit/exportCsv.spec.ts (2 tests) 1ms
 ✓ src/features/users/UsersPanel.test.tsx (1 test) 1ms

 Test Files  53 passed (53)
      Tests  133 passed (133)
   Start at  15:07:10
   Duration  9.30s

 PASS  Waiting for file changes...
       press h to show help, press q to quit
