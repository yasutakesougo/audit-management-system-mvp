# Schedule Conflict Detection - Testing Strategy

## Overview ğŸ§ª

ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é‡è¤‡æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã®åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã€‚ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‹ã‚‰E2Eãƒ†ã‚¹ãƒˆã¾ã§ã€å¤šå±¤çš„ãªãƒ†ã‚¹ãƒˆã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ä»•æ§˜ã‚’ãƒ­ãƒƒã‚¯ã—ã€å°†æ¥ã®å¤‰æ›´ã‹ã‚‰ä¿è­·ã—ã¾ã™ã€‚

## Test Architecture

```
â”Œâ”€ Unit Tests (Vitest) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  conflictChecker.spec.ts                                        â”‚
â”‚  â€¢ hasTimeOverlap() - æ™‚é–“é‡è¤‡ãƒ­ã‚¸ãƒƒã‚¯                           â”‚
â”‚  â€¢ checkScheduleConflicts() - ç«¶åˆæ¤œçŸ¥ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯              â”‚
â”‚  â€¢ getConflictSeverity() - é‡è¦åº¦åˆ¤å®š                           â”‚
â”‚  â€¢ Complex Scenarios - ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ E2E Tests (Playwright) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  schedule-conflicts.spec.ts                                     â”‚
â”‚  â€¢ UI Integration - é‡è¤‡è¡¨ç¤ºãƒ»è­¦å‘Šã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼                 â”‚
â”‚  â€¢ User Workflow - ä½œæˆãƒ•ãƒ­ãƒ¼ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°                â”‚
â”‚  â€¢ Cross-View Consistency - Week/Month/Dayè¡¨ç¤ºã§ã®ä¸€è²«æ€§        â”‚
â”‚  â€¢ Conflict Resolution - é‡è¤‡è§£æ±ºã‚¬ã‚¤ãƒ€ãƒ³ã‚¹                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Unit Test Coverage

### âš¡ Core Logic Tests
- **æ™‚é–“é‡è¤‡æ¤œçŸ¥ (`hasTimeOverlap`)**
  - éƒ¨åˆ†é‡è¤‡ / å®Œå…¨é‡è¤‡ / åŒ…å«é–¢ä¿‚
  - éš£æ¥æ™‚é–“ï¼ˆ`end === start`ï¼‰â†’ é‡è¤‡ãªã—
  - ç„¡åŠ¹ãªæ—¥ä»˜ã®å‡¦ç†
  - ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¯¾å¿œ

- **ç«¶åˆæ¤œçŸ¥ (`checkScheduleConflicts`)**
  - ãƒ€ãƒ–ãƒ«ãƒ–ãƒƒã‚­ãƒ³ã‚°ï¼ˆåŒä¸€è·å“¡ï¼‰
  - åˆ©ç”¨è€…äºˆå®šé‡è¤‡
  - è·å“¡ä¸åœ¨
  - ç·¨é›†æ™‚ã®è‡ªå·±é™¤å¤–
  - å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸è¶³æ™‚ã®å‡¦ç†

### ğŸ”¬ Edge Cases & Performance
- **å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆ**
  - 1åˆ†é‡è¤‡ / å®Œå…¨åŒæ™‚é–“
  - æ—¥ã‚’ã¾ãŸãã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
  - ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³æ··åœ¨

- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ**
  - 1000ä»¶ã®äºˆå®šãƒ‡ãƒ¼ã‚¿ã§100msä»¥å†…å‡¦ç†
  - ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯é˜²æ­¢

## E2E Test Scenarios

### ğŸ“± User Experience
- **è¦–è¦šçš„é‡è¤‡è¡¨ç¤º**
  - é‡è¤‡äºˆå®šã®è­¦å‘Šã‚¢ã‚¤ã‚³ãƒ³ãƒ»è‰²åˆ†ã‘
  - Week/Month/Dayå…¨è¡¨ç¤ºã§ã®ä¸€è²«æ€§
  - ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã«ã‚ˆã‚‹è©³ç´°æƒ…å ±

- **ä½œæˆãƒ»ç·¨é›†ãƒ•ãƒ­ãƒ¼**
  - é‡è¤‡ã‚¨ãƒ©ãƒ¼ã®å³åº§æ¤œçŸ¥
  - ä¿å­˜é˜²æ­¢ vs è­¦å‘Šä»˜ãä¿å­˜
  - è§£æ±ºã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ã®æä¾›

### ğŸ›  Workflow Testing
- **é‡è¤‡è§£æ±ºãƒ—ãƒ­ã‚»ã‚¹**
  - æ™‚é–“èª¿æ•´ã®è‡ªå‹•ææ¡ˆ
  - æ—¢å­˜äºˆå®šç·¨é›†ã‚ªãƒ—ã‚·ãƒ§ãƒ³
  - å¼·åˆ¶ä¿å­˜ï¼ˆç®¡ç†è€…æ¨©é™ï¼‰

## Test Data Strategy

### ğŸ­ Test Fixtures
```typescript
// åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³
const overlappingSchedules = [
  { start: '09:00', end: '10:00', type: 'lifeCare' },
  { start: '09:30', end: '10:30', type: 'lifeSupport' }
];

// ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹
const edgeCases = [
  { start: '23:00', end: '01:00+1' }, // æ—¥ã¾ãŸã
  { start: '09:00:00', end: '09:00:01' }, // 1ç§’å·®
];

// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
const largeDataset = generateSchedules(1000);
```

## Running Tests

### Unit Tests
```bash
# å˜ä½“å®Ÿè¡Œ
npx vitest run src/features/schedule/conflictChecker.spec.ts

# ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰
npx vitest watch conflictChecker

# ã‚«ãƒãƒ¬ãƒƒã‚¸
npx vitest run --coverage
```

### E2E Tests
```bash
# é‡è¤‡æ¤œçŸ¥E2Eãƒ†ã‚¹ãƒˆ
npx playwright test schedule-conflicts

# ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ
npx playwright test --headed schedule-conflicts

# ç‰¹å®šãƒ–ãƒ©ã‚¦ã‚¶ã®ã¿
npx playwright test --project=chrome schedule-conflicts
```

## Future Enhancements

### ğŸ“ˆ Test Expansion
- **Integration Tests**
  - SharePoint APIé€£æºãƒ†ã‚¹ãƒˆ
  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ãƒ†ã‚¹ãƒˆ
  - è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼åŒæ™‚ç·¨é›†

- **Visual Regression**
  - é‡è¤‡è¡¨ç¤ºUIã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ¯”è¼ƒ
  - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ

### ğŸš€ Advanced Scenarios
- **Business Logic**
  - åˆ©ç”¨è€…å®šå“¡åˆ¶é™
  - è·å“¡ç¨¼åƒæ™‚é–“åˆ¶é™
  - æ–½è¨­ãƒªã‚½ãƒ¼ã‚¹ç«¶åˆ

- **Performance**
  - å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã§ã®ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£
  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œçŸ¥ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“

## Test Maintenance

### ğŸ”„ ç¶™ç¶šçš„æ”¹å–„
- **ä»•æ§˜å¤‰æ›´ã¸ã®å¯¾å¿œ**
  - æ–°ã—ã„é‡è¤‡ãƒ«ãƒ¼ãƒ«è¿½åŠ æ™‚ã®ãƒ†ã‚¹ãƒˆè¿½åŠ 
  - APIå¤‰æ›´æ™‚ã® mock ãƒ‡ãƒ¼ã‚¿æ›´æ–°

- **ãƒ‡ãƒ¼ã‚¿å“è³ªä¿è¨¼**
  - æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åæ˜ 
  - ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®è¿½åŠ ç™ºè¦‹ã¨å¯¾å¿œ

### âš™ï¸ CI/CD Integration
```yaml
# GitHub Actionsä¾‹
- name: Run Unit Tests
  run: npm run test:unit -- conflictChecker

- name: Run E2E Tests
  run: npm run test:e2e -- schedule-conflicts

- name: Upload Coverage
  run: npm run coverage:upload
```

ã“ã®ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã«ã‚ˆã‚Šã€é‡è¤‡æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã®ä¿¡é ¼æ€§ã‚’ç¢ºä¿ã—ã€å°†æ¥ã®æ©Ÿèƒ½æ‹¡å¼µã«å¯¾ã™ã‚‹å®‰å…¨ãªåŸºç›¤ã‚’æä¾›ã—ã¾ã™ã€‚