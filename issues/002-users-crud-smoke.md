# 📌 Users CRUD 基本回帰テスト（追加/削除）

## 目的（なぜやるか／価値）

最小限の CRUD 回帰を保証して、主要なユーザー操作の破壊的変更を早期検知する。

ユーザーマスタ（Users Master）の管理は、本アプリケーションの基幹機能です。ユーザーの追加・削除が正常に動作しなければ、日々の運用に支障をきたします。この基本回帰テストを導入することで：

- **安定性**: ユーザー CRUD の基本操作が常に動作することを保証
- **リグレッション防止**: UI 変更やリファクタリング時の破壊的変更を即座に検知
- **信頼性**: SharePoint API 連携の基本動作を自動検証
- **開発速度**: 手動テストの負担を減らし、安心してリファクタリングできる

## 受け入れ基準（Definition of Done）

- [ ] モック API を使った ユーザー追加 → 削除 のフローを実装
- [ ] Playwright E2E テストが CI で安定してパスする
- [ ] テストデータのクリーンアップを実装（テスト後の状態リセット）
- [ ] ユーザー追加のフォームバリデーションを検証
- [ ] 削除後にリストから該当ユーザーが消えることを確認
- [ ] テストが 45 秒以内に完了する

## 目安工数

- [x] S（小）
- [ ] M（中）
- [ ] L（大）

## タスク例

- [ ] `tests/e2e/users-crud-smoke.spec.ts` を作成
- [ ] ユーザー追加フローのテストケースを実装
  - フォームオープン → 入力 → 送信 → 成功メッセージ確認
- [ ] ユーザー削除フローのテストケースを実装
  - ユーザー選択 → 削除ボタン → 確認ダイアログ → 削除実行 → リスト更新確認
- [ ] モックデータの準備とクリーンアップ処理
- [ ] CI ワークフローにテストを追加

## 備考

関連ファイル:
- `src/features/users/UsersPage.tsx` - ユーザー一覧・管理画面
- `src/features/users/UserForm.tsx` - ユーザー追加/編集フォーム
- `src/domain/users/usersStore.ts` - ユーザーストア（状態管理）
- `tests/e2e/users.detail-flow.spec.ts` - 既存のユーザーテスト参考

参考:
- [Playwright Locators](https://playwright.dev/docs/locators)
- [E2E Best Practices](../docs/E2E_BEST_PRACTICES.md)
